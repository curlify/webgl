!function(){var e=[],t=window.CanvasInput=function(t){var r=this;t=t?t:{},r._canvas=t.canvas||null,r._ctx=r._canvas?r._canvas.getContext("2d"):null,r._x=t.x||0,r._y=t.y||0,r._extraX=t.extraX||0,r._extraY=t.extraY||0,r._fontSize=t.fontSize||14,r._fontFamily=t.fontFamily||"Arial",r._fontColor=t.fontColor||"#000",r._placeHolderColor=t.placeHolderColor||"#bfbebd",r._fontWeight=t.fontWeight||"normal",r._fontStyle=t.fontStyle||"normal",r._readonly=t.readonly||!1,r._maxlength=t.maxlength||null,r._width=t.width||150,r._height=t.height||r._fontSize,r._padding=t.padding>=0?t.padding:5,r._borderWidth=t.borderWidth>=0?t.borderWidth:1,r._borderColor=t.borderColor||"#959595",r._borderRadius=t.borderRadius>=0?t.borderRadius:3,r._backgroundImage=t.backgroundImage||"",r._boxShadow=t.boxShadow||"1px 1px 0px rgba(255, 255, 255, 1)",r._innerShadow=t.innerShadow||"0px 0px 4px rgba(0, 0, 0, 0.4)",r._selectionColor=t.selectionColor||"rgba(179, 212, 253, 0.8)",r._placeHolder=t.placeHolder||"",r._value=(t.value||r._placeHolder)+"",r._onsubmit=t.onsubmit||function(){},r._onkeydown=t.onkeydown||function(){},r._onkeyup=t.onkeyup||function(){},r._onfocus=t.onfocus||function(){},r._onblur=t.onblur||function(){},r._cursor=!1,r._cursorPos=0,r._hasFocus=!1,r._selection=[0,0],r._wasOver=!1,r._type=t.type||"text",r.boxShadow(r._boxShadow,!0),r._calcWH(),r._renderCanvas=document.createElement("canvas"),r._renderCanvas.setAttribute("width",r.outerW),r._renderCanvas.setAttribute("height",r.outerH),r._renderCtx=r._renderCanvas.getContext("2d"),r._shadowCanvas=document.createElement("canvas"),r._shadowCanvas.setAttribute("width",r._width+2*r._padding),r._shadowCanvas.setAttribute("height",r._height+2*r._padding),r._shadowCtx=r._shadowCanvas.getContext("2d"),"undefined"!=typeof t.backgroundGradient?(r._backgroundColor=r._renderCtx.createLinearGradient(0,0,0,r.outerH),r._backgroundColor.addColorStop(0,t.backgroundGradient[0]),r._backgroundColor.addColorStop(1,t.backgroundGradient[1])):r._backgroundColor=t.backgroundColor||"#fff",r._canvas&&(r._canvas.addEventListener("mousemove",function(e){e=e||window.event,r.mousemove(e,r)},!1),r._canvas.addEventListener("mousedown",function(e){e=e||window.event,r.mousedown(e,r)},!1),r._canvas.addEventListener("mouseup",function(e){e=e||window.event,r.mouseup(e,r)},!1)),window.addEventListener("mouseup",function(e){e=e||window.event,r._hasFocus&&!r._mouseDown&&r.blur()},!0),r._hiddenInput=document.createElement("input"),r._hiddenInput.type=r._type,r._hiddenInput.style.position="absolute",r._hiddenInput.style.opacity=0,r._hiddenInput.style.pointerEvents="none",r._hiddenInput.style.left=r._x+r._extraX+(r._canvas?r._canvas.offsetLeft:0)+"px",r._hiddenInput.style.top=r._y+r._extraY+(r._canvas?r._canvas.offsetTop:0)+"px",r._hiddenInput.style.width=r._width/2+"px",r._hiddenInput.style.height=r._height+"px",r._hiddenInput.style.zIndex=0,r._maxlength&&(r._hiddenInput.maxLength=r._maxlength),r._hiddenInput.oninput=function(){r.render()},document.body.appendChild(r._hiddenInput),r._hiddenInput.value=r._value,r._hiddenInput.addEventListener("keydown",function(e){e=e||window.event,r._hasFocus&&r.keydown(e,r),r.render()}),r._hiddenInput.addEventListener("keyup",function(e){e=e||window.event,r._value=r._hiddenInput.value,r.render(),r._hasFocus&&r._onkeyup(e,r)}),e.push(r),r._inputsIndex=e.length-1,r.render()};t.prototype={canvas:function(e){var t=this;return"undefined"!=typeof e?(t._canvas=e,t._ctx=t._canvas.getContext("2d"),t.render()):t._canvas},x:function(e){var t=this;return"undefined"!=typeof e?(t._x=e,t.render()):t._x},y:function(e){var t=this;return"undefined"!=typeof e?(t._y=e,t.render()):t._y},extraX:function(e){var t=this;return"undefined"!=typeof e?(t._extraX=e,t.render()):t._extraX},extraY:function(e){var t=this;return"undefined"!=typeof e?(t._extraY=e,t.render()):t._extraY},fontSize:function(e){var t=this;return"undefined"!=typeof e?(t._fontSize=e,t.render()):t._fontSize},fontFamily:function(e){var t=this;return"undefined"!=typeof e?(t._fontFamily=e,t.render()):t._fontFamily},fontColor:function(e){var t=this;return"undefined"!=typeof e?(t._fontColor=e,t.render()):t._fontColor},placeHolderColor:function(e){var t=this;return"undefined"!=typeof e?(t._placeHolderColor=e,t.render()):t._placeHolderColor},fontWeight:function(e){var t=this;return"undefined"!=typeof e?(t._fontWeight=e,t.render()):t._fontWeight},fontStyle:function(e){var t=this;return"undefined"!=typeof e?(t._fontStyle=e,t.render()):t._fontStyle},width:function(e){var t=this;return"undefined"!=typeof e?(t._width=e,t._calcWH(),t._updateCanvasWH(),t.render()):t._width},height:function(e){var t=this;return"undefined"!=typeof e?(t._height=e,t._calcWH(),t._updateCanvasWH(),t.render()):t._height},padding:function(e){var t=this;return"undefined"!=typeof e?(t._padding=e,t._calcWH(),t._updateCanvasWH(),t.render()):t._padding},borderWidth:function(e){var t=this;return"undefined"!=typeof e?(t._borderWidth=e,t._calcWH(),t._updateCanvasWH(),t.render()):t._borderWidth},borderColor:function(e){var t=this;return"undefined"!=typeof e?(t._borderColor=e,t.render()):t._borderColor},borderRadius:function(e){var t=this;return"undefined"!=typeof e?(t._borderRadius=e,t.render()):t._borderRadius},backgroundColor:function(e){var t=this;return"undefined"!=typeof e?(t._backgroundColor=e,t.render()):t._backgroundColor},backgroundGradient:function(e){var t=this;return"undefined"!=typeof e?(t._backgroundColor=t._renderCtx.createLinearGradient(0,0,0,t.outerH),t._backgroundColor.addColorStop(0,e[0]),t._backgroundColor.addColorStop(1,e[1]),t.render()):t._backgroundColor},boxShadow:function(e,t){var r=this;if("undefined"==typeof e)return r._boxShadow;var n=e.split("px ");return r._boxShadow={x:"none"===r._boxShadow?0:parseInt(n[0],10),y:"none"===r._boxShadow?0:parseInt(n[1],10),blur:"none"===r._boxShadow?0:parseInt(n[2],10),color:"none"===r._boxShadow?"":n[3]},r._boxShadow.x<0?(r.shadowL=Math.abs(r._boxShadow.x)+r._boxShadow.blur,r.shadowR=r._boxShadow.blur+r._boxShadow.x):(r.shadowL=Math.abs(r._boxShadow.blur-r._boxShadow.x),r.shadowR=r._boxShadow.blur+r._boxShadow.x),r._boxShadow.y<0?(r.shadowT=Math.abs(r._boxShadow.y)+r._boxShadow.blur,r.shadowB=r._boxShadow.blur+r._boxShadow.y):(r.shadowT=Math.abs(r._boxShadow.blur-r._boxShadow.y),r.shadowB=r._boxShadow.blur+r._boxShadow.y),r.shadowW=r.shadowL+r.shadowR,r.shadowH=r.shadowT+r.shadowB,r._calcWH(),t?void 0:(r._updateCanvasWH(),r.render())},innerShadow:function(e){var t=this;return"undefined"!=typeof e?(t._innerShadow=e,t.render()):t._innerShadow},selectionColor:function(e){var t=this;return"undefined"!=typeof e?(t._selectionColor=e,t.render()):t._selectionColor},placeHolder:function(e){var t=this;return"undefined"!=typeof e?(t._placeHolder=e,t.render()):t._placeHolder},value:function(e){var t=this;return"undefined"!=typeof e?(t._value=e+"",t._hiddenInput.value=e+"",t._cursorPos=t._clipText().length,t.render(),t):t._value===t._placeHolder?"":t._value},onsubmit:function(e){var t=this;return"undefined"!=typeof e?(t._onsubmit=e,t):void t._onsubmit()},onkeydown:function(e){var t=this;return"undefined"!=typeof e?(t._onkeydown=e,t):void t._onkeydown()},onkeyup:function(e){var t=this;return"undefined"!=typeof e?(t._onkeyup=e,t):void t._onkeyup()},focus:function(t){var r=this;if(!r._hasFocus){r._onfocus(r);for(var n=0;n<e.length;n++)e[n]._hasFocus&&e[n].blur()}if(r._selectionUpdated?delete r._selectionUpdated:r._selection=[0,0],r._hasFocus=!0,r._readonly)return void(r._hiddenInput.readOnly=!0);r._hiddenInput.readOnly=!1,r._cursorPos="number"==typeof t?t:r._clipText().length,r._placeHolder===r._value&&(r._value="",r._hiddenInput.value=""),r._resetCursor=function(){r._cursor=!0,r._cursorInterval&&clearInterval(r._cursorInterval),r._cursorInterval=setInterval(function(){r._cursor=!r._cursor,r.render()},500)},r._resetCursor();var i=r._selection[0]>0||r._selection[1]>0;return r._hiddenInput.focus(),r._hiddenInput.selectionStart=i?r._selection[0]:r._cursorPos,r._hiddenInput.selectionEnd=i?r._selection[1]:r._cursorPos,r.render()},blur:function(e){var t=e||this;return t._onblur(t),t._cursorInterval&&clearInterval(t._cursorInterval),t._hasFocus=!1,t._cursor=!1,t._selection=[0,0],t._hiddenInput.blur(),""===t._value&&(t._value=t._placeHolder),t.render()},keydown:function(t,r){{var n=t.which;t.shiftKey}if(r._resetCursor(),!r._readonly&&r._hasFocus){if(r._onkeydown(t,r),65===n&&(t.ctrlKey||t.metaKey))return r.selectText(),t.preventDefault(),r.render();if(17===n||t.metaKey||t.ctrlKey)return r.render();if(13===n)t.preventDefault(),r._onsubmit(t,r);else if(9===n&&(t.preventDefault(),e.length>1)){var i=e[r._inputsIndex+1]?r._inputsIndex+1:0;r.blur(),setTimeout(function(){e[i].focus()},10)}return r._value=r._hiddenInput.value,r._cursorPos=r._hiddenInput.selectionStart,r.render()}},click:function(e,t){var r=t._mousePos(e),n=r.x,i=r.y;return t._endSelection?(delete t._endSelection,void delete t._selectionUpdated):t._canvas&&t._overInput(n,i)||!t._canvas?t._mouseDown?(t._mouseDown=!1,t.click(e,t),t.focus(t._clickPos(n,i))):void 0:t.blur()},mousemove:function(e,t){var r=t._mousePos(e),n=r.x,i=r.y,o=t._overInput(n,i);if(o&&t._canvas?(t._canvas.style.cursor="text",t._wasOver=!0):t._wasOver&&t._canvas&&(t._canvas.style.cursor="default",t._wasOver=!1),t._hasFocus&&t._selectionStart>=0){var a=t._clickPos(n,i),s=Math.min(t._selectionStart,a),l=Math.max(t._selectionStart,a);if(!o)return t._selectionUpdated=!0,t._endSelection=!0,delete t._selectionStart,void t.render();(t._selection[0]!==s||t._selection[1]!==l)&&(t._selection=[s,l],t.render())}},mousedown:function(e,t){var r=t._mousePos(e),n=r.x,i=r.y,o=t._overInput(n,i);t._mouseDown=o,t._hasFocus&&o&&(t._selectionStart=t._clickPos(n,i))},mouseup:function(e,t){var r=t._mousePos(e),n=r.x,i=r.y,o=t._clickPos(n,i)!==t._selectionStart;t._hasFocus&&t._selectionStart>=0&&t._overInput(n,i)&&o?(t._selectionUpdated=!0,delete t._selectionStart,t.render()):delete t._selectionStart,t.click(e,t)},selectText:function(e){var t=this,e=e||[0,t._value.length];return setTimeout(function(){t._selection=[e[0],e[1]],t._hiddenInput.selectionStart=e[0],t._hiddenInput.selectionEnd=e[1],t.render()},1),t},renderCanvas:function(){return this._renderCanvas},render:function(){var e=this,t=e._renderCtx,r=e.outerW,n=e.outerH,i=e._borderRadius,o=e._borderWidth,a=e.shadowW,s=e.shadowH;t&&(t.clearRect(0,0,t.canvas.width,t.canvas.height),t.shadowOffsetX=e._boxShadow.x,t.shadowOffsetY=e._boxShadow.y,t.shadowBlur=e._boxShadow.blur,t.shadowColor=e._boxShadow.color,e._borderWidth>0&&(t.fillStyle=e._borderColor,e._roundedRect(t,e.shadowL,e.shadowT,r-a,n-s,i),t.fill(),t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0),e._drawTextBox(function(){t.shadowOffsetX=0,t.shadowOffsetY=0,t.shadowBlur=0,e._value=e._hiddenInput.value,e._cursorPos=e._hiddenInput.selectionStart;var l=e._clipText();l="password"===e._type&&l!=e._placeHolder?l.replace(/./g,"*"):l,e._selection=[e._hiddenInput.selectionStart,e._hiddenInput.selectionEnd],"forward"==e._hiddenInput.selectionDirection&&(e._cursorPos=e._hiddenInput.selectionEnd);var u=e._width-2*e._padding-2*e._borderWidth-e.shadowL,c=e._textWidth(l.substring(0,e._cursorPos)),d=c>u?u-c:0,h=e._padding+e._borderWidth+e.shadowT;if(e._hasFocus&&e._selection[1]>0){var f=e._textWidth(l.substring(0,e._selection[0])),p=e._textWidth(l.substring(e._selection[0],e._selection[1]));t.fillStyle=e._selectionColor,t.fillRect(h+f+d,h,p,e._height)}e._cursor&&(t.fillStyle=e._fontColor,t.fillRect(h+c+d,h,1,e._height));var m=e._padding+e._borderWidth+e.shadowL+d,g=Math.round(h+e._height/2);l=""===l&&e._placeHolder?e._placeHolder:l,t.fillStyle=""!==e._value&&e._value!==e._placeHolder?e._fontColor:e._placeHolderColor,t.font=e._fontStyle+" "+e._fontWeight+" "+e._fontSize+"px "+e._fontFamily,t.textAlign="left",t.textBaseline="middle",t.fillText(l,m,g);var v=e._innerShadow.split("px "),_="none"===e._innerShadow?0:parseInt(v[0],10),x="none"===e._innerShadow?0:parseInt(v[1],10),y="none"===e._innerShadow?0:parseInt(v[2],10),w="none"===e._innerShadow?"":v[3];if(y>0){var b=e._shadowCtx,E=b.canvas.width,T=b.canvas.height;b.clearRect(0,0,E,T),b.shadowBlur=y,b.shadowColor=w,b.shadowOffsetX=0,b.shadowOffsetY=x,b.fillRect(-1*r,-100,3*r,100),b.shadowOffsetX=_,b.shadowOffsetY=0,b.fillRect(E,-1*n,100,3*n),b.shadowOffsetX=0,b.shadowOffsetY=x,b.fillRect(-1*r,T,3*r,100),b.shadowOffsetX=_,b.shadowOffsetY=0,b.fillRect(-100,-1*n,100,3*n),e._roundedRect(t,o+e.shadowL,o+e.shadowT,r-2*o-a,n-2*o-s,i),t.clip(),t.drawImage(e._shadowCanvas,0,0,E,T,o+e.shadowL,o+e.shadowT,E,T)}return e._ctx&&(e._ctx.clearRect(e._x,e._y,t.canvas.width,t.canvas.height),e._ctx.drawImage(e._renderCanvas,e._x,e._y)),e}),e.onupdate&&e.onupdate())},destroy:function(){var t=this;t._hasFocus&&t.blur(),document.body.removeChild(t._hiddenInput),t._hiddenInput=null,t._renderCanvas=null,t._shadowCanvas=null,t._renderCtx=null;var r=e.indexOf(t);r>=0&&e.splice(r,1),0==e.length&&(e=[])},_drawTextBox:function(e){var t=this,r=t._renderCtx,n=t.outerW,i=t.outerH,o=t._borderRadius,a=t._borderWidth,s=t.shadowW,l=t.shadowH;if(""===t._backgroundImage)r.fillStyle=t._backgroundColor,t._roundedRect(r,a+t.shadowL,a+t.shadowT,n-2*a-s,i-2*a-l,o),r.fill(),e();else{var u=new Image;u.src=t._backgroundImage,u.onload=function(){r.drawImage(u,0,0,u.width,u.height,a+t.shadowL,a+t.shadowT,n,i),e()}}},_clearSelection:function(){var e=this;if(e._selection[1]>0){var t=e._selection[0],r=e._selection[1];return e._value=e._value.substr(0,t)+e._value.substr(r),e._cursorPos=t,e._cursorPos=e._cursorPos<0?0:e._cursorPos,e._selection=[0,0],!0}return!1},_clipText:function(e){var t=this;return e="undefined"==typeof e?t._value:e,e+""},_textWidth:function(e){var t=this,r=t._renderCtx;return r.font=t._fontStyle+" "+t._fontWeight+" "+t._fontSize+"px "+t._fontFamily,r.textAlign="left",r.measureText(e).width},_calcWH:function(){var e=this;e.outerW=e._width+2*e._padding+2*e._borderWidth+e.shadowW,e.outerH=e._height+2*e._padding+2*e._borderWidth+e.shadowH},_updateCanvasWH:function(){var e=this,t=e._renderCanvas.width,r=e._renderCanvas.height;e._renderCanvas.setAttribute("width",e.outerW),e._renderCanvas.setAttribute("height",e.outerH),e._shadowCanvas.setAttribute("width",e._width+2*e._padding),e._shadowCanvas.setAttribute("height",e._height+2*e._padding),e._ctx&&e._ctx.clearRect(e._x,e._y,t,r)},_roundedRect:function(e,t,r,n,i,o){2*o>n&&(o=n/2),2*o>i&&(o=i/2),e.beginPath(),e.moveTo(t+o,r),e.lineTo(t+n-o,r),e.quadraticCurveTo(t+n,r,t+n,r+o),e.lineTo(t+n,r+i-o),e.quadraticCurveTo(t+n,r+i,t+n-o,r+i),e.lineTo(t+o,r+i),e.quadraticCurveTo(t,r+i,t,r+i-o),e.lineTo(t,r+o),e.quadraticCurveTo(t,r,t+o,r),e.closePath()},_overInput:function(e,t){var r=this,n=e>=r._x+r._extraX,i=e<=r._x+r._extraX+r._width+2*r._padding,o=t>=r._y+r._extraY,a=t<=r._y+r._extraY+r._height+2*r._padding;return n&&i&&o&&a},_clickPos:function(e){var t=this,r=t._value;t._value===t._placeHolder&&(r="");var n=t._clipText(r),i=0,o=n.length;if(e-(t._x+t._extraX)<t._textWidth(n))for(var a=0;a<n.length;a++)if(i+=t._textWidth(n[a]),i>=e-(t._x+t._extraX)){o=a;break}return o},_mousePos:function(e){var t=e.target,r=document.defaultView.getComputedStyle(t,void 0),n=parseInt(r.paddingLeft,10)||0,i=parseInt(r.paddingLeft,10)||0,o=parseInt(r.borderLeftWidth,10)||0,a=parseInt(r.borderLeftWidth,10)||0,s=document.body.parentNode.offsetTop||0,l=document.body.parentNode.offsetLeft||0,u=0,c=0;if("undefined"!=typeof t.offsetParent)do u+=t.offsetLeft,c+=t.offsetTop;while(t=t.offsetParent);return u+=n+o+l,c+=i+a+s,{x:e.pageX-u,y:e.pageY-c}}}}(),!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.JSZip=e()}}(function(){return function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){var r=t[a][1][e];return i(r?r:e)},u,u.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){"use strict";var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(e){for(var t,r,i,o,a,s,l,u="",c=0;c<e.length;)t=e.charCodeAt(c++),r=e.charCodeAt(c++),i=e.charCodeAt(c++),o=t>>2,a=(3&t)<<4|r>>4,s=(15&r)<<2|i>>6,l=63&i,isNaN(r)?s=l=64:isNaN(i)&&(l=64),u=u+n.charAt(o)+n.charAt(a)+n.charAt(s)+n.charAt(l);return u},r.decode=function(e){var t,r,i,o,a,s,l,u="",c=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");c<e.length;)o=n.indexOf(e.charAt(c++)),a=n.indexOf(e.charAt(c++)),s=n.indexOf(e.charAt(c++)),l=n.indexOf(e.charAt(c++)),t=o<<2|a>>4,r=(15&a)<<4|s>>2,i=(3&s)<<6|l,u+=String.fromCharCode(t),64!=s&&(u+=String.fromCharCode(r)),64!=l&&(u+=String.fromCharCode(i));return u}},{}],2:[function(e,t){"use strict";function r(){this.compressedSize=0,this.uncompressedSize=0,this.crc32=0,this.compressionMethod=null,this.compressedContent=null}r.prototype={getContent:function(){return null},getCompressedContent:function(){return null}},t.exports=r},{}],3:[function(e,t,r){"use strict";r.STORE={magic:"\x00\x00",compress:function(e){return e},uncompress:function(e){return e},compressInputType:null,uncompressInputType:null},r.DEFLATE=e("./flate")},{"./flate":8}],4:[function(e,t){"use strict";var r=e("./utils"),n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];t.exports=function(e,t){if("undefined"==typeof e||!e.length)return 0;var i="string"!==r.getTypeOf(e);"undefined"==typeof t&&(t=0);var o=0,a=0,s=0;t=-1^t;for(var l=0,u=e.length;u>l;l++)s=i?e[l]:e.charCodeAt(l),a=255&(t^s),o=n[a],t=t>>>8^o;return-1^t}},{"./utils":21}],5:[function(e,t){"use strict";function r(){this.data=null,this.length=0,this.index=0}var n=e("./utils");r.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<e||0>e)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,r=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)r=(r<<8)+this.byteAt(t);return this.index+=e,r},readString:function(e){return n.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1)}},t.exports=r},{"./utils":21}],6:[function(e,t,r){"use strict";r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!1,r.date=null,r.compression=null,r.comment=null},{}],7:[function(e,t,r){"use strict";var n=e("./utils");r.string2binary=function(e){return n.string2binary(e)},r.string2Uint8Array=function(e){return n.transformTo("uint8array",e)},r.uint8Array2String=function(e){return n.transformTo("string",e)},r.string2Blob=function(e){var t=n.transformTo("arraybuffer",e);return n.arrayBuffer2Blob(t)},r.arrayBuffer2Blob=function(e){return n.arrayBuffer2Blob(e)},r.transformTo=function(e,t){return n.transformTo(e,t)},r.getTypeOf=function(e){return n.getTypeOf(e)},r.checkSupport=function(e){return n.checkSupport(e)},r.MAX_VALUE_16BITS=n.MAX_VALUE_16BITS,r.MAX_VALUE_32BITS=n.MAX_VALUE_32BITS,r.pretty=function(e){return n.pretty(e)},r.findCompression=function(e){return n.findCompression(e)},r.isRegExp=function(e){return n.isRegExp(e)}},{"./utils":21}],8:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,i=e("pako");r.uncompressInputType=n?"uint8array":"array",r.compressInputType=n?"uint8array":"array",r.magic="\b\x00",r.compress=function(e){return i.deflateRaw(e)},r.uncompress=function(e){return i.inflateRaw(e)}},{pako:24}],9:[function(e,t){"use strict";function r(e,t){return this instanceof r?(this.files={},this.comment=null,this.root="",e&&this.load(e,t),void(this.clone=function(){var e=new r;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e})):new r(e,t)}var n=e("./base64");r.prototype=e("./object"),r.prototype.load=e("./load"),r.support=e("./support"),r.defaults=e("./defaults"),r.utils=e("./deprecatedPublicUtils"),r.base64={encode:function(e){return n.encode(e)},decode:function(e){return n.decode(e)}},r.compressions=e("./compressions"),t.exports=r},{"./base64":1,"./compressions":3,"./defaults":6,"./deprecatedPublicUtils":7,"./load":10,"./object":13,"./support":17}],10:[function(e,t){"use strict";var r=e("./base64"),n=e("./zipEntries");t.exports=function(e,t){var i,o,a,s;for(t=t||{},t.base64&&(e=r.decode(e)),o=new n(e,t),i=o.files,a=0;a<i.length;a++)s=i[a],this.file(s.fileName,s.decompressed,{binary:!0,optimizedBinaryString:!0,date:s.date,dir:s.dir,comment:s.fileComment.length?s.fileComment:null,createFolders:t.createFolders});return o.zipComment.length&&(this.comment=o.zipComment),this}},{"./base64":1,"./zipEntries":22}],11:[function(e,t){(function(e){"use strict";t.exports=function(t,r){return new e(t,r)},t.exports.test=function(t){return e.isBuffer(t)}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],12:[function(e,t){"use strict";function r(e){this.data=e,this.length=this.data.length,this.index=0}var n=e("./uint8ArrayReader");r.prototype=new n,r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=r},{"./uint8ArrayReader":18}],13:[function(e,t){"use strict";var r=e("./support"),n=e("./utils"),i=e("./crc32"),o=e("./signature"),a=e("./defaults"),s=e("./base64"),l=e("./compressions"),u=e("./compressedObject"),c=e("./nodeBuffer"),d=e("./utf8"),h=e("./stringWriter"),f=e("./uint8ArrayWriter"),p=function(e){if(e._data instanceof u&&(e._data=e._data.getContent(),e.options.binary=!0,e.options.base64=!1,"uint8array"===n.getTypeOf(e._data))){var t=e._data;e._data=new Uint8Array(t.length),0!==t.length&&e._data.set(t,0)}return e._data},m=function(e){var t=p(e),i=n.getTypeOf(t);return"string"===i?!e.options.binary&&r.nodebuffer?c(t,"utf-8"):e.asBinary():t},g=function(e){var t=p(this);return null===t||"undefined"==typeof t?"":(this.options.base64&&(t=s.decode(t)),t=e&&this.options.binary?R.utf8decode(t):n.transformTo("string",t),e||this.options.binary||(t=n.transformTo("string",R.utf8encode(t))),t)},v=function(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this._data=t,this.options=r,this._initialMetadata={dir:r.dir,date:r.date}};v.prototype={asText:function(){return g.call(this,!0)},asBinary:function(){return g.call(this,!1)},asNodeBuffer:function(){var e=m(this);return n.transformTo("nodebuffer",e)},asUint8Array:function(){var e=m(this);return n.transformTo("uint8array",e)},asArrayBuffer:function(){return this.asUint8Array().buffer}};var _=function(e,t){var r,n="";for(r=0;t>r;r++)n+=String.fromCharCode(255&e),e>>>=8;return n},x=function(){var e,t,r={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&"undefined"==typeof r[t]&&(r[t]=arguments[e][t]);return r},y=function(e){return e=e||{},e.base64!==!0||null!==e.binary&&void 0!==e.binary||(e.binary=!0),e=x(e,a),e.date=e.date||new Date,null!==e.compression&&(e.compression=e.compression.toUpperCase()),e},w=function(e,t,r){var i,o=n.getTypeOf(t);if(r=y(r),r.createFolders&&(i=b(e))&&E.call(this,i,!0),r.dir||null===t||"undefined"==typeof t)r.base64=!1,r.binary=!1,t=null;else if("string"===o)r.binary&&!r.base64&&r.optimizedBinaryString!==!0&&(t=n.string2binary(t));else{if(r.base64=!1,r.binary=!0,!(o||t instanceof u))throw new Error("The data of '"+e+"' is in an unsupported format !");"arraybuffer"===o&&(t=n.transformTo("uint8array",t))}var a=new v(e,t,r);return this.files[e]=a,a},b=function(e){"/"==e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},E=function(e,t){return"/"!=e.slice(-1)&&(e+="/"),t="undefined"!=typeof t?t:!1,this.files[e]||w.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]},T=function(e,t){var r,o=new u;return e._data instanceof u?(o.uncompressedSize=e._data.uncompressedSize,o.crc32=e._data.crc32,0===o.uncompressedSize||e.dir?(t=l.STORE,o.compressedContent="",o.crc32=0):e._data.compressionMethod===t.magic?o.compressedContent=e._data.getCompressedContent():(r=e._data.getContent(),o.compressedContent=t.compress(n.transformTo(t.compressInputType,r)))):(r=m(e),(!r||0===r.length||e.dir)&&(t=l.STORE,r=""),o.uncompressedSize=r.length,o.crc32=i(r),o.compressedContent=t.compress(n.transformTo(t.compressInputType,r))),o.compressedSize=o.compressedContent.length,o.compressionMethod=t.magic,o},M=function(e,t,r,a){var s,l,u,c,h=(r.compressedContent,n.transformTo("string",d.utf8encode(t.name))),f=t.comment||"",p=n.transformTo("string",d.utf8encode(f)),m=h.length!==t.name.length,g=p.length!==f.length,v=t.options,x="",y="",w="";u=t._initialMetadata.dir!==t.dir?t.dir:v.dir,c=t._initialMetadata.date!==t.date?t.date:v.date,s=c.getHours(),s<<=6,s|=c.getMinutes(),s<<=5,s|=c.getSeconds()/2,l=c.getFullYear()-1980,l<<=4,l|=c.getMonth()+1,l<<=5,l|=c.getDate(),m&&(y=_(1,1)+_(i(h),4)+h,x+="up"+_(y.length,2)+y),g&&(w=_(1,1)+_(this.crc32(p),4)+p,x+="uc"+_(w.length,2)+w);var b="";b+="\n\x00",b+=m||g?"\x00\b":"\x00\x00",b+=r.compressionMethod,b+=_(s,2),b+=_(l,2),b+=_(r.crc32,4),b+=_(r.compressedSize,4),b+=_(r.uncompressedSize,4),b+=_(h.length,2),b+=_(x.length,2);var E=o.LOCAL_FILE_HEADER+b+h+x,T=o.CENTRAL_FILE_HEADER+"\x00"+b+_(p.length,2)+"\x00\x00\x00\x00"+(u===!0?"\x00\x00\x00":"\x00\x00\x00\x00")+_(a,4)+h+x+p;return{fileRecord:E,dirRecord:T,compressedObject:r}},R={load:function(){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")},filter:function(e){var t,r,n,i,o=[];for(t in this.files)this.files.hasOwnProperty(t)&&(n=this.files[t],i=new v(n.name,n._data,x(n.options)),r=t.slice(this.root.length,t.length),t.slice(0,this.root.length)===this.root&&e(r,i)&&o.push(i));return o},file:function(e,t,r){if(1===arguments.length){if(n.isRegExp(e)){var i=e;return this.filter(function(e,t){return!t.dir&&i.test(e)})}return this.filter(function(t,r){return!r.dir&&t===e})[0]||null}return e=this.root+e,w.call(this,e,t,r),this},folder:function(e){if(!e)return this;if(n.isRegExp(e))return this.filter(function(t,r){return r.dir&&e.test(t)});var t=this.root+e,r=E.call(this,t),i=this.clone();return i.root=r.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!=e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter(function(t,r){return r.name.slice(0,e.length)===e}),n=0;n<r.length;n++)delete this.files[r[n].name];return this},generate:function(e){e=x(e||{},{base64:!0,compression:"STORE",type:"base64",comment:null}),n.checkSupport(e.type);var t,r,i=[],a=0,u=0,c=n.transformTo("string",this.utf8encode(e.comment||this.comment||""));for(var d in this.files)if(this.files.hasOwnProperty(d)){var p=this.files[d],m=p.options.compression||e.compression.toUpperCase(),g=l[m];if(!g)throw new Error(m+" is not a valid compression method !");var v=T.call(this,p,g),y=M.call(this,d,p,v,a);a+=y.fileRecord.length+v.compressedSize,u+=y.dirRecord.length,i.push(y)}var w="";w=o.CENTRAL_DIRECTORY_END+"\x00\x00\x00\x00"+_(i.length,2)+_(i.length,2)+_(u,4)+_(a,4)+_(c.length,2)+c;var b=e.type.toLowerCase();for(t="uint8array"===b||"arraybuffer"===b||"blob"===b||"nodebuffer"===b?new f(a+u+w.length):new h(a+u+w.length),r=0;r<i.length;r++)t.append(i[r].fileRecord),t.append(i[r].compressedObject.compressedContent);for(r=0;r<i.length;r++)t.append(i[r].dirRecord);t.append(w);var E=t.finalize();switch(e.type.toLowerCase()){case"uint8array":case"arraybuffer":case"nodebuffer":return n.transformTo(e.type.toLowerCase(),E);case"blob":return n.arrayBuffer2Blob(n.transformTo("arraybuffer",E));case"base64":return e.base64?s.encode(E):E;default:return E}},crc32:function(e,t){return i(e,t)},utf8encode:function(e){return n.transformTo("string",d.utf8encode(e))},utf8decode:function(e){return d.utf8decode(e)}};t.exports=R},{"./base64":1,"./compressedObject":2,"./compressions":3,"./crc32":4,"./defaults":6,"./nodeBuffer":11,"./signature":14,"./stringWriter":16,"./support":17,"./uint8ArrayWriter":19,"./utf8":20,"./utils":21}],14:[function(e,t,r){"use strict";r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],15:[function(e,t){"use strict";function r(e,t){this.data=e,t||(this.data=i.string2binary(this.data)),this.length=this.data.length,this.index=0}var n=e("./dataReader"),i=e("./utils");r.prototype=new n,r.prototype.byteAt=function(e){return this.data.charCodeAt(e)},r.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)},r.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.index,this.index+e);return this.index+=e,t},t.exports=r},{"./dataReader":5,"./utils":21}],16:[function(e,t){"use strict";var r=e("./utils"),n=function(){this.data=[]};n.prototype={append:function(e){e=r.transformTo("string",e),this.data.push(e)},finalize:function(){return this.data.join("")
}},t.exports=n},{"./utils":21}],17:[function(e,t,r){(function(e){"use strict";if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof e,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var t=new ArrayBuffer(0);try{r.blob=0===new Blob([t],{type:"application/zip"}).size}catch(e){try{var n=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,i=new n;i.append(t),r.blob=0===i.getBlob("application/zip").size}catch(e){r.blob=!1}}}}).call(this,"undefined"!=typeof Buffer?Buffer:void 0)},{}],18:[function(e,t){"use strict";function r(e){e&&(this.data=e,this.length=this.data.length,this.index=0)}var n=e("./dataReader");r.prototype=new n,r.prototype.byteAt=function(e){return this.data[e]},r.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),n=e.charCodeAt(2),i=e.charCodeAt(3),o=this.length-4;o>=0;--o)if(this.data[o]===t&&this.data[o+1]===r&&this.data[o+2]===n&&this.data[o+3]===i)return o;return-1},r.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.index,this.index+e);return this.index+=e,t},t.exports=r},{"./dataReader":5}],19:[function(e,t){"use strict";var r=e("./utils"),n=function(e){this.data=new Uint8Array(e),this.index=0};n.prototype={append:function(e){0!==e.length&&(e=r.transformTo("uint8array",e),this.data.set(e,this.index),this.index+=e.length)},finalize:function(){return this.data}},t.exports=n},{"./utils":21}],20:[function(e,t,r){"use strict";for(var n=e("./utils"),i=e("./support"),o=e("./nodeBuffer"),a=new Array(256),s=0;256>s;s++)a[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;a[254]=a[254]=1;var l=function(e){var t,r,n,o,a,s=e.length,l=0;for(o=0;s>o;o++)r=e.charCodeAt(o),55296===(64512&r)&&s>o+1&&(n=e.charCodeAt(o+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),o++)),l+=128>r?1:2048>r?2:65536>r?3:4;for(t=i.uint8array?new Uint8Array(l):new Array(l),a=0,o=0;l>a;o++)r=e.charCodeAt(o),55296===(64512&r)&&s>o+1&&(n=e.charCodeAt(o+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),o++)),128>r?t[a++]=r:2048>r?(t[a++]=192|r>>>6,t[a++]=128|63&r):65536>r?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t},u=function(e,t){var r;for(t=t||e.length,t>e.length&&(t=e.length),r=t-1;r>=0&&128===(192&e[r]);)r--;return 0>r?t:0===r?t:r+a[e[r]]>t?r:t},c=function(e){var t,r,i,o,s=e.length,l=new Array(2*s);for(r=0,t=0;s>t;)if(i=e[t++],128>i)l[r++]=i;else if(o=a[i],o>4)l[r++]=65533,t+=o-1;else{for(i&=2===o?31:3===o?15:7;o>1&&s>t;)i=i<<6|63&e[t++],o--;o>1?l[r++]=65533:65536>i?l[r++]=i:(i-=65536,l[r++]=55296|i>>10&1023,l[r++]=56320|1023&i)}return l.length!==r&&(l.subarray?l=l.subarray(0,r):l.length=r),n.applyFromCharCode(l)};r.utf8encode=function(e){return i.nodebuffer?o(e,"utf-8"):l(e)},r.utf8decode=function(e){if(i.nodebuffer)return n.transformTo("nodebuffer",e).toString("utf-8");e=n.transformTo(i.uint8array?"uint8array":"array",e);for(var t=[],r=0,o=e.length,a=65536;o>r;){var s=u(e,Math.min(r+a,o));t.push(i.uint8array?c(e.subarray(r,s)):c(e.slice(r,s))),r=s}return t.join("")}},{"./nodeBuffer":11,"./support":17,"./utils":21}],21:[function(e,t,r){"use strict";function n(e){return e}function i(e,t){for(var r=0;r<e.length;++r)t[r]=255&e.charCodeAt(r);return t}function o(e){var t=65536,n=[],i=e.length,o=r.getTypeOf(e),a=0,s=!0;try{switch(o){case"uint8array":String.fromCharCode.apply(null,new Uint8Array(0));break;case"nodebuffer":String.fromCharCode.apply(null,u(0))}}catch(e){s=!1}if(!s){for(var l="",c=0;c<e.length;c++)l+=String.fromCharCode(e[c]);return l}for(;i>a&&t>1;)try{n.push("array"===o||"nodebuffer"===o?String.fromCharCode.apply(null,e.slice(a,Math.min(a+t,i))):String.fromCharCode.apply(null,e.subarray(a,Math.min(a+t,i)))),a+=t}catch(e){t=Math.floor(t/2)}return n.join("")}function a(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}var s=e("./support"),l=e("./compressions"),u=e("./nodeBuffer");r.string2binary=function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(255&e.charCodeAt(r));return t},r.arrayBuffer2Blob=function(e){r.checkSupport("blob");try{return new Blob([e],{type:"application/zip"})}catch(r){try{var t=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder,n=new t;return n.append(e),n.getBlob("application/zip")}catch(e){throw new Error("Bug : can't construct the Blob.")}}},r.applyFromCharCode=o;var c={};c.string={string:n,array:function(e){return i(e,new Array(e.length))},arraybuffer:function(e){return c.string.uint8array(e).buffer},uint8array:function(e){return i(e,new Uint8Array(e.length))},nodebuffer:function(e){return i(e,u(e.length))}},c.array={string:o,array:n,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return u(e)}},c.arraybuffer={string:function(e){return o(new Uint8Array(e))},array:function(e){return a(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:n,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return u(new Uint8Array(e))}},c.uint8array={string:o,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:n,nodebuffer:function(e){return u(e)}},c.nodebuffer={string:o,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return c.nodebuffer.uint8array(e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:n},r.transformTo=function(e,t){if(t||(t=""),!e)return t;r.checkSupport(e);var n=r.getTypeOf(t),i=c[n][e](t);return i},r.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":s.nodebuffer&&u.test(e)?"nodebuffer":s.uint8array&&e instanceof Uint8Array?"uint8array":s.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(e){var t=s[e.toLowerCase()];if(!t)throw new Error(e+" is not supported by this browser")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(e){var t,r,n="";for(r=0;r<(e||"").length;r++)t=e.charCodeAt(r),n+="\\x"+(16>t?"0":"")+t.toString(16).toUpperCase();return n},r.findCompression=function(e){for(var t in l)if(l.hasOwnProperty(t)&&l[t].magic===e)return l[t];return null},r.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)}},{"./compressions":3,"./nodeBuffer":11,"./support":17}],22:[function(e,t){"use strict";function r(e,t){this.files=[],this.loadOptions=t,e&&this.load(e)}var n=e("./stringReader"),i=e("./nodeBufferReader"),o=e("./uint8ArrayReader"),a=e("./utils"),s=e("./signature"),l=e("./zipEntry"),u=e("./support"),c=e("./object");r.prototype={checkSignature:function(e){var t=this.reader.readString(4);if(t!==e)throw new Error("Corrupted zip or bug : unexpected signature ("+a.pretty(t)+", expected "+a.pretty(e)+")")},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2),this.zipComment=this.reader.readString(this.zipCommentLength),this.zipComment=c.utf8decode(this.zipComment)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.versionMadeBy=this.reader.readString(2),this.versionNeeded=this.reader.readInt(2),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,r,n=this.zip64EndOfCentralSize-44,i=0;n>i;)e=this.reader.readInt(2),t=this.reader.readInt(4),r=this.reader.readString(t),this.zip64ExtensibleData[e]={id:e,length:t,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(s.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readString(4)===s.CENTRAL_FILE_HEADER;)e=new l({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(s.CENTRAL_DIRECTORY_END);if(-1===e)throw new Error("Corrupted zip : can't find end of central directory");if(this.reader.setIndex(e),this.checkSignature(s.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),-1===e)throw new Error("Corrupted zip : can't find the ZIP64 end of central directory locator");this.reader.setIndex(e),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(s.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}},prepareReader:function(e){var t=a.getTypeOf(e);this.reader="string"!==t||u.uint8array?"nodebuffer"===t?new i(e):new o(a.transformTo("uint8array",e)):new n(e,this.loadOptions.optimizedBinaryString)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=r},{"./nodeBufferReader":12,"./object":13,"./signature":14,"./stringReader":15,"./support":17,"./uint8ArrayReader":18,"./utils":21,"./zipEntry":23}],23:[function(e,t){"use strict";function r(e,t){this.options=e,this.loadOptions=t}var n=e("./stringReader"),i=e("./utils"),o=e("./compressedObject"),a=e("./object");r.prototype={isEncrypted:function(){return 1===(1&this.bitFlag)},useUTF8:function(){return 2048===(2048&this.bitFlag)},prepareCompressedContent:function(e,t,r){return function(){var n=e.index;e.setIndex(t);var i=e.readData(r);return e.setIndex(n),i}},prepareContent:function(e,t,r,n,o){return function(){var e=i.transformTo(n.uncompressInputType,this.getCompressedContent()),t=n.uncompress(e);if(t.length!==o)throw new Error("Bug : uncompressed data size mismatch");return t}},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readString(this.fileNameLength),e.skip(r),-1==this.compressedSize||-1==this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize == -1 || uncompressedSize == -1)");if(t=i.findCompression(this.compressionMethod),null===t)throw new Error("Corrupted zip : compression "+i.pretty(this.compressionMethod)+" unknown (inner file : "+this.fileName+")");if(this.decompressed=new o,this.decompressed.compressedSize=this.compressedSize,this.decompressed.uncompressedSize=this.uncompressedSize,this.decompressed.crc32=this.crc32,this.decompressed.compressionMethod=this.compressionMethod,this.decompressed.getCompressedContent=this.prepareCompressedContent(e,e.index,this.compressedSize,t),this.decompressed.getContent=this.prepareContent(e,e.index,this.compressedSize,t,this.uncompressedSize),this.loadOptions.checkCRC32&&(this.decompressed=i.transformTo("string",this.decompressed.getContent()),a.crc32(this.decompressed)!==this.crc32))throw new Error("Corrupted zip : CRC32 mismatch")},readCentralPart:function(e){if(this.versionMadeBy=e.readString(2),this.versionNeeded=e.readInt(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4),this.fileNameLength=e.readInt(2),this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");this.fileName=e.readString(this.fileNameLength),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readString(this.fileCommentLength),this.dir=16&this.externalFileAttributes?!0:!1},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=new n(this.extraFields[1].value);this.uncompressedSize===i.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===i.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===i.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===i.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,r,n,i=e.index;for(this.extraFields=this.extraFields||{};e.index<i+this.extraFieldsLength;)t=e.readInt(2),r=e.readInt(2),n=e.readString(r),this.extraFields[t]={id:t,length:r,value:n}},handleUTF8:function(){if(this.useUTF8())this.fileName=a.utf8decode(this.fileName),this.fileComment=a.utf8decode(this.fileComment);else{var e=this.findExtraFieldUnicodePath();null!==e&&(this.fileName=e);var t=this.findExtraFieldUnicodeComment();null!==t&&(this.fileComment=t)}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=new n(e.value);return 1!==t.readInt(1)?null:a.crc32(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readString(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=new n(e.value);return 1!==t.readInt(1)?null:a.crc32(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readString(e.length-5))}return null}},t.exports=r},{"./compressedObject":2,"./object":13,"./stringReader":15,"./utils":21}],24:[function(e,t){"use strict";var r=e("./lib/utils/common").assign,n=e("./lib/deflate"),i=e("./lib/inflate"),o=e("./lib/zlib/constants"),a={};r(a,n,i,o),t.exports=a},{"./lib/deflate":25,"./lib/inflate":26,"./lib/utils/common":27,"./lib/zlib/constants":30}],25:[function(e,t,r){"use strict";function n(){}function i(){}function o(e,t){return t=t||{},t.gzip=!0,n(e,t)}var a=(e("./zlib/deflate.js"),e("./utils/common"),e("./utils/strings"),e("./zlib/messages"),e("./zlib/zstream"),function(){});a.prototype.push=function(){},a.prototype.onEnd=function(){},r.Deflate=a,r.deflate=n,r.deflateRaw=i,r.gzip=o},{"./utils/common":27,"./utils/strings":28,"./zlib/deflate.js":32,"./zlib/messages":37,"./zlib/zstream":39}],26:[function(e,t,r){"use strict";function n(e,t){var r=new h(t);if(r.push(e,!0),r.err)throw r.msg;return r.result}function i(e,t){return t=t||{},t.raw=!0,n(e,t)}var o=e("./zlib/inflate.js"),a=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/constants"),u=e("./zlib/messages"),c=e("./zlib/zstream"),d=e("./zlib/gzheader"),h=function(e){this.options=a.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0===(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var r=o.inflateInit2(this.strm,t.windowBits);if(r!==l.Z_OK)throw new Error(u[r]);this.header=new d,o.inflateGetHeader(this.strm,this.header)};h.prototype.push=function(e,t){var r,n,i,u,c,d=this.strm,h=this.options.chunkSize;if(this.ended)return!1;n=t===~~t?t:t===!0?l.Z_FINISH:l.Z_NO_FLUSH,d.input="string"==typeof e?s.binstring2buf(e):e,d.next_in=0,d.avail_in=d.input.length;do{if(0===d.avail_out&&(d.output=new a.Buf8(h),d.next_out=0,d.avail_out=h),r=o.inflate(d,l.Z_NO_FLUSH),r!==l.Z_STREAM_END&&r!==l.Z_OK)return this.onEnd(r),this.ended=!0,!1;d.next_out&&(0===d.avail_out||r===l.Z_STREAM_END||0===d.avail_in&&n===l.Z_FINISH)&&("string"===this.options.to?(i=s.utf8border(d.output,d.next_out),u=d.next_out-i,c=s.buf2string(d.output,i),d.next_out=u,d.avail_out=h-u,u&&a.arraySet(d.output,d.output,i,u,0),this.onData(c)):this.onData(a.shrinkBuf(d.output,d.next_out)))}while(d.avail_in>0&&r!==l.Z_STREAM_END);return r===l.Z_STREAM_END&&(n=l.Z_FINISH),n===l.Z_FINISH?(r=o.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===l.Z_OK):!0},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){e===l.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):a.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},r.Inflate=h,r.inflate=n,r.inflateRaw=i,r.ungzip=n},{"./utils/common":27,"./utils/strings":28,"./zlib/constants":30,"./zlib/gzheader":33,"./zlib/inflate.js":35,"./zlib/messages":37,"./zlib/zstream":39}],27:[function(e,t,r){"use strict";var n="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])}}return e},r.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var i={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)return void e.set(t.subarray(r,r+n),i);for(var o=0;n>o;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,a;for(n=0,t=0,r=e.length;r>t;t++)n+=e[t].length;for(a=new Uint8Array(n),i=0,t=0,r=e.length;r>t;t++)o=e[t],a.set(o,i),i+=o.length;return a}},o={arraySet:function(e,t,r,n,i){for(var o=0;n>o;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};r.setTyped=function(e){e?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,i)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,o))},r.setTyped(n)},{}],28:[function(e,t,r){"use strict";function n(e,t){if(65537>t&&(e.subarray&&a||!e.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(e,t));for(var r="",n=0;t>n;n++)r+=String.fromCharCode(e[n]);return r}var i=e("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch(e){o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){a=!1}for(var s=new i.Buf8(256),l=0;256>l;l++)s[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;s[254]=s[254]=1,r.string2buf=function(e){var t,r,n,o,a,s=e.length,l=0;for(o=0;s>o;o++)r=e.charCodeAt(o),55296===(64512&r)&&s>o+1&&(n=e.charCodeAt(o+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),o++)),l+=128>r?1:2048>r?2:65536>r?3:4;for(t=new i.Buf8(l),a=0,o=0;l>a;o++)r=e.charCodeAt(o),55296===(64512&r)&&s>o+1&&(n=e.charCodeAt(o+1),56320===(64512&n)&&(r=65536+(r-55296<<10)+(n-56320),o++)),128>r?t[a++]=r:2048>r?(t[a++]=192|r>>>6,t[a++]=128|63&r):65536>r?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|63&r):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|63&r);return t},r.buf2binstring=function(e){return n(e,e.length)},r.binstring2buf=function(e){for(var t=new i.Buf8(e.length),r=0,n=t.length;n>r;r++)t[r]=e.charCodeAt(r);return t},r.buf2string=function(e,t){var r,i,o,a,l=t||e.length,u=new Array(2*l);for(i=0,r=0;l>r;)if(o=e[r++],128>o)u[i++]=o;else if(a=s[o],a>4)u[i++]=65533,r+=a-1;else{for(o&=2===a?31:3===a?15:7;a>1&&l>r;)o=o<<6|63&e[r++],a--;a>1?u[i++]=65533:65536>o?u[i++]=o:(o-=65536,u[i++]=55296|o>>10&1023,u[i++]=56320|1023&o)}return n(u,i)},r.utf8border=function(e,t){var r;for(t=t||e.length,t>e.length&&(t=e.length),r=t-1;r>=0&&128===(192&e[r]);)r--;return 0>r?t:0===r?t:r+s[e[r]]>t?r:t}},{"./common":27}],29:[function(e,t){"use strict";function r(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,a=0;0!==r;){a=r>2e3?2e3:r,r-=a;do i=i+t[n++]|0,o=o+i|0;while(--a);i%=65521,o%=65521}return i|o<<16|0}t.exports=r},{}],30:[function(e,t){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],31:[function(e,t){"use strict";function r(){for(var e,t=[],r=0;256>r;r++){e=r;for(var n=0;8>n;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}function n(e,t,r,n){var o=i,a=n+r;e=-1^e;for(var s=n;a>s;s++)e=e>>>8^o[255&(e^t[s])];return-1^e}var i=r();t.exports=n},{}],32:[function(e,t,r){"use strict";function n(){}function i(){}function o(){}function a(){}function s(){}function l(){}function u(){}function c(){}function d(){}function h(){}var f,p=(e("../utils/common"),e("./trees"),e("./adler32"),e("./crc32"),e("./messages"),function(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i});f=[new p(0,0,0,0,n),new p(4,4,8,4,i),new p(4,5,16,8,i),new p(4,6,32,32,i),new p(4,4,16,16,o),new p(8,16,32,32,o),new p(8,16,128,128,o),new p(8,32,128,256,o),new p(32,128,258,1024,o),new p(32,258,258,4096,o)],r.deflateInit=c,r.deflateInit2=u,r.deflateReset=s,r.deflateResetKeep=a,r.deflateSetHeader=l,r.deflate=d,r.deflateEnd=h,r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./messages":37,"./trees":38}],33:[function(e,t){"use strict";function r(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}t.exports=r},{}],34:[function(e,t){"use strict";var r=30,n=12;t.exports=function(e,t){var i,o,a,s,l,u,c,d,h,f,p,m,g,v,_,x,y,w,b,E,T,M,R,S,A;i=e.state,o=e.next_in,S=e.input,a=o+(e.avail_in-5),s=e.next_out,A=e.output,l=s-(t-e.avail_out),u=s+(e.avail_out-257),c=i.dmax,d=i.wsize,h=i.whave,f=i.wnext,p=i.window,m=i.hold,g=i.bits,v=i.lencode,_=i.distcode,x=(1<<i.lenbits)-1,y=(1<<i.distbits)-1;e:do{15>g&&(m+=S[o++]<<g,g+=8,m+=S[o++]<<g,g+=8),w=v[m&x];t:for(;;){if(b=w>>>24,m>>>=b,g-=b,b=w>>>16&255,0===b)A[s++]=65535&w;else{if(!(16&b)){if(0===(64&b)){w=v[(65535&w)+(m&(1<<b)-1)];continue t}if(32&b){i.mode=n;break e}e.msg="invalid literal/length code",i.mode=r;break e}E=65535&w,b&=15,b&&(b>g&&(m+=S[o++]<<g,g+=8),E+=m&(1<<b)-1,m>>>=b,g-=b),15>g&&(m+=S[o++]<<g,g+=8,m+=S[o++]<<g,g+=8),w=_[m&y];r:for(;;){if(b=w>>>24,m>>>=b,g-=b,b=w>>>16&255,!(16&b)){if(0===(64&b)){w=_[(65535&w)+(m&(1<<b)-1)];continue r}e.msg="invalid distance code",i.mode=r;break e}if(T=65535&w,b&=15,b>g&&(m+=S[o++]<<g,g+=8,b>g&&(m+=S[o++]<<g,g+=8)),T+=m&(1<<b)-1,T>c){e.msg="invalid distance too far back",i.mode=r;break e}if(m>>>=b,g-=b,b=s-l,T>b){if(b=T-b,b>h&&i.sane){e.msg="invalid distance too far back",i.mode=r;break e}if(M=0,R=p,0===f){if(M+=d-b,E>b){E-=b;do A[s++]=p[M++];while(--b);M=s-T,R=A}}else if(b>f){if(M+=d+f-b,b-=f,E>b){E-=b;do A[s++]=p[M++];while(--b);if(M=0,E>f){b=f,E-=b;do A[s++]=p[M++];while(--b);M=s-T,R=A}}}else if(M+=f-b,E>b){E-=b;do A[s++]=p[M++];while(--b);M=s-T,R=A}for(;E>2;)A[s++]=R[M++],A[s++]=R[M++],A[s++]=R[M++],E-=3;E&&(A[s++]=R[M++],E>1&&(A[s++]=R[M++]))}else{M=s-T;do A[s++]=A[M++],A[s++]=A[M++],A[s++]=A[M++],E-=3;while(E>2);E&&(A[s++]=A[M++],E>1&&(A[s++]=A[M++]))}break}}break}}while(a>o&&u>s);E=g>>3,o-=E,g-=E<<3,m&=(1<<g)-1,e.next_in=o,e.next_out=s,e.avail_in=a>o?5+(a-o):5-(o-a),e.avail_out=u>s?257+(u-s):257-(s-u),i.hold=m,i.bits=g}},{}],35:[function(e,t,r){"use strict";function n(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function i(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new v.Buf16(320),this.work=new v.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=B,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new v.Buf32(pt),t.distcode=t.distdyn=new v.Buf32(mt),t.sane=1,t.back=-1,A):z}function a(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,o(e)):z}function s(e,t){var r,n;return e&&e.state?(n=e.state,0>t?(r=0,t=-t):(r=(t>>4)+1,48>t&&(t&=15)),t&&(8>t||t>15)?z:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,a(e))):z}function l(e,t){var r,n;return e?(n=new i,e.state=n,n.window=null,r=s(e,t),r!==A&&(e.state=null),r):z}function u(e){return l(e,vt)}function c(e){if(_t){var t;for(m=new v.Buf32(512),g=new v.Buf32(32),t=0;144>t;)e.lens[t++]=8;for(;256>t;)e.lens[t++]=9;for(;280>t;)e.lens[t++]=7;for(;288>t;)e.lens[t++]=8;for(w(E,e.lens,0,288,m,0,e.work,{bits:9}),t=0;32>t;)e.lens[t++]=5;w(T,e.lens,0,32,g,0,e.work,{bits:5}),_t=!1}e.lencode=m,e.lenbits=9,e.distcode=g,e.distbits=5}function d(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new v.Buf8(o.wsize)),n>=o.wsize?(v.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),v.arraySet(o.window,t,r-n,i,o.wnext),n-=i,n?(v.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}function h(e,t){var r,i,o,a,s,l,u,h,f,p,m,g,pt,mt,gt,vt,_t,xt,yt,wt,bt,Et,Tt,Mt,Rt=0,St=new v.Buf8(4),At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return z;r=e.state,r.mode===G&&(r.mode=Y),s=e.next_out,o=e.output,u=e.avail_out,a=e.next_in,i=e.input,l=e.avail_in,h=r.hold,f=r.bits,p=l,m=u,Et=A;e:for(;;)switch(r.mode){case B:if(0===r.wrap){r.mode=Y;break}for(;16>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}if(2&r.wrap&&35615===h){r.check=0,St[0]=255&h,St[1]=h>>>8&255,r.check=x(r.check,St,2,0),h=0,f=0,r.mode=U;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&h)<<8)+(h>>8))%31){e.msg="incorrect header check",r.mode=dt;break}if((15&h)!==O){e.msg="unknown compression method",r.mode=dt;break}if(h>>>=4,f-=4,bt=(15&h)+8,0===r.wbits)r.wbits=bt;else if(bt>r.wbits){e.msg="invalid window size",r.mode=dt;break}r.dmax=1<<bt,e.adler=r.check=1,r.mode=512&h?X:G,h=0,f=0;break;case U:for(;16>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}if(r.flags=h,(255&r.flags)!==O){e.msg="unknown compression method",r.mode=dt;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=dt;break}r.head&&(r.head.text=h>>8&1),512&r.flags&&(St[0]=255&h,St[1]=h>>>8&255,r.check=x(r.check,St,2,0)),h=0,f=0,r.mode=L;case L:for(;32>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}r.head&&(r.head.time=h),512&r.flags&&(St[0]=255&h,St[1]=h>>>8&255,St[2]=h>>>16&255,St[3]=h>>>24&255,r.check=x(r.check,St,4,0)),h=0,f=0,r.mode=F;case F:for(;16>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}r.head&&(r.head.xflags=255&h,r.head.os=h>>8),512&r.flags&&(St[0]=255&h,St[1]=h>>>8&255,r.check=x(r.check,St,2,0)),h=0,f=0,r.mode=H;case H:if(1024&r.flags){for(;16>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}r.length=h,r.head&&(r.head.extra_len=h),512&r.flags&&(St[0]=255&h,St[1]=h>>>8&255,r.check=x(r.check,St,2,0)),h=0,f=0}else r.head&&(r.head.extra=null);r.mode=V;case V:if(1024&r.flags&&(g=r.length,g>l&&(g=l),g&&(r.head&&(bt=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),v.arraySet(r.head.extra,i,a,g,bt)),512&r.flags&&(r.check=x(r.check,i,g,a)),l-=g,a+=g,r.length-=g),r.length))break e;r.length=0,r.mode=W;case W:if(2048&r.flags){if(0===l)break e;g=0;do bt=i[a+g++],r.head&&bt&&r.length<65536&&(r.head.name+=String.fromCharCode(bt));while(bt&&l>g);if(512&r.flags&&(r.check=x(r.check,i,g,a)),l-=g,a+=g,bt)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=j;case j:if(4096&r.flags){if(0===l)break e;g=0;do bt=i[a+g++],r.head&&bt&&r.length<65536&&(r.head.comment+=String.fromCharCode(bt));while(bt&&l>g);if(512&r.flags&&(r.check=x(r.check,i,g,a)),l-=g,a+=g,bt)break e}else r.head&&(r.head.comment=null);r.mode=N;case N:if(512&r.flags){for(;16>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}if(h!==(65535&r.check)){e.msg="header crc mismatch",r.mode=dt;break}h=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=G;break;case X:for(;32>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}e.adler=r.check=n(h),h=0,f=0,r.mode=q;case q:if(0===r.havedict)return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=l,r.hold=h,r.bits=f,C;e.adler=r.check=1,r.mode=G;case G:if(t===R||t===S)break e;case Y:if(r.last){h>>>=7&f,f-=7&f,r.mode=lt;break}for(;3>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}switch(r.last=1&h,h>>>=1,f-=1,3&h){case 0:r.mode=Z;break;case 1:if(c(r),r.mode=tt,t===S){h>>>=2,f-=2;break e}break;case 2:r.mode=Q;break;case 3:e.msg="invalid block type",r.mode=dt}h>>>=2,f-=2;break;case Z:for(h>>>=7&f,f-=7&f;32>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}if((65535&h)!==(h>>>16^65535)){e.msg="invalid stored block lengths",r.mode=dt;break}if(r.length=65535&h,h=0,f=0,r.mode=K,t===S)break e;case K:r.mode=J;case J:if(g=r.length){if(g>l&&(g=l),g>u&&(g=u),0===g)break e;v.arraySet(o,i,a,g,s),l-=g,a+=g,u-=g,s+=g,r.length-=g;break}r.mode=G;break;case Q:for(;14>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}if(r.nlen=(31&h)+257,h>>>=5,f-=5,r.ndist=(31&h)+1,h>>>=5,f-=5,r.ncode=(15&h)+4,h>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=dt;break}r.have=0,r.mode=$;case $:for(;r.have<r.ncode;){for(;3>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}r.lens[At[r.have++]]=7&h,h>>>=3,f-=3}for(;r.have<19;)r.lens[At[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Tt={bits:r.lenbits},Et=w(b,r.lens,0,19,r.lencode,0,r.work,Tt),r.lenbits=Tt.bits,Et){e.msg="invalid code lengths set",r.mode=dt;break}r.have=0,r.mode=et;case et:for(;r.have<r.nlen+r.ndist;){for(;Rt=r.lencode[h&(1<<r.lenbits)-1],gt=Rt>>>24,vt=Rt>>>16&255,_t=65535&Rt,!(f>=gt);){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}if(16>_t)h>>>=gt,f-=gt,r.lens[r.have++]=_t;else{if(16===_t){for(Mt=gt+2;Mt>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}if(h>>>=gt,f-=gt,0===r.have){e.msg="invalid bit length repeat",r.mode=dt;break}bt=r.lens[r.have-1],g=3+(3&h),h>>>=2,f-=2}else if(17===_t){for(Mt=gt+3;Mt>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}h>>>=gt,f-=gt,bt=0,g=3+(7&h),h>>>=3,f-=3}else{for(Mt=gt+7;Mt>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}h>>>=gt,f-=gt,bt=0,g=11+(127&h),h>>>=7,f-=7}if(r.have+g>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=dt;break}for(;g--;)r.lens[r.have++]=bt}}if(r.mode===dt)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=dt;break}if(r.lenbits=9,Tt={bits:r.lenbits},Et=w(E,r.lens,0,r.nlen,r.lencode,0,r.work,Tt),r.lenbits=Tt.bits,Et){e.msg="invalid literal/lengths set",r.mode=dt;break}if(r.distbits=6,r.distcode=r.distdyn,Tt={bits:r.distbits},Et=w(T,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Tt),r.distbits=Tt.bits,Et){e.msg="invalid distances set",r.mode=dt;break}if(r.mode=tt,t===S)break e;case tt:r.mode=rt;case rt:if(l>=6&&u>=258){e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=l,r.hold=h,r.bits=f,y(e,m),s=e.next_out,o=e.output,u=e.avail_out,a=e.next_in,i=e.input,l=e.avail_in,h=r.hold,f=r.bits,r.mode===G&&(r.back=-1);break}for(r.back=0;Rt=r.lencode[h&(1<<r.lenbits)-1],gt=Rt>>>24,vt=Rt>>>16&255,_t=65535&Rt,!(f>=gt);){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}if(vt&&0===(240&vt)){for(xt=gt,yt=vt,wt=_t;Rt=r.lencode[wt+((h&(1<<xt+yt)-1)>>xt)],gt=Rt>>>24,vt=Rt>>>16&255,_t=65535&Rt,!(f>=xt+gt);){if(0===l)break e;
l--,h+=i[a++]<<f,f+=8}h>>>=xt,f-=xt,r.back+=xt}if(h>>>=gt,f-=gt,r.back+=gt,r.length=_t,0===vt){r.mode=st;break}if(32&vt){r.back=-1,r.mode=G;break}if(64&vt){e.msg="invalid literal/length code",r.mode=dt;break}r.extra=15&vt,r.mode=nt;case nt:if(r.extra){for(Mt=r.extra;Mt>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=it;case it:for(;Rt=r.distcode[h&(1<<r.distbits)-1],gt=Rt>>>24,vt=Rt>>>16&255,_t=65535&Rt,!(f>=gt);){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}if(0===(240&vt)){for(xt=gt,yt=vt,wt=_t;Rt=r.distcode[wt+((h&(1<<xt+yt)-1)>>xt)],gt=Rt>>>24,vt=Rt>>>16&255,_t=65535&Rt,!(f>=xt+gt);){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}h>>>=xt,f-=xt,r.back+=xt}if(h>>>=gt,f-=gt,r.back+=gt,64&vt){e.msg="invalid distance code",r.mode=dt;break}r.offset=_t,r.extra=15&vt,r.mode=ot;case ot:if(r.extra){for(Mt=r.extra;Mt>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=dt;break}r.mode=at;case at:if(0===u)break e;if(g=m-u,r.offset>g){if(g=r.offset-g,g>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=dt;break}g>r.wnext?(g-=r.wnext,pt=r.wsize-g):pt=r.wnext-g,g>r.length&&(g=r.length),mt=r.window}else mt=o,pt=s-r.offset,g=r.length;g>u&&(g=u),u-=g,r.length-=g;do o[s++]=mt[pt++];while(--g);0===r.length&&(r.mode=rt);break;case st:if(0===u)break e;o[s++]=r.length,u--,r.mode=rt;break;case lt:if(r.wrap){for(;32>f;){if(0===l)break e;l--,h|=i[a++]<<f,f+=8}if(m-=u,e.total_out+=m,r.total+=m,m&&(e.adler=r.check=r.flags?x(r.check,o,m,s-m):_(r.check,o,m,s-m)),m=u,(r.flags?h:n(h))!==r.check){e.msg="incorrect data check",r.mode=dt;break}h=0,f=0}r.mode=ut;case ut:if(r.wrap&&r.flags){for(;32>f;){if(0===l)break e;l--,h+=i[a++]<<f,f+=8}if(h!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=dt;break}h=0,f=0}r.mode=ct;case ct:Et=P;break e;case dt:Et=I;break e;case ht:return k;case ft:default:return z}return e.next_out=s,e.avail_out=u,e.next_in=a,e.avail_in=l,r.hold=h,r.bits=f,(r.wsize||m!==e.avail_out&&r.mode<dt&&(r.mode<lt||t!==M))&&d(e,e.output,e.next_out,m-e.avail_out)?(r.mode=ht,k):(p-=e.avail_in,m-=e.avail_out,e.total_in+=p,e.total_out+=m,r.total+=m,r.wrap&&m&&(e.adler=r.check=r.flags?x(r.check,o,m,e.next_out-m):_(r.check,o,m,e.next_out-m)),e.data_type=r.bits+(r.last?64:0)+(r.mode===G?128:0)+(r.mode===tt||r.mode===K?256:0),(0===p&&0===m||t===M)&&Et===A&&(Et=D),Et)}function f(e){if(!e||!e.state)return z;var t=e.state;return t.window&&(t.window=null),e.state=null,A}function p(e,t){var r;return e&&e.state?(r=e.state,0===(2&r.wrap)?z:(r.head=t,t.done=!1,A)):z}var m,g,v=e("../utils/common"),_=e("./adler32"),x=e("./crc32"),y=e("./inffast"),w=e("./inftrees"),b=0,E=1,T=2,M=4,R=5,S=6,A=0,P=1,C=2,z=-2,I=-3,k=-4,D=-5,O=8,B=1,U=2,L=3,F=4,H=5,V=6,W=7,j=8,N=9,X=10,q=11,G=12,Y=13,Z=14,K=15,J=16,Q=17,$=18,et=19,tt=20,rt=21,nt=22,it=23,ot=24,at=25,st=26,lt=27,ut=28,ct=29,dt=30,ht=31,ft=32,pt=852,mt=592,gt=15,vt=gt,_t=!0;r.inflateReset=a,r.inflateReset2=s,r.inflateResetKeep=o,r.inflateInit=u,r.inflateInit2=l,r.inflate=h,r.inflateEnd=f,r.inflateGetHeader=p,r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":27,"./adler32":29,"./crc32":31,"./inffast":34,"./inftrees":36}],36:[function(e,t){"use strict";var r=e("../utils/common"),n=15,i=852,o=592,a=0,s=1,l=2,u=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],c=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],d=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],h=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,f,p,m,g,v,_){var x,y,w,b,E,T,M,R,S,A=_.bits,P=0,C=0,z=0,I=0,k=0,D=0,O=0,B=0,U=0,L=0,F=null,H=0,V=new r.Buf16(n+1),W=new r.Buf16(n+1),j=null,N=0;for(P=0;n>=P;P++)V[P]=0;for(C=0;p>C;C++)V[t[f+C]]++;for(k=A,I=n;I>=1&&0===V[I];I--);if(k>I&&(k=I),0===I)return m[g++]=20971520,m[g++]=20971520,_.bits=1,0;for(z=1;I>z&&0===V[z];z++);for(z>k&&(k=z),B=1,P=1;n>=P;P++)if(B<<=1,B-=V[P],0>B)return-1;if(B>0&&(e===a||1!==I))return-1;for(W[1]=0,P=1;n>P;P++)W[P+1]=W[P]+V[P];for(C=0;p>C;C++)0!==t[f+C]&&(v[W[t[f+C]]++]=C);if(e===a?(F=j=v,T=19):e===s?(F=u,H-=257,j=c,N-=257,T=256):(F=d,j=h,T=-1),L=0,C=0,P=z,E=g,D=k,O=0,w=-1,U=1<<k,b=U-1,e===s&&U>i||e===l&&U>o)return 1;for(var X=0;;){X++,M=P-O,v[C]<T?(R=0,S=v[C]):v[C]>T?(R=j[N+v[C]],S=F[H+v[C]]):(R=96,S=0),x=1<<P-O,y=1<<D,z=y;do y-=x,m[E+(L>>O)+y]=M<<24|R<<16|S|0;while(0!==y);for(x=1<<P-1;L&x;)x>>=1;if(0!==x?(L&=x-1,L+=x):L=0,C++,0===--V[P]){if(P===I)break;P=t[f+v[C]]}if(P>k&&(L&b)!==w){for(0===O&&(O=k),E+=z,D=P-O,B=1<<D;I>D+O&&(B-=V[D+O],!(0>=B));)D++,B<<=1;if(U+=1<<D,e===s&&U>i||e===l&&U>o)return 1;w=L&b,m[w]=k<<24|D<<16|E-g|0}}return 0!==L&&(m[E+L]=P-O<<24|64<<16|0),_.bits=k,0}},{"../utils/common":27}],37:[function(e,t){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],38:[function(e,t,r){"use strict";function n(e){for(var t=e.length;--t>=0;)e[t]=0}function i(e){return 256>e?at[e]:at[256+(e>>>7)]}function o(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function a(e,t,r){e.bi_valid>G-r?(e.bi_buf|=t<<e.bi_valid&65535,o(e,e.bi_buf),e.bi_buf=t>>G-e.bi_valid,e.bi_valid+=r-G):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function s(e,t,r){a(e,r[2*t],r[2*t+1])}function l(e,t){var r=0;do r|=1&e,e>>>=1,r<<=1;while(--t>0);return r>>>1}function u(e){16===e.bi_valid?(o(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function c(e,t){var r,n,i,o,a,s,l=t.dyn_tree,u=t.max_code,c=t.stat_desc.static_tree,d=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,m=0;for(o=0;q>=o;o++)e.bl_count[o]=0;for(l[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;X>r;r++)n=e.heap[r],o=l[2*l[2*n+1]+1]+1,o>p&&(o=p,m++),l[2*n+1]=o,n>u||(e.bl_count[o]++,a=0,n>=f&&(a=h[n-f]),s=l[2*n],e.opt_len+=s*(o+a),d&&(e.static_len+=s*(c[2*n+1]+a)));if(0!==m){do{for(o=p-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[p]--,m-=2}while(m>0);for(o=p;0!==o;o--)for(n=e.bl_count[o];0!==n;)i=e.heap[--r],i>u||(l[2*i+1]!==o&&(e.opt_len+=(o-l[2*i+1])*l[2*i],l[2*i+1]=o),n--)}}function d(e,t,r){var n,i,o=new Array(q+1),a=0;for(n=1;q>=n;n++)o[n]=a=a+r[n-1]<<1;for(i=0;t>=i;i++){var s=e[2*i+1];0!==s&&(e[2*i]=l(o[s]++,s))}}function h(){var e,t,r,n,i,o=new Array(q+1);for(r=0,n=0;H-1>n;n++)for(lt[n]=r,e=0;e<1<<$[n];e++)st[r++]=n;for(st[r-1]=n,i=0,n=0;16>n;n++)for(ut[n]=i,e=0;e<1<<et[n];e++)at[i++]=n;for(i>>=7;j>n;n++)for(ut[n]=i<<7,e=0;e<1<<et[n]-7;e++)at[256+i++]=n;for(t=0;q>=t;t++)o[t]=0;for(e=0;143>=e;)it[2*e+1]=8,e++,o[8]++;for(;255>=e;)it[2*e+1]=9,e++,o[9]++;for(;279>=e;)it[2*e+1]=7,e++,o[7]++;for(;287>=e;)it[2*e+1]=8,e++,o[8]++;for(d(it,W+1,o),e=0;j>e;e++)ot[2*e+1]=5,ot[2*e]=l(e,5);ct=new ft(it,$,V+1,W,q),dt=new ft(ot,et,0,j,q),ht=new ft(new Array(0),tt,0,N,Y)}function f(e){var t;for(t=0;W>t;t++)e.dyn_ltree[2*t]=0;for(t=0;j>t;t++)e.dyn_dtree[2*t]=0;for(t=0;N>t;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*Z]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function p(e){e.bi_valid>8?o(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function m(e,t,r,n){p(e),n&&(o(e,r),o(e,~r)),C.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}function g(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function v(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&g(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!g(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function _(e,t,r){var n,o,l,u,c=0;if(0!==e.last_lit)do n=e.pending_buf[e.d_buf+2*c]<<8|e.pending_buf[e.d_buf+2*c+1],o=e.pending_buf[e.l_buf+c],c++,0===n?s(e,o,t):(l=st[o],s(e,l+V+1,t),u=$[l],0!==u&&(o-=lt[l],a(e,o,u)),n--,l=i(n),s(e,l,r),u=et[l],0!==u&&(n-=ut[l],a(e,n,u)));while(c<e.last_lit);s(e,Z,t)}function x(e,t){var r,n,i,o=t.dyn_tree,a=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,u=-1;for(e.heap_len=0,e.heap_max=X,r=0;l>r;r++)0!==o[2*r]?(e.heap[++e.heap_len]=u=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)i=e.heap[++e.heap_len]=2>u?++u:0,o[2*i]=1,e.depth[i]=0,e.opt_len--,s&&(e.static_len-=a[2*i+1]);for(t.max_code=u,r=e.heap_len>>1;r>=1;r--)v(e,o,r);i=l;do r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],v(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,v(e,o,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],c(e,t),d(o,u,e.bl_count)}function y(e,t,r){var n,i,o=-1,a=t[1],s=0,l=7,u=4;for(0===a&&(l=138,u=3),t[2*(r+1)+1]=65535,n=0;r>=n;n++)i=a,a=t[2*(n+1)+1],++s<l&&i===a||(u>s?e.bl_tree[2*i]+=s:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*K]++):10>=s?e.bl_tree[2*J]++:e.bl_tree[2*Q]++,s=0,o=i,0===a?(l=138,u=3):i===a?(l=6,u=3):(l=7,u=4))}function w(e,t,r){var n,i,o=-1,l=t[1],u=0,c=7,d=4;for(0===l&&(c=138,d=3),n=0;r>=n;n++)if(i=l,l=t[2*(n+1)+1],!(++u<c&&i===l)){if(d>u)do s(e,i,e.bl_tree);while(0!==--u);else 0!==i?(i!==o&&(s(e,i,e.bl_tree),u--),s(e,K,e.bl_tree),a(e,u-3,2)):10>=u?(s(e,J,e.bl_tree),a(e,u-3,3)):(s(e,Q,e.bl_tree),a(e,u-11,7));u=0,o=i,0===l?(c=138,d=3):i===l?(c=6,d=3):(c=7,d=4)}}function b(e){var t;for(y(e,e.dyn_ltree,e.l_desc.max_code),y(e,e.dyn_dtree,e.d_desc.max_code),x(e,e.bl_desc),t=N-1;t>=3&&0===e.bl_tree[2*rt[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function E(e,t,r,n){var i;for(a(e,t-257,5),a(e,r-1,5),a(e,n-4,4),i=0;n>i;i++)a(e,e.bl_tree[2*rt[i]+1],3);w(e,e.dyn_ltree,t-1),w(e,e.dyn_dtree,r-1)}function T(e){var t,r=4093624447;for(t=0;31>=t;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return I;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return k;for(t=32;V>t;t++)if(0!==e.dyn_ltree[2*t])return k;return I}function M(e){mt||(h(),mt=!0),e.l_desc=new pt(e.dyn_ltree,ct),e.d_desc=new pt(e.dyn_dtree,dt),e.bl_desc=new pt(e.bl_tree,ht),e.bi_buf=0,e.bi_valid=0,f(e)}function R(e,t,r,n){a(e,(O<<1)+(n?1:0),3),m(e,t,r,!0)}function S(e){a(e,B<<1,3),s(e,Z,it),u(e)}function A(e,t,r,n){var i,o,s=0;e.level>0?(e.strm.data_type===D&&(e.strm.data_type=T(e)),x(e,e.l_desc),x(e,e.d_desc),s=b(e),i=e.opt_len+3+7>>>3,o=e.static_len+3+7>>>3,i>=o&&(i=o)):i=o=r+5,i>=r+4&&-1!==t?R(e,t,r,n):e.strategy===z||o===i?(a(e,(B<<1)+(n?1:0),3),_(e,it,ot)):(a(e,(U<<1)+(n?1:0),3),E(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),_(e,e.dyn_ltree,e.dyn_dtree)),f(e),n&&p(e)}function P(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(st[r]+V+1)]++,e.dyn_dtree[2*i(t)]++),e.last_lit===e.lit_bufsize-1}var C=e("../utils/common"),z=4,I=0,k=1,D=2,O=0,B=1,U=2,L=3,F=258,H=29,V=256,W=V+1+H,j=30,N=19,X=2*W+1,q=15,G=16,Y=7,Z=256,K=16,J=17,Q=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],et=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],tt=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],rt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],nt=512,it=new Array(2*(W+2));n(it);var ot=new Array(2*j);n(ot);var at=new Array(nt);n(at);var st=new Array(F-L+1);n(st);var lt=new Array(H);n(lt);var ut=new Array(j);n(ut);var ct,dt,ht,ft=function(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length},pt=function(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t},mt=!1;r._tr_init=M,r._tr_stored_block=R,r._tr_flush_block=A,r._tr_tally=P,r._tr_align=S},{"../utils/common":27}],39:[function(e,t){"use strict";function r(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}t.exports=r},{}]},{},[9])(9)}),!function(e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):"undefined"!=typeof window?window.JSZipUtils=e():"undefined"!=typeof global?global.JSZipUtils=e():"undefined"!=typeof self&&(self.JSZipUtils=e())}(function(){return function e(t,r,n){function i(a,s){if(!r[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var u=r[a]={exports:{}};t[a][0].call(u.exports,function(e){var r=t[a][1][e];return i(r?r:e)},u,u.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t){"use strict";function r(){try{return new window.XMLHttpRequest}catch(e){}}function n(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}var i={};i._getBinaryFromXHR=function(e){return e.response||e.responseText};var o=window.ActiveXObject?function(){return r()||n()}:r;i.getBinaryContent=function(e,t){try{var r=o();r.open("GET",e,!0),"responseType"in r&&(r.responseType="arraybuffer"),r.overrideMimeType&&r.overrideMimeType("text/plain; charset=x-user-defined"),r.onreadystatechange=function(){var n,o;if(4===r.readyState)if(200===r.status||0===r.status){n=null,o=null;try{n=i._getBinaryFromXHR(r)}catch(e){o=new Error(e)}t(o,n)}else t(new Error("Ajax error for "+e+" : "+this.status+" "+this.statusText),null)},r.send()}catch(e){t(new Error(e),null)}},t.exports=i},{}]},{},[1])(1)}),/**
 @preserve
 https://github.com/frenchtoast747/webgl-obj-loader
 Copyright (c) 2013 Aaron Boman and aaronboman.com
*/
function(e,t){"use strict";var r={};"undefined"!=typeof module?module.exports=r:e.OBJ=r,r.Mesh=function(e){var t=[],r=[],n=[],i={};i.verts=[],i.norms=[],i.textures=[],i.hashindices={},i.indices=[],i.index=0;for(var o=e.split("\n"),a=/^v\s/,s=/^vn\s/,l=/^vt\s/,u=/^f\s/,c=/\s+/,d=0;d<o.length;d++){var h=o[d].trim(),f=h.split(c);if(f.shift(),a.test(h))t.push.apply(t,f);else if(s.test(h))r.push.apply(r,f);else if(l.test(h))n.push.apply(n,f);else if(u.test(h))for(var p=!1,m=0,g=f.length;g>m;m++){if(3!==m||p||(m=2,p=!0),f[m]in i.hashindices)i.indices.push(i.hashindices[f[m]]);else{var v=f[m].split("/");i.verts.push(+t[3*(v[0]-1)+0]),i.verts.push(+t[3*(v[0]-1)+1]),i.verts.push(+t[3*(v[0]-1)+2]),n.length&&(i.textures.push(+n[2*(v[1]-1)+0]),i.textures.push(+n[2*(v[1]-1)+1])),i.norms.push(+r[3*(v[2]-1)+0]),i.norms.push(+r[3*(v[2]-1)+1]),i.norms.push(+r[3*(v[2]-1)+2]),i.hashindices[f[m]]=i.index,i.indices.push(i.index),i.index+=1}3===m&&p&&i.indices.push(i.hashindices[f[0]])}}this.vertices=i.verts,this.vertexNormals=i.norms,this.textures=i.textures,this.indices=i.indices};var n=function(){var e=this;this.xmlhttp=new XMLHttpRequest,this.get=function(t,r){e.xmlhttp.onreadystatechange=function(){4===e.xmlhttp.readyState&&r(e.xmlhttp.responseText,e.xmlhttp.status)},e.xmlhttp.open("GET",t,!0),e.xmlhttp.send()}};r.downloadMeshes=function(e,i,o){var a=Object.keys(e).length,s=!1;o===t&&(o={});for(var l in e)e.hasOwnProperty(l)&&(new n).get(e[l],function(e){return function(t,n){if(200===n?o[e]=new r.Mesh(t):(s=!0,console.error('An error has occurred and the mesh "'+e+'" could not be downloaded.')),a--,0===a){if(s)throw console.error("An error has occurred and one or meshes has not been downloaded. The execution of the script has terminated."),"";i(o)}}}(l))};var i=function(e,t,r,n){var i=e.createBuffer(),o=t===e.ARRAY_BUFFER?Float32Array:Uint16Array;return e.bindBuffer(t,i),e.bufferData(t,new o(r),e.STATIC_DRAW),i.itemSize=n,i.numItems=r.length/n,i};r.initMeshBuffers=function(e,t){t.normalBuffer=i(e,e.ARRAY_BUFFER,t.vertexNormals,3),t.textureBuffer=i(e,e.ARRAY_BUFFER,t.textures,2),t.vertexBuffer=i(e,e.ARRAY_BUFFER,t.vertices,3),t.indexBuffer=i(e,e.ELEMENT_ARRAY_BUFFER,t.indices,1)},r.deleteMeshBuffers=function(e,t){e.deleteBuffer(t.normalBuffer),e.deleteBuffer(t.textureBuffer),e.deleteBuffer(t.vertexBuffer),e.deleteBuffer(t.indexBuffer)}}(this),/**
@preserve

Curlify - A javascript webgl framework
<http://curlify.io>

(c) 2013-2015 Curlify LLC
*/
function(){document.currentScript=document.currentScript||document._currentScript||document.getElementsByTagName("script")[document.getElementsByTagName("script").length-1],console.log("initialize curlify",document.currentScript,Date.now()),document.currentScript.curlify={modules:{},localVars:{},extract:function(obj,objId){var code=[];for(var i in obj)if(obj.hasOwnProperty(i))try{eval("var "+i),code.push("var "+i+"="+objId+'["'+i+'"]')}catch(e){}return code.join(";")},module:function(e,t){null!=this.modules[e]&&console.log("WARNING: overwriting module",e),null==t&&console.log("ERROR: setting null code as module '"+e+"'"),this.modules[e]=t},getModule:function(e){return this.modules[e]},clearModuleBuffersAndPrograms:function(){console.log("clearModuleBuffersAndPrograms()");for(var e in this.modules){var t=this.modules[e];console.log("checking",t.id),null!=t.default_program&&(console.log("clearing module program",t.id),t.default_program.glProgram=null),null!=t.buffer&&(console.log("clearing module buffer",t.id),t.buffer=null)}}},document.currentScript.curlify.localVars.sensors={acceleration:{x:0,y:0,z:0},rotationRate:{x:0,y:0,z:0},orientation:{alpha:0,beta:0,gamma:0},damped_orientation:{alpha:0,beta:0,gamma:0,inertia:10}},document.currentScript.curlify.localVars.zipfile=null,document.currentScript.curlify.localVars.layoutWidth=null,document.currentScript.curlify.localVars.layoutHeight=null,document.currentScript.curlify.localVars.layoutOffset={x:0,y:0},document.currentScript.curlify.localVars.layoutScale={x:1,y:1},document.currentScript.curlify.localVars.gl=null,document.currentScript.curlify.localVars.camera=null,document.currentScript.curlify.localVars.viewWidth=null,document.currentScript.curlify.localVars.viewHeight=null,document.currentScript.curlify.localVars.screenWidth=null,document.currentScript.curlify.localVars.screenHeight=null}(),/**@preserve
 * @license
 * @fileoverview gl-matrix - High performance matrix and vector operations
 * @author Brandon Jones
 * @author Colin MacKenzie IV
 * @version 2.2.2
 */
function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){var e={};if(!t)var t=1e-6;if(!r)var r="undefined"!=typeof Float32Array?Float32Array:Array;if(!n)var n=Math.random;var i={};i.setMatrixArrayType=function(e){r=e},"undefined"!=typeof e&&(e.glMatrix=i);var o=Math.PI/180;i.toRadian=function(e){return e*o};var a={};a.create=function(){var e=new r(2);return e[0]=0,e[1]=0,e},a.clone=function(e){var t=new r(2);return t[0]=e[0],t[1]=e[1],t},a.fromValues=function(e,t){var n=new r(2);return n[0]=e,n[1]=t,n},a.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e},a.set=function(e,t,r){return e[0]=t,e[1]=r,e},a.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e},a.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e},a.sub=a.subtract,a.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e},a.mul=a.multiply,a.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e},a.div=a.divide,a.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e},a.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e},a.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e},a.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e},a.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)},a.dist=a.distance,a.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n},a.sqrDist=a.squaredDistance,a.length=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)},a.len=a.length,a.squaredLength=function(e){var t=e[0],r=e[1];return t*t+r*r},a.sqrLen=a.squaredLength,a.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e},a.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e},a.normalize=function(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e},a.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},a.cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e},a.lerp=function(e,t,r,n){var i=t[0],o=t[1];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e},a.random=function(e,t){t=t||1;var r=2*n()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e},a.transformMat2=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e},a.transformMat2d=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e},a.transformMat3=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e},a.transformMat4=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e},a.forEach=function(){var e=a.create();return function(t,r,n,i,o,a){var s,l;for(r||(r=2),n||(n=0),l=i?Math.min(i*r+n,t.length):t.length,s=n;l>s;s+=r)e[0]=t[s],e[1]=t[s+1],o(e,e,a),t[s]=e[0],t[s+1]=e[1];return t}}(),a.str=function(e){return"vec2("+e[0]+", "+e[1]+")"},"undefined"!=typeof e&&(e.vec2=a);var s={};s.create=function(){var e=new r(3);return e[0]=0,e[1]=0,e[2]=0,e},s.clone=function(e){var t=new r(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},s.fromValues=function(e,t,n){var i=new r(3);return i[0]=e,i[1]=t,i[2]=n,i},s.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},s.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e},s.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e},s.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},s.sub=s.subtract,s.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e},s.mul=s.multiply,s.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e},s.div=s.divide,s.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e},s.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e},s.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e},s.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e},s.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)},s.dist=s.distance,s.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i},s.sqrDist=s.squaredDistance,s.length=function(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)},s.len=s.length,s.squaredLength=function(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n},s.sqrLen=s.squaredLength,s.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},s.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e},s.normalize=function(e,t){var r=t[0],n=t[1],i=t[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o),e},s.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},s.cross=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],l=r[2];return e[0]=i*l-o*s,e[1]=o*a-n*l,e[2]=n*s-i*a,e},s.lerp=function(e,t,r,n){var i=t[0],o=t[1],a=t[2];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e},s.random=function(e,t){t=t||1;var r=2*n()*Math.PI,i=2*n()-1,o=Math.sqrt(1-i*i)*t;return e[0]=Math.cos(r)*o,e[1]=Math.sin(r)*o,e[2]=i*t,e},s.transformMat4=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[3]*n+r[7]*i+r[11]*o+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/a,e[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/a,e[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/a,e},s.transformMat3=function(e,t,r){var n=t[0],i=t[1],o=t[2];return e[0]=n*r[0]+i*r[3]+o*r[6],e[1]=n*r[1]+i*r[4]+o*r[7],e[2]=n*r[2]+i*r[5]+o*r[8],e},s.transformQuat=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*o-l*i,d=u*i+l*n-a*o,h=u*o+a*i-s*n,f=-a*n-s*i-l*o;return e[0]=c*u+f*-a+d*-l-h*-s,e[1]=d*u+f*-s+h*-a-c*-l,e[2]=h*u+f*-l+c*-s-d*-a,e},s.rotateX=function(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e},s.rotateY=function(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e},s.rotateZ=function(e,t,r,n){var i=[],o=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],e[0]=o[0]+r[0],e[1]=o[1]+r[1],e[2]=o[2]+r[2],e},s.forEach=function(){var e=s.create();return function(t,r,n,i,o,a){var s,l;for(r||(r=3),n||(n=0),l=i?Math.min(i*r+n,t.length):t.length,s=n;l>s;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}(),s.angle=function(e,t){var r=s.fromValues(e[0],e[1],e[2]),n=s.fromValues(t[0],t[1],t[2]);s.normalize(r,r),s.normalize(n,n);var i=s.dot(r,n);return i>1?0:Math.acos(i)},s.str=function(e){return"vec3("+e[0]+", "+e[1]+", "+e[2]+")"},"undefined"!=typeof e&&(e.vec3=s);var l={};l.create=function(){var e=new r(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e},l.clone=function(e){var t=new r(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},l.fromValues=function(e,t,n,i){var o=new r(4);return o[0]=e,o[1]=t,o[2]=n,o[3]=i,o},l.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},l.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e},l.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e},l.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e},l.sub=l.subtract,l.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e},l.mul=l.multiply,l.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e},l.div=l.divide,l.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e},l.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e},l.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e},l.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e},l.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+o*o)},l.dist=l.distance,l.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],o=t[3]-e[3];return r*r+n*n+i*i+o*o},l.sqrDist=l.squaredDistance,l.length=function(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)},l.len=l.length,l.squaredLength=function(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i},l.sqrLen=l.squaredLength,l.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e},l.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e},l.normalize=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r*r+n*n+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e[3]=t[3]*a),e},l.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},l.lerp=function(e,t,r,n){var i=t[0],o=t[1],a=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=o+n*(r[1]-o),e[2]=a+n*(r[2]-a),e[3]=s+n*(r[3]-s),e},l.random=function(e,t){return t=t||1,e[0]=n(),e[1]=n(),e[2]=n(),e[3]=n(),l.normalize(e,e),l.scale(e,e,t),e},l.transformMat4=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*a,e[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*a,e[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*a,e[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*a,e},l.transformQuat=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=r[0],s=r[1],l=r[2],u=r[3],c=u*n+s*o-l*i,d=u*i+l*n-a*o,h=u*o+a*i-s*n,f=-a*n-s*i-l*o;return e[0]=c*u+f*-a+d*-l-h*-s,e[1]=d*u+f*-s+h*-a-c*-l,e[2]=h*u+f*-l+c*-s-d*-a,e},l.forEach=function(){var e=l.create();return function(t,r,n,i,o,a){var s,l;for(r||(r=4),n||(n=0),l=i?Math.min(i*r+n,t.length):t.length,s=n;l>s;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],o(e,e,a),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}(),l.str=function(e){return"vec4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"},"undefined"!=typeof e&&(e.vec4=l);var u={};return u.create=function(){var e=new r(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},u.clone=function(e){var t=new r(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},u.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},u.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},u.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],o=t[6],a=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=o,e[11]=t[14],e[12]=i,e[13]=a,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e},u.invert=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],h=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15],_=r*s-n*a,x=r*l-i*a,y=r*u-o*a,w=n*l-i*s,b=n*u-o*s,E=i*u-o*l,T=c*m-d*p,M=c*g-h*p,R=c*v-f*p,S=d*g-h*m,A=d*v-f*m,P=h*v-f*g,C=_*P-x*A+y*S+w*R-b*M+E*T;return C?(C=1/C,e[0]=(s*P-l*A+u*S)*C,e[1]=(i*A-n*P-o*S)*C,e[2]=(m*E-g*b+v*w)*C,e[3]=(h*b-d*E-f*w)*C,e[4]=(l*R-a*P-u*M)*C,e[5]=(r*P-i*R+o*M)*C,e[6]=(g*y-p*E-v*x)*C,e[7]=(c*E-h*y+f*x)*C,e[8]=(a*A-s*R+u*T)*C,e[9]=(n*R-r*A-o*T)*C,e[10]=(p*b-m*y+v*_)*C,e[11]=(d*y-c*b-f*_)*C,e[12]=(s*M-a*S-l*T)*C,e[13]=(r*S-n*M+i*T)*C,e[14]=(m*x-p*w-g*_)*C,e[15]=(c*w-d*x+h*_)*C,e):null},u.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],s=t[5],l=t[6],u=t[7],c=t[8],d=t[9],h=t[10],f=t[11],p=t[12],m=t[13],g=t[14],v=t[15];return e[0]=s*(h*v-f*g)-d*(l*v-u*g)+m*(l*f-u*h),e[1]=-(n*(h*v-f*g)-d*(i*v-o*g)+m*(i*f-o*h)),e[2]=n*(l*v-u*g)-s*(i*v-o*g)+m*(i*u-o*l),e[3]=-(n*(l*f-u*h)-s*(i*f-o*h)+d*(i*u-o*l)),e[4]=-(a*(h*v-f*g)-c*(l*v-u*g)+p*(l*f-u*h)),e[5]=r*(h*v-f*g)-c*(i*v-o*g)+p*(i*f-o*h),e[6]=-(r*(l*v-u*g)-a*(i*v-o*g)+p*(i*u-o*l)),e[7]=r*(l*f-u*h)-a*(i*f-o*h)+c*(i*u-o*l),e[8]=a*(d*v-f*m)-c*(s*v-u*m)+p*(s*f-u*d),e[9]=-(r*(d*v-f*m)-c*(n*v-o*m)+p*(n*f-o*d)),e[10]=r*(s*v-u*m)-a*(n*v-o*m)+p*(n*u-o*s),e[11]=-(r*(s*f-u*d)-a*(n*f-o*d)+c*(n*u-o*s)),e[12]=-(a*(d*g-h*m)-c*(s*g-l*m)+p*(s*h-l*d)),e[13]=r*(d*g-h*m)-c*(n*g-i*m)+p*(n*h-i*d),e[14]=-(r*(s*g-l*m)-a*(n*g-i*m)+p*(n*l-i*s)),e[15]=r*(s*h-l*d)-a*(n*h-i*d)+c*(n*l-i*s),e},u.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],o=e[4],a=e[5],s=e[6],l=e[7],u=e[8],c=e[9],d=e[10],h=e[11],f=e[12],p=e[13],m=e[14],g=e[15],v=t*a-r*o,_=t*s-n*o,x=t*l-i*o,y=r*s-n*a,w=r*l-i*a,b=n*l-i*s,E=u*p-c*f,T=u*m-d*f,M=u*g-h*f,R=c*m-d*p,S=c*g-h*p,A=d*g-h*m;return v*A-_*S+x*R+y*M-w*T+b*E},u.multiply=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],h=t[9],f=t[10],p=t[11],m=t[12],g=t[13],v=t[14],_=t[15],x=r[0],y=r[1],w=r[2],b=r[3];return e[0]=x*n+y*s+w*d+b*m,e[1]=x*i+y*l+w*h+b*g,e[2]=x*o+y*u+w*f+b*v,e[3]=x*a+y*c+w*p+b*_,x=r[4],y=r[5],w=r[6],b=r[7],e[4]=x*n+y*s+w*d+b*m,e[5]=x*i+y*l+w*h+b*g,e[6]=x*o+y*u+w*f+b*v,e[7]=x*a+y*c+w*p+b*_,x=r[8],y=r[9],w=r[10],b=r[11],e[8]=x*n+y*s+w*d+b*m,e[9]=x*i+y*l+w*h+b*g,e[10]=x*o+y*u+w*f+b*v,e[11]=x*a+y*c+w*p+b*_,x=r[12],y=r[13],w=r[14],b=r[15],e[12]=x*n+y*s+w*d+b*m,e[13]=x*i+y*l+w*h+b*g,e[14]=x*o+y*u+w*f+b*v,e[15]=x*a+y*c+w*p+b*_,e},u.mul=u.multiply,u.translate=function(e,t,r){var n,i,o,a,s,l,u,c,d,h,f,p,m=r[0],g=r[1],v=r[2];return t===e?(e[12]=t[0]*m+t[4]*g+t[8]*v+t[12],e[13]=t[1]*m+t[5]*g+t[9]*v+t[13],e[14]=t[2]*m+t[6]*g+t[10]*v+t[14],e[15]=t[3]*m+t[7]*g+t[11]*v+t[15]):(n=t[0],i=t[1],o=t[2],a=t[3],s=t[4],l=t[5],u=t[6],c=t[7],d=t[8],h=t[9],f=t[10],p=t[11],e[0]=n,e[1]=i,e[2]=o,e[3]=a,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=d,e[9]=h,e[10]=f,e[11]=p,e[12]=n*m+s*g+d*v+t[12],e[13]=i*m+l*g+h*v+t[13],e[14]=o*m+u*g+f*v+t[14],e[15]=a*m+c*g+p*v+t[15]),e},u.scale=function(e,t,r){var n=r[0],i=r[1],o=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*o,e[9]=t[9]*o,e[10]=t[10]*o,e[11]=t[11]*o,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},u.rotate=function(e,r,n,i){var o,a,s,l,u,c,d,h,f,p,m,g,v,_,x,y,w,b,E,T,M,R,S,A,P=i[0],C=i[1],z=i[2],I=Math.sqrt(P*P+C*C+z*z);return Math.abs(I)<t?null:(I=1/I,P*=I,C*=I,z*=I,o=Math.sin(n),a=Math.cos(n),s=1-a,l=r[0],u=r[1],c=r[2],d=r[3],h=r[4],f=r[5],p=r[6],m=r[7],g=r[8],v=r[9],_=r[10],x=r[11],y=P*P*s+a,w=C*P*s+z*o,b=z*P*s-C*o,E=P*C*s-z*o,T=C*C*s+a,M=z*C*s+P*o,R=P*z*s+C*o,S=C*z*s-P*o,A=z*z*s+a,e[0]=l*y+h*w+g*b,e[1]=u*y+f*w+v*b,e[2]=c*y+p*w+_*b,e[3]=d*y+m*w+x*b,e[4]=l*E+h*T+g*M,e[5]=u*E+f*T+v*M,e[6]=c*E+p*T+_*M,e[7]=d*E+m*T+x*M,e[8]=l*R+h*S+g*A,e[9]=u*R+f*S+v*A,e[10]=c*R+p*S+_*A,e[11]=d*R+m*S+x*A,r!==e&&(e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15]),e)},u.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[4],a=t[5],s=t[6],l=t[7],u=t[8],c=t[9],d=t[10],h=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=o*i+u*n,e[5]=a*i+c*n,e[6]=s*i+d*n,e[7]=l*i+h*n,e[8]=u*i-o*n,e[9]=c*i-a*n,e[10]=d*i-s*n,e[11]=h*i-l*n,e},u.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],u=t[8],c=t[9],d=t[10],h=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i-u*n,e[1]=a*i-c*n,e[2]=s*i-d*n,e[3]=l*i-h*n,e[8]=o*n+u*i,e[9]=a*n+c*i,e[10]=s*n+d*i,e[11]=l*n+h*i,e},u.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),o=t[0],a=t[1],s=t[2],l=t[3],u=t[4],c=t[5],d=t[6],h=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=o*i+u*n,e[1]=a*i+c*n,e[2]=s*i+d*n,e[3]=l*i+h*n,e[4]=u*i-o*n,e[5]=c*i-a*n,e[6]=d*i-s*n,e[7]=h*i-l*n,e},u.fromRotationTranslation=function(e,t,r){var n=t[0],i=t[1],o=t[2],a=t[3],s=n+n,l=i+i,u=o+o,c=n*s,d=n*l,h=n*u,f=i*l,p=i*u,m=o*u,g=a*s,v=a*l,_=a*u;return e[0]=1-(f+m),e[1]=d+_,e[2]=h-v,e[3]=0,e[4]=d-_,e[5]=1-(c+m),e[6]=p+g,e[7]=0,e[8]=h+v,e[9]=p-g,e[10]=1-(c+f),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e},u.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],o=t[3],a=r+r,s=n+n,l=i+i,u=r*a,c=n*a,d=n*s,h=i*a,f=i*s,p=i*l,m=o*a,g=o*s,v=o*l;return e[0]=1-d-p,e[1]=c+v,e[2]=h-g,e[3]=0,e[4]=c-v,e[5]=1-u-p,e[6]=f+m,e[7]=0,e[8]=h+g,e[9]=f-m,e[10]=1-u-d,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},u.frustum=function(e,t,r,n,i,o,a){var s=1/(r-t),l=1/(i-n),u=1/(o-a);return e[0]=2*o*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=2*o*l,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*l,e[10]=(a+o)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=a*o*2*u,e[15]=0,e},u.perspective=function(e,t,r,n,i){var o=1/Math.tan(t/2),a=1/(n-i);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*a,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*a,e[15]=0,e},u.ortho=function(e,t,r,n,i,o,a){var s=1/(t-r),l=1/(n-i),u=1/(o-a);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=(a+o)*u,e[15]=1,e},u.lookAt=function(e,r,n,i){var o,a,s,l,c,d,h,f,p,m,g=r[0],v=r[1],_=r[2],x=i[0],y=i[1],w=i[2],b=n[0],E=n[1],T=n[2];return Math.abs(g-b)<t&&Math.abs(v-E)<t&&Math.abs(_-T)<t?u.identity(e):(h=g-b,f=v-E,p=_-T,m=1/Math.sqrt(h*h+f*f+p*p),h*=m,f*=m,p*=m,o=y*p-w*f,a=w*h-x*p,s=x*f-y*h,m=Math.sqrt(o*o+a*a+s*s),m?(m=1/m,o*=m,a*=m,s*=m):(o=0,a=0,s=0),l=f*s-p*a,c=p*o-h*s,d=h*a-f*o,m=Math.sqrt(l*l+c*c+d*d),m?(m=1/m,l*=m,c*=m,d*=m):(l=0,c=0,d=0),e[0]=o,e[1]=l,e[2]=h,e[3]=0,e[4]=a,e[5]=c,e[6]=f,e[7]=0,e[8]=s,e[9]=d,e[10]=p,e[11]=0,e[12]=-(o*g+a*v+s*_),e[13]=-(l*g+c*v+d*_),e[14]=-(h*g+f*v+p*_),e[15]=1,e)},u.str=function(e){return"mat4("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+")"},u.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))},u.equals=function(e,t){return e[0]==t[0]&&e[1]==t[1]&&e[2]==t[2]&&e[3]==t[3]&&e[4]==t[4]&&e[5]==t[5]&&e[6]==t[6]&&e[7]==t[7]&&e[8]==t[8]&&e[9]==t[9]&&e[10]==t[10]&&e[11]==t[11]&&e[12]==t[12]&&e[13]==t[13]&&e[14]==t[14]&&e[15]==t[15]},"undefined"!=typeof e&&(e.mat4=u),e}();for(k in r)console.log("initializing "+k+" module"),t.module(k,r[k])}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize glutils module");var e=function(e){window.console&&(window.console.error?window.console.error(e):window.console.log&&window.console.log(e))},t=function(t,r,n,i){var o=i||e,a=t.createShader(n);t.shaderSource(a,r),t.compileShader(a);var s=t.getShaderParameter(a,t.COMPILE_STATUS);return s?a:(lastError=t.getShaderInfoLog(a),o("*** Error compiling shader '"+a+"':"+lastError),t.deleteShader(a),null)};return{loadProgram:function(t,r,n,i){for(var o={},a=t.createProgram(),s=0;s<r.length;++s)t.attachShader(a,r[s]);t.linkProgram(a);var l=t.getProgramParameter(a,t.LINK_STATUS);if(!l)return lastError=t.getProgramInfoLog(a),e("Error in program linking:"+lastError),t.deleteProgram(a),null;if(n)for(var s=0;s<n.length;++s){var u=n[s]+"_handle";o[u]=t.getAttribLocation(a,n[s])}if(i)for(var s=0;s<i.length;++s){var u=i[s]+"_handle";o[u]=t.getUniformLocation(a,i[s])}return o.program=a,o},createShader:function(e,r,n,i){var o,a=r.text;if(!n)if("x-shader/x-vertex"==r.type)o=e.VERTEX_SHADER;else if("x-shader/x-fragment"==r.type)o=e.FRAGMENT_SHADER;else if(o!=e.VERTEX_SHADER&&o!=e.FRAGMENT_SHADER)throw"*** Error: unknown shader type";return t(e,a,n?n:o,i)}}}();t.module("glutils",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){return console.log("initialize sys module"),{timestamp:function(){return Date.now()},ismobile:{Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},FireFox:function(){return navigator.userAgent.match(/Firefox/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)},any:function(){return r.ismobile.Android()||r.ismobile.BlackBerry()||r.ismobile.iOS()||r.ismobile.Opera()||r.ismobile.Windows()}}}}();t.module("sys",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize fps module");var e=t.getModule("sys"),r=0,n=0;return{updateFps:function(){if(100==r){r=0;var t=e.timestamp(),i=1e5/(t-n);console.log("FPS : "+i),n=t}r+=1}}}();t.module("fps",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize animator module");var e=t.getModule("sys"),n={time:!0,ease:!0,start:!0,init:!0,onComplete:!0,onUpdate:!0};return{new:function(){var i={animations:[],animate:function(t,i){null==i.ease&&(i.ease=r.linear),null==i.start&&(i.start=0);var o=[],a=[],s=[],l=[];for(var u in i){var c=i[u];null==n[u]&&(i.init&&null!=i.init[u]?(o.push(u),a.push(i.init[u]),s.push(i.init[u]),l.push(c)):null==t[u]?console.log("ERROR: Animated property cannot be initially nil : "+u):(o.push(u),a.push(t[u]),s.push(t[u]),l.push(c)))}this.animations.push({keys:o,target:t,start:e.timestamp()+i.start,deadline:e.timestamp()+i.start+i.time,config:i,init:a,final:l,current:s})},step:function(){var e=[],r=Date.now();this.animations.length>0&&(t.renderRequired=!0);for(var n=null,i=0;i<this.animations.length;i++){n=i;var o=this.animations[n],a=(o.deadline,0);1==o.paused&&(r=o.pausetimestamp),r<o.deadline?a=1-(o.deadline-r)/o.config.time:r<o.start?a=0:(a=1,e.push(n)),a=Math.max(a,1e-5);for(var s=0;s<o.keys.length;s++){var l=o.keys[s],u=o.init[s],c=o.final[s];o.current[s]=o.config.ease(u,c,a),o.target[l]=o.current[s]}o.config.onUpdate&&o.config.onUpdate(o)}for(s=e.length-1;s>=0;s--){var d=this.animations[e[s]].config.onComplete;this.animations.splice(e[s],1),null!=d&&d()}},pause:function(){for(var t in this.animations)this.animations[t].paused=!0,this.animations[t].pausetimestamp=e.timestamp()},resume:function(){for(var t in this.animations)this.animations[t].paused=!1,this.animations[t].deadline=this.animations[t].deadline+(e.timestamp()-this.animations[t].pausetimestamp)},stop:function(){for(var e in this.animations)this.animations[e].keys=[],this.animations[e].init=[],this.animations[e].final=[],this.animations[e].config.onComplete=null;this.animations=[]}};return i}}}();r.linear=function(e,t,r){return e+(t-e)*r},r.inQuad=function(e,t,r){return e+(t-e)*r*r},r.outQuad=function(e,t,r){return e+-(t-e)*r*(r-2)},r.inOutQuad=function(e,t,r){return.5>r?(r=2*r,e+(t-e)/2*r*r):(r=2*(r-.5),e-(t-e)/2*(r*(r-2)-1))},r.inCubic=function(e,t,r){return e+(t-e)*r*r*r},r.outCubic=function(e,t,r){return r-=1,e+(t-e)*(r*r*r+1)},r.inOutCubic=function(e,t,r){return.5>r?(r=2*r,e+(t-e)/2*r*r*r):(r=2*(r-.5)-1,e+(t-e)/2*(r*r*r+2))},r.inQuart=function(e,t,r){return e+(t-e)*r*r*r*r},r.outQuart=function(e,t,r){return r-=1,e-(t-e)*(r*r*r*r-1)},r.inOutQuart=function(e,t,r){return.5>r?(r=2*r,e+(t-e)/2*r*r*r*r):(r=2*(r-.5)-1,e-(t-e)/2*(r*r*r*r-2))},r.inSine=function(e,t,r){return e+(t-e)*(1-Math.cos(r*Math.PI/2))},r.outSine=function(e,t,r){return e+(t-e)*Math.sin(r*Math.PI/2)},r.inOutSine=function(e,t,r){return e-(t-e)/2*(Math.cos(Math.PI*r)-1)},r.inExpo=function(e,t,r){return r-=1,e+(t-e)*Math.pow(2,10*r)},r.outExpo=function(e,t,r){return e+(t-e)*(1-Math.pow(2,-10*r))},r.inOutExpo=function(e,t,r){return.5>r?(r=2*r-1,e+(t-e)/2*Math.pow(2,10*r)):(r=2*(r-.5),e+(t-e)/2*(2-Math.pow(2,-10*r)))},r.inCirc=function(e,t,r){return e+(t-e)*(1-Math.sqrt(1-r*r))},r.outCirc=function(e,t,r){return r-=1,e+(t-e)*Math.sqrt(1-r*r)},r.inOutCirc=function(e,t,r){return.5>r?(r=2*r,e+(t-e)/2*(1-Math.sqrt(1-r*r))):(r=2*(r-.5)-1,e+(t-e)/2*(1+Math.sqrt(1-r*r)))},r.inElastic=function(e,t,r){return r-=1,e-(t-e)*Math.pow(2,10*r)*Math.sin(6*(r-.0777777)*Math.PI)},r.outElastic=function(e,t,r){return e+(t-e)*(Math.pow(2,-10*r)*Math.sin(6*(r-.0777777)*Math.PI)+1)},t.module("animator",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize scene module");var e=t.getModule("animator"),r=t.getModule("sys"),n=[],i=[],o=[],a=e.new(),s=null,l=0,u=0,c=function(e,t,r,n){n>100&&(n=100);var i=1;e>t&&(i=-1);var o=-i*n/(16.66*r)*Math.abs(e-t);return Math.abs(o)<1e-4?e=t:e-=o,1==i&&e>t&&(e=t),-1==i&&t>e&&(e=t),e},d=function(e,t,r,n,i){var o=t[r]-e[r];if(Math.abs(o)>n){var a=o/Math.abs(o);t[r]=c(t[r],e[r]+360*a,t.inertia,i),-1==a&&t[r]<-180&&(t[r]=t[r]+360),1==a&&t[r]>180&&(t[r]=t[r]-360)}else t[r]=c(t[r],e[r],t.inertia,i)};return{render:function(e,s,c,h){var f=t.localVars.gl,p=r.timestamp()-l;if(l=r.timestamp(),u-=p,d(t.localVars.sensors.orientation,t.localVars.sensors.damped_orientation,"alpha",180,p),d(t.localVars.sensors.orientation,t.localVars.sensors.damped_orientation,"beta",180,p),d(t.localVars.sensors.orientation,t.localVars.sensors.damped_orientation,"gamma",180,p),a.step(),n=[],a.animations.length>0){var m=i[i.length-2];m.stepTree(),n.push(m)}var g=i[i.length-1];if(null!=g&&(g.stepTree(),n.push(g)),t.renderRequired||u>0){var v=c/h,_=f.drawingBufferWidth/f.drawingBufferHeight,x=_>v?1:c/f.drawingBufferWidth,y=_>v?h/f.drawingBufferHeight:1;f.viewport(0,0,f.drawingBufferWidth,f.drawingBufferHeight),f.clearColor(0,0,0,0),f.clear(f.COLOR_BUFFER_BIT|f.DEPTH_BUFFER_BIT);for(var w=0;w<n.length;w++)n[w].scale.x=x,n[w].scale.y=y,n[w].drawTree();t.renderRequired&&(u=500)}for(var w=0;w<o.length;w++)!new function(){var e=o[w];e.renderFbo()};o=[],t.renderRequired=!1},openScene:function(e,t,r){var n=i[i.length-1];i.push(e),null!=t&&a.animate(e,t),null!=n&&null!=r&&a.animate(n,r)},closeScene:function(e,t){var r=i[i.length-1],n=i[i.length-2];if(null!=e){var o=e.onComplete,s=function(){null!=o&&o(),i.splice(i.length-1,1),console.log("remove scene from stack",r.identifier,i.length)};e.onComplete=s,a.animate(r,e)}else i.splice(i.length-1,1);null!=n&&null!=t&&a.animate(n,t)},replaceScene:function(e,t,r){var n=i[i.length-1];if(i.push(e),null!=t){var o=t.onComplete,s=function(){null!=o&&o(),i.splice(i.length-2,1),console.log("remove scene from stack",n.identifier,i.length)};t.onComplete=s,a.animate(e,t)}else i.splice(i.length-2,1);null!=n&&null!=r&&a.animate(n,r)},removeAllScenes:function(){i=[],o=[],a.stop(),s=null},isAnimating:function(){return a.animations.length>0?!0:!1},getPointerUser:function(){return s?s:i[i.length-1]},getpointerStealer:function(){return s},stealPointers:function(e){console.log("stealPointers",e);var t=s?s:i[i.length-1];s=e,t.resetpress()},resetPointerStealer:function(){s=null},addFboUpdate:function(e){o.push(e)},layoutChanged:function(){for(var e=0;e<i.length;e++)i[e].layoutChangedTree()}}}();t.module("scene",r)}(),function(){var curScript=document.currentScript||document._currentScript,curlify=curScript.curlify,object=function(){function array_move(e,t,r){if(r>=e.length)for(var n=r-e.length;n--+1;)e.push(void 0);return e.splice(r,0,e.splice(t,1)[0]),e}console.log("initialize object module");var scene=curlify.getModule("scene"),animator=curlify.getModule("animator"),sys=curlify.getModule("sys"),mat4=curlify.getModule("mat4"),vec3=curlify.getModule("vec3");return{new:function(ident,width,height){return eval(curlify.extract(curlify.localVars,"curlify.localVars")),{identifier:null==ident?"object identifier":ident,position:{x:0,y:0,z:0},rotate:{x:0,y:0,z:0},scale:{x:1,y:1,z:1},origo:{x:0,y:0,z:0},size:{width:null==width?screenWidth:width,height:null==height?screenHeight:height},children:[],active:!0,visible:!0,disabled:!1,alpha:1,blend:!0,drawbackside:!1,depthtest:!1,disableGlStateUpdates:!1,projectionMatrix:camera.projectionMatrix,viewMatrix:camera.viewMatrix,modelMatrix:mat4.create(),modelViewMatrix:mat4.create(),origoMatrix:mat4.create(),translateScale:camera.translateScale,preUpdateModelMatrix:mat4.create(),anim:animator.new(),timervalue:0,laststep:0,add:function(e){return e.parent=this,this.children.push(e),e},updateModelMatrix:function(){if(mat4.identity(this.modelMatrix),0!=this.position.x||0!=this.position.y||0!=this.position.z){var e=screenWidth/(2*this.translateScale);mat4.translate(this.modelMatrix,this.modelMatrix,vec3.clone([this.position.x/e,-this.position.y/e,this.position.z/e]))}if(0!=this.rotate.z&&mat4.rotateZ(this.modelMatrix,this.modelMatrix,-this.rotate.z),0!=this.rotate.y&&mat4.rotateY(this.modelMatrix,this.modelMatrix,-this.rotate.y),0!=this.rotate.x&&mat4.rotateX(this.modelMatrix,this.modelMatrix,-this.rotate.x),(1!=this.scale.x||1!=this.scale.y||1!=this.scale.z)&&mat4.scale(this.modelMatrix,this.modelMatrix,vec3.clone([this.scale.x,this.scale.y,this.scale.z])),0!=this.origo.x||0!=this.origo.y||0!=this.origo.z){var e=screenWidth/(2*this.translateScale);mat4.translate(this.modelMatrix,this.modelMatrix,vec3.clone([-this.origo.x/e,this.origo.y/e,-this.origo.z/e]))}},update:function(){if(mat4.copy(this.preUpdateModelMatrix,this.modelMatrix),null!=this.parent&&null!=this.parent.modelViewMatrix&&(this.viewMatrix=this.parent.modelViewMatrix),0!=this.origo.x||0!=this.origo.y||0!=this.origo.z){var e=screenWidth/(2*this.translateScale);mat4.identity(this.origoMatrix),mat4.translate(this.origoMatrix,this.origoMatrix,vec3.clone([this.origo.x/e,-this.origo.y/e,this.origo.z/e])),mat4.multiply(this.viewMatrix,this.viewMatrix,this.origoMatrix)}this.updateModelMatrix(),this.children.length>0&&(mat4.copy(this.modelViewMatrix,this.viewMatrix),mat4.multiply(this.modelViewMatrix,this.modelViewMatrix,this.modelMatrix)),curlify.renderRequired||mat4.equals(this.modelMatrix,this.preUpdateModelMatrix)||(curlify.renderRequired=!0)},updateGlStates:function(){this.depthtest?(gl.enable(gl.DEPTH_TEST),gl.depthFunc(gl.LEQUAL)):gl.disable(gl.DEPTH_TEST),0==this.blend?gl.disable(gl.BLEND):(gl.enable(gl.BLEND),gl.blendFunc(gl.SRC_ALPHA,gl.ONE_MINUS_SRC_ALPHA)),1==this.drawbackside?gl.disable(gl.CULL_FACE):(gl.enable(gl.CULL_FACE),gl.cullFace(gl.FRONT))},stepTree:function(){if(1!=this.disabled){if(this.anim.step(),null!=this.preStep&&this.preStep(),null!=this.step){var e=Math.max(1,Math.min(sys.timestamp()-this.laststep,60));this.laststep=sys.timestamp(),this.step(e)}this.update();for(var t=0;t<this.children.length;t++)this.children[t].stepTree();null!=this.postStep&&this.postStep()}},drawTree:function(){if(0!=this.visible){if(1!=this.disableGlStateUpdates&&this.updateGlStates(),null!=this.preDraw&&this.preDraw(),null!=this.draw&&this.draw(),this.reverseDrawOrder)for(var e=this.children.length-1;e>=0;e--)this.children[e].drawTree();else for(var e=0;e<this.children.length;e++)this.children[e].drawTree();null!=this.postDraw&&this.postDraw()}},layoutChangedTree:function(){null!=this.layoutChanged&&this.layoutChanged();for(var e=0;e<this.children.length;e++)this.children[e].layoutChangedTree()},press:function(e,t){for(var r=!1,n=this.children.length-1;n>=0;n--)this.children[n].active&&(r=this.children[n].press(e,t));if(null!=this.relativePress){var i=e-screenWidth/2-this.absolutex(),o=t-screenHeight/2-this.absolutey();r=this.relativePress(i,o)}return null!=this.absolutePress&&(r=this.absolutePress(e,t)),r},drag:function(e,t){for(var r=!1,n=this.children.length-1;n>=0;n--)this.children[n].active&&(r=this.children[n].drag(e,t));if(null!=this.relativeDrag){var i=e-screenWidth/2-this.absolutex(),o=t-screenHeight/2-this.absolutey();r=this.relativeDrag(i,o)}return null!=this.absoluteDrag&&(r=this.absoluteDrag(e,t)),r},release:function(e,t){for(var r=!1,n=this.children.length-1;n>=0;n--)this.children[n].active&&(r=this.children[n].release(e,t));
if(null!=this.relativeRelease){var i=e-screenWidth/2-this.absolutex(),o=t-screenHeight/2-this.absolutey();r=this.relativeRelease(i,o)}return null!=this.absoluteRelease&&(r=this.absoluteRelease(e,t)),r},swipe:function(e){for(var t=!1,r=this.children.length-1;r>=0;r--)this.children[r].active&&(t=this.children[r].swipe(e));var n=Math.abs(e.x),i=Math.abs(e.y);return n>i?e.x>0?this.swipeLeft?this.swipeLeft(n):!1:this.swipeRight?this.swipeRight(n):!1:e.y>0?this.swipeUp?this.swipeUp(i):!1:this.swipeDown?this.swipeDown(i):!1},resetpress:function(){if(1==this.active){for(var e=this.children.length-1;e>=0;e--)this.children[e].resetpress();this!=scene.getpointerStealer()&&null!=this.pointerReset&&this.pointerReset()}},hoverTree:function(e,t){for(var r=[],n=this.children.length-1;n>=0;n--){var i=[];if(this.children[n].active&&(i=this.children[n].hoverTree(e,t)),i.length>0)for(var o=0;o<i.length;o++)r.push(i[o])}if(null!=this.hit){var a=e-screenWidth/2-this.absolutex(),s=t-screenHeight/2-this.absolutey();this.hit(a,s)&&r.push(this)}return r},x:function(){return this.position.x},y:function(){return this.position.y},width:function(){return this.size.width*this.scale.x},height:function(){return this.size.height*this.scale.y},top:function(){return this.position.y-this.height()/2},bottom:function(){return this.position.y+this.height()/2},left:function(){return this.position.x-this.width()/2},right:function(){return this.position.x+this.width()/2},absolutex:function(){var e=0;return null!=this.parent&&(e=this.parent.absolutex()),e+this.x()},absolutey:function(){var e=0;return null!=this.parent&&(e=this.parent.absolutey()),e+this.y()},absolutescalex:function(){var e=1;return null!=this.parent&&(e=this.parent.absolutescalex()),e*this.scale.x},absolutescaley:function(){var e=1;return null!=this.parent&&(e=this.parent.absolutescaley()),e*this.scale.y},absolutealpha:function(){var e=1;return null!=this.parent&&(e=this.parent.absolutealpha()),e*this.alpha},activate:function(){this.active=!0,null!=this.postActivate&&this.postActivate()},deactivate:function(){this.active=!1,null!=this.postDeactivate&&this.postDeactivate()},removeTree:function(){for(var e=0;e<this.children.length;e++)this.children[e].removeTree();this.children=[],this.destroy&&this.destroy()},removeSelf:function(){if(this.removeTree(),null!=this.parent)for(var e=0;e<this.parent.children.length;e++)if(this.parent.children[e]==this){this.parent.children.splice(e,1);break}},bringToFront:function(){if(null!=this.parent)for(var e=0;e<this.parent.children.length;e++)if(this==this.parent.children[e]){array_move(this.parent.children,e,this.parent.children.length-1);break}},sendToBack:function(){if(null!=this.parent)for(var e=0;e<this.parent.children.length;e++)if(this==this.parent.children[e]){array_move(this.parent.children,e,0);break}}}}}}();curlify.module("object",object)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize quad module");var e=t.getModule("glutils"),n=t.getModule("object"),i=t.getModule("mat4"),o=t.getModule("vec3");return{buffer:null,default_program:{glProgram:null,getProgram:function(){return null==this.glProgram&&this.loadProgram(),this.glProgram},loadProgram:function(){var r={text:"              attribute vec2 a_position;              attribute vec2 a_tex_coordinate;                            uniform mat4 u_projection;              uniform mat4 u_view;              uniform mat4 u_model;                            varying vec2 v_tex_coord;                            void main() {                gl_Position = u_projection*u_view*u_model*vec4(a_position, 0.0, 1.0);                v_tex_coord = a_tex_coordinate;              }            ",type:"x-shader/x-vertex"},n={text:"              precision mediump float;                            varying vec2      v_tex_coord;                            uniform sampler2D u_texture;              uniform float     u_alpha;                            void main() {                vec4 color = texture2D(u_texture, v_tex_coord);                gl_FragColor = vec4(color.rgb, color.a * u_alpha);              }            ",type:"x-shader/x-fragment"},i=t.localVars.gl,o=e.createShader(i,r),a=e.createShader(i,n);this.glProgram=e.loadProgram(i,[o,a],["a_position","a_tex_coordinate"],["u_texture","u_alpha","u_model","u_view","u_projection"])}},new:function(e,a,s){var l=t.localVars.gl,u=t.localVars.screenWidth;if(null==this.buffer){this.buffer=l.createBuffer(),this.buffer.itemSize=2,this.buffer.numItems=4,l.bindBuffer(l.ARRAY_BUFFER,this.buffer);var c=[-1,-1,0,0,1,-1,1,0,-1,1,0,1,1,1,1,1];l.bufferData(l.ARRAY_BUFFER,new Float32Array(c),l.STATIC_DRAW)}var d=n.new(e,a,s);return d.glProgram=this.default_program.getProgram(),d.quadModelMatrix=i.create(),d.updateModelMatrix=function(){if(i.identity(this.modelMatrix),0!=this.position.x||0!=this.position.y||0!=this.position.z){var e=u/(2*this.translateScale);i.translate(this.modelMatrix,this.modelMatrix,[this.position.x/e,-this.position.y/e,this.position.z/e])}if(0!=this.rotate.z&&i.rotateZ(this.modelMatrix,this.modelMatrix,-this.rotate.z),0!=this.rotate.y&&i.rotateY(this.modelMatrix,this.modelMatrix,-this.rotate.y),0!=this.rotate.x&&i.rotateX(this.modelMatrix,this.modelMatrix,-this.rotate.x),(1!=this.scale.x||1!=this.scale.y||1!=this.scale.z)&&i.scale(this.modelMatrix,this.modelMatrix,[this.scale.x,this.scale.y,this.scale.z]),0!=this.origo.x||0!=this.origo.y||0!=this.origo.z){var e=u/(2*this.translateScale);i.translate(this.modelMatrix,this.modelMatrix,o.clone([-this.origo.x/e,this.origo.y/e,-this.origo.z/e]))}i.copy(this.quadModelMatrix,this.modelMatrix);var t=u/this.translateScale;i.scale(this.quadModelMatrix,this.quadModelMatrix,[this.size.width/t,-this.size.height/t,1])},d.draw=function(){if(null!=this.texture){l.useProgram(this.glProgram.program),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,this.texture),l.uniform1i(this.glProgram.u_texture_handle,0),l.uniform1f(this.glProgram.u_alpha_handle,this.absolutealpha()),l.uniformMatrix4fv(this.glProgram.u_projection_handle,!1,this.projectionMatrix),l.uniformMatrix4fv(this.glProgram.u_view_handle,!1,this.viewMatrix),l.uniformMatrix4fv(this.glProgram.u_model_handle,!1,this.quadModelMatrix);var e=this.buffer?this.buffer:r.buffer;l.bindBuffer(l.ARRAY_BUFFER,e),l.enableVertexAttribArray(this.glProgram.a_position_handle),l.enableVertexAttribArray(this.glProgram.a_tex_coordinate_handle),l.vertexAttribPointer(this.glProgram.a_position_handle,e.itemSize,l.FLOAT,!1,16,0),l.vertexAttribPointer(this.glProgram.a_tex_coordinate_handle,e.itemSize,l.FLOAT,!1,16,8),l.drawArrays(l.TRIANGLE_STRIP,0,e.numItems)}},d}}}();t.module("quad",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=t.getModule("object"),n=t.getModule("quad"),i=function(){return console.log("initialize plane module"),{new:function(e,i,o,a,s){for(var l=t.localVars.gl,u=t.localVars.screenWidth,c=(t.localVars.screenHeight,r.new(e,a,s)),d=i+1,h=o+1,f=c.size.height/c.size.width,p=[],m=0;h>m;m++)for(var g=(-1+2*m/o)*f,v=m/o,_=0;d>_;_++){var x=-1+2*_/i,y=_/i;p.push(x,g,y,v)}c.buffer=l.createBuffer(),c.buffer.itemSize=2,c.buffer.numItems=4,l.bindBuffer(l.ARRAY_BUFFER,c.buffer),l.bufferData(l.ARRAY_BUFFER,new Float32Array(p),l.STATIC_DRAW);for(var w=[],b=0,E=0;o>E;E++)for(var T=0;i>T;T++)w.push(E*d+T),w.push(E*d+T+1),w.push((E+1)*d+T),w.push(E*d+T+1),w.push((E+1)*d+T+1),w.push((E+1)*d+T),b+=6;return c.indices=l.createBuffer(),c.indices.indexCount=w.length,l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,c.indices),l.bufferData(l.ELEMENT_ARRAY_BUFFER,new Uint16Array(w),l.STATIC_DRAW),c.glProgram=n.default_program.getProgram(),c.quadModelMatrix=mat4.create(),c.updateModelMatrix=function(){if(mat4.identity(this.modelMatrix),0!=this.position.x||0!=this.position.y||0!=this.position.z){var e=u/(2*this.translateScale);mat4.translate(this.modelMatrix,this.modelMatrix,[this.position.x/e,-this.position.y/e,this.position.z/e])}if(0!=this.rotate.z&&mat4.rotateZ(this.modelMatrix,this.modelMatrix,-this.rotate.z),0!=this.rotate.y&&mat4.rotateY(this.modelMatrix,this.modelMatrix,-this.rotate.y),0!=this.rotate.x&&mat4.rotateX(this.modelMatrix,this.modelMatrix,-this.rotate.x),(1!=this.scale.x||1!=this.scale.y||1!=this.scale.z)&&mat4.scale(this.modelMatrix,this.modelMatrix,[this.scale.x,this.scale.y,this.scale.z]),0!=this.origo.x||0!=this.origo.y||0!=this.origo.z){var e=u/(2*this.translateScale);mat4.translate(this.modelMatrix,this.modelMatrix,vec3.clone([-this.origo.x/e,this.origo.y/e,-this.origo.z/e]))}mat4.copy(this.quadModelMatrix,this.modelMatrix);var t=u/this.translateScale;mat4.scale(this.quadModelMatrix,this.quadModelMatrix,[this.size.width/t,-this.size.height/t*1/f,1])},c.draw=function(){null!=c.texture&&(l.useProgram(this.glProgram.program),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.texture),l.uniform1i(this.glProgram.u_texture_handle,0),l.uniform1f(this.glProgram.u_alpha_handle,this.absolutealpha()),l.uniformMatrix4fv(this.glProgram.u_projection_handle,!1,this.projectionMatrix),l.uniformMatrix4fv(this.glProgram.u_view_handle,!1,this.viewMatrix),l.uniformMatrix4fv(this.glProgram.u_model_handle,!1,this.quadModelMatrix),l.bindBuffer(l.ARRAY_BUFFER,this.buffer),l.enableVertexAttribArray(this.glProgram.a_position_handle),l.enableVertexAttribArray(this.glProgram.a_tex_coordinate_handle),l.vertexAttribPointer(this.glProgram.a_position_handle,this.buffer.itemSize,l.FLOAT,!1,16,0),l.vertexAttribPointer(this.glProgram.a_tex_coordinate_handle,this.buffer.itemSize,l.FLOAT,!1,16,8),l.bindBuffer(l.ELEMENT_ARRAY_BUFFER,this.indices),l.drawElements(l.TRIANGLES,this.indices.indexCount,l.UNSIGNED_SHORT,0))},c}}}();t.module("plane",i)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){var e=t.getModule("quad");return{new:function(t,r,n){var i=e.new(t,r,n);return i.focused=!1,i.hovered=!1,i.hit=function(e,t){return e<-this.width()/2||e>this.width()/2||t<-this.height()/2||t>this.height()/2?!1:!0},i.relativePress=function(e,t){return this.hit(e,t)?(null!=this.focus&&this.focus(e,t),this.focused=!0,!0):!1},i.relativeDrag=function(e,t){return 1!=this.focused?!1:(1!=this.hit(e,t)?(null!=this.defocus&&this.defocus(e,t),this.focused=!1):null!=this.focusdrag&&this.focusdrag(e,t),!0)},i.relativeRelease=function(e,t){return 1!=this.focused?!1:(null!=this.defocus&&this.defocus(e,t),this.focused=!1,!0)},i.hover=function(e,t){var r=!1;return this.hit(e,t)?(0==this.hovered&&null!=this.hover_focus&&this.hover_focus(e,t),this.hovered=!0,r=!0):(this.hovered&&null!=this.hover_defocus&&(this.hover_defocus(e,t),r=!0),this.hovered=!1),r},i.resethover=function(){this.hovered&&null!=this.hover_defocus&&this.hover_defocus(),this.hovered=!1},i.pointerReset=function(){null!=this.defocus&&this.defocus(0,0),this.focused=!1},i}}}();t.module("focusable",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize rectangle module");{var e=t.getModule("glutils"),r=t.getModule("quad");t.getModule("mat4")}return{default_program:{glProgram:null,getProgram:function(){return null==this.glProgram&&this.loadProgram(),this.glProgram},loadProgram:function(){var r={text:"              attribute vec2 a_position;                            uniform mat4 u_projection;              uniform mat4 u_view;              uniform mat4 u_model;                            void main() {                gl_Position = u_projection*u_view*u_model*vec4(a_position, 0.0, 1.0);              }",type:"x-shader/x-vertex"},n={text:"              precision mediump float;                            uniform float     u_red;              uniform float     u_green;              uniform float     u_blue;              uniform float     u_alpha;                            void main() {                gl_FragColor = vec4( u_red, u_green, u_blue, 1.0 ) * u_alpha;              }",type:"x-shader/x-fragment"},i=t.localVars.gl,o=e.createShader(i,r),a=e.createShader(i,n);this.glProgram=e.loadProgram(i,[o,a],["a_position"],["u_red","u_green","u_blue","u_alpha","u_model","u_view","u_projection"])}},new:function(e,n,i){var o=t.localVars.gl,a=r.new("rectangle",e,n);return a.glProgram=this.default_program.getProgram(),a.color=null==i?{red:0,green:0,blue:0}:i,a.draw=function(){o.useProgram(this.glProgram.program),o.uniform1f(this.glProgram.u_red_handle,this.color.red),o.uniform1f(this.glProgram.u_green_handle,this.color.green),o.uniform1f(this.glProgram.u_blue_handle,this.color.blue),o.uniform1f(this.glProgram.u_alpha_handle,this.absolutealpha()),o.uniformMatrix4fv(this.glProgram.u_projection_handle,!1,this.projectionMatrix),o.uniformMatrix4fv(this.glProgram.u_view_handle,!1,this.viewMatrix),o.uniformMatrix4fv(this.glProgram.u_model_handle,!1,this.quadModelMatrix);var e=this.buffer?this.buffer:r.buffer;o.bindBuffer(o.ARRAY_BUFFER,e),o.enableVertexAttribArray(this.glProgram.a_position_handle),o.vertexAttribPointer(this.glProgram.a_position_handle,e.itemSize,o.FLOAT,!1,16,0),o.drawArrays(o.TRIANGLE_STRIP,0,e.numItems)},a}}}();t.module("rectangle",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize image module");var e=t.getModule("quad");return{loadImage:function(e){var r=t.localVars.zipfile,n=null;if("string"!=typeof e)return console.log("ERROR: image.loadImage source is not of type string",e),null;if(n=new Image,null!=r){var i=r.file(e),o="data:image/jpg";".svg"==e.slice(-4)&&(o="data:image/svg+xml"),n.src=o+";base64,"+JSZip.base64.encode(i.asBinary())}else n.crossOrigin="anonymous",n.src=e;return n},new:function(n,i){var o=t.localVars.gl,a=i?i:e.new("image : "+n);return a.promise=new Promise(function(e,t){a.resolve=e,a.reject=t}),a.size.width=null,a.size.height=null,n instanceof HTMLElement?(a.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,a.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,n),null==a.size.width&&(a.size.width=n.width),null==a.size.height&&(a.size.height=n.height),a.loaded=!0,null!=a.onload&&a.onload(),a.resolve(a)):n instanceof Object?null!=n.texture||null!=n.size?(a.texture=n.texture,a.image=n.image,null!=n.loadlistener&&n.loadlistener(a),null==a.size.width&&(a.size.width=n.size.width),null==a.size.height&&(a.size.height=n.size.height),a.loaded=!0,null!=a.onload&&a.onload(),a.resolve(a)):(console.log("ERROR: image.new from unknown Object",n),a.reject(Error("image.new from unknown Object "+n))):"string"==typeof n?(a.image=r.loadImage(n),a.image.onload=function(){return null==r?(console.log("image == null!"),void a.reject(Error("image == null!"))):(a.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,a.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,a.image),null==a.size.width&&(a.size.width=a.image.width),null==a.size.height&&(a.size.height=a.image.height),a.loaded=!0,null!=a.onload&&a.onload(),t.renderRequired=!0,void a.resolve(a))},a.image.onerror=function(){console.log("texture load failed",n),a.reject(Error("image.onerror "+n))}):(console.log("ERROR: image.new from unknown object",n),a.reject(Error("image.new from unknown object "+n))),a}}}();t.module("image",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=t.getModule("glutils"),n=t.getModule("image"),i=t.getModule("quad"),o=function(){return console.log("initialize masked_image module"),{default_program:{program:null,getProgram:function(){return null==this.glProgram&&this.loadProgram(),this.glProgram},loadProgram:function(){var e={text:"            attribute vec2 a_position;             attribute vec2 a_tex_coordinate;                         uniform mat4 u_projection;             uniform mat4 u_view;             uniform mat4 u_model;                         varying vec2 v_tex_coord;                         void main() {               gl_Position = u_projection*u_view*u_model*vec4(a_position, 0.0, 1.0);               v_tex_coord = a_tex_coordinate;             }             ",type:"x-shader/x-vertex"},n={text:"            precision mediump float;                         varying vec2      v_tex_coord;                         uniform sampler2D u_texture;             uniform sampler2D u_mask_texture;             uniform float     u_alpha;                         void main() {                             vec4 color = texture2D(u_texture, v_tex_coord);               vec4 mask_color = texture2D(u_mask_texture, v_tex_coord);                             gl_FragColor = color * mask_color.a * u_alpha;             }             ",type:"x-shader/x-fragment"},i=t.localVars.gl,o=r.createShader(i,e),a=r.createShader(i,n);this.glProgram=r.loadProgram(i,[o,a],["a_position","a_tex_coordinate"],["u_texture","u_mask_texture","u_alpha","u_model","u_view","u_projection"])}},new:function(e,r){var o=t.localVars.gl,a=n.new(e);return a.identifier="masked_image : "+e+" : "+r,console.log(a.identifier),a.mask=r,a.glProgram=this.default_program.getProgram(),a.draw=function(){if(1==a.loaded){o.useProgram(this.glProgram.program),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,a.texture),o.uniform1i(this.glProgram.u_texture_handle,0),o.activeTexture(o.TEXTURE1),o.bindTexture(o.TEXTURE_2D,a.mask.texture),o.uniform1i(this.glProgram.u_mask_texture_handle,1),o.uniform1f(this.glProgram.u_alpha_handle,this.absolutealpha()),o.uniformMatrix4fv(this.glProgram.u_projection_handle,!1,this.projectionMatrix),o.uniformMatrix4fv(this.glProgram.u_view_handle,!1,this.viewMatrix),o.uniformMatrix4fv(this.glProgram.u_model_handle,!1,this.quadModelMatrix);var e=this.buffer?this.buffer:i.buffer;o.bindBuffer(o.ARRAY_BUFFER,e),o.enableVertexAttribArray(this.glProgram.a_position_handle),o.enableVertexAttribArray(this.glProgram.a_tex_coordinate_handle),o.vertexAttribPointer(this.glProgram.a_position_handle,e.itemSize,o.FLOAT,!1,16,0),o.vertexAttribPointer(this.glProgram.a_tex_coordinate_handle,e.itemSize,o.FLOAT,!1,16,8),o.drawArrays(o.TRIANGLE_STRIP,0,e.numItems)}},a}}}();t.module("masked_image",o)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize fbo_object module");{var e=t.getModule("glutils"),r=t.getModule("scene"),n=t.getModule("quad"),i=t.getModule("sys"),o=t.getModule("object");t.getModule("mat4")}return{default_program:{glProgram:null,getProgram:function(){return null==this.glProgram&&this.loadProgram(),this.glProgram},loadProgram:function(){var r={text:"              attribute vec2 a_position;              attribute vec2 a_tex_coordinate;                            uniform mat4 u_projection;              uniform mat4 u_view;              uniform mat4 u_model;                            varying vec2 v_tex_coord;                            void main() {                gl_Position = u_projection*u_view*u_model*vec4(a_position, 0.0, 1.0);                v_tex_coord = vec2(a_tex_coordinate.x,1.0-a_tex_coordinate.y);              }              ",type:"x-shader/x-vertex"},n={text:"              precision mediump float;                            varying vec2      v_tex_coord;                            uniform sampler2D u_texture;              uniform float     u_alpha;                            void main() {                vec4 color = texture2D(u_texture, v_tex_coord);                gl_FragColor = vec4(color.rgb, color.a * u_alpha);              }            ",type:"x-shader/x-fragment"},i=t.localVars.gl,o=e.createShader(i,r),a=e.createShader(i,n);this.glProgram=e.loadProgram(i,[o,a],["a_position","a_tex_coordinate"],["u_texture","u_alpha","u_model","u_view","u_projection"])}},new:function(e,a,s,l,u){var c=t.localVars.gl,d=n.new("fbo_object : "+e,a,s);d.glProgram=this.default_program.getProgram(),console.log("fbo_object.new(",d.identifier,d.size.width,d.size.height,d.glProgram,")"),d.parentobject=o.new(),d.parentobject.add(o.new()),d.parentobject.scale.x=t.localVars.screenWidth/d.size.width,d.parentobject.scale.y=t.localVars.screenHeight/d.size.height,d.parentobject.update(),d.dobypassFbo=!1,d.lastUpdated=-99999,d.updateInterval=0,d.framebuffer=c.createFramebuffer(),d.framebuffer.width=d.size.width,d.framebuffer.height=d.size.height,c.bindFramebuffer(c.FRAMEBUFFER,d.framebuffer),d.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,d.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR);var h=l?c.RGB:c.RGBA;if(c.texImage2D(c.TEXTURE_2D,0,h,d.framebuffer.width,d.framebuffer.height,0,h,c.UNSIGNED_BYTE,null),c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,d.texture,0),u){var f=c.createRenderbuffer();c.bindRenderbuffer(c.RENDERBUFFER,f),c.renderbufferStorage(c.RENDERBUFFER,c.DEPTH_COMPONENT16,d.framebuffer.width,d.framebuffer.height),c.framebufferRenderbuffer(c.FRAMEBUFFER,c.DEPTH_ATTACHMENT,c.RENDERBUFFER,f)}return c.bindTexture(c.TEXTURE_2D,null),c.bindFramebuffer(c.FRAMEBUFFER,null),d.preStep=function(){var e=i.timestamp()-this.lastUpdated;this.fboUpdatesDisabled||this.dobypassFbo||e>=this.updateInterval&&d.updateFbo()},d.updateFbo=function(){r.addFboUpdate(d)},d.prepareFbo=function(){c.bindTexture(c.TEXTURE_2D,null),c.viewport(0,0,d.size.width,d.size.height),c.bindFramebuffer(c.FRAMEBUFFER,d.framebuffer),c.clearColor(0,0,0,0),c.clear(c.COLOR_BUFFER_BIT|c.DEPTH_BUFFER_BIT)},d.renderFbo=function(){var e=c.getParameter(c.FRAMEBUFFER_BINDING);d.prepareFbo();var r=t.localVars.screenWidth,n=t.localVars.screenHeight,o=t.localVars.viewWidth,a=t.localVars.viewHeight,s=t.localVars.layoutWidth,l=t.localVars.layoutHeight,u={x:t.localVars.layoutOffset.x,y:t.localVars.layoutOffset.y};t.localVars.screenWidth=d.size.width,t.localVars.screenHeight=d.size.height,t.localVars.viewWidth=d.size.width,t.localVars.viewHeight=d.size.height,t.localVars.layoutWidth=d.size.width,t.localVars.layoutHeight=d.size.height,t.localVars.layoutOffset={x:0,y:0},screenWidth=t.localVars.screenWidth,screenHeight=t.localVars.screenHeight,viewWidth=t.localVars.viewWidth,viewHeight=t.localVars.viewHeight,layoutWidth=t.localVars.layoutWidth,layoutHeight=t.localVars.layoutHeight,layoutOffset=t.localVars.layoutOffset;for(var h=0;h<d.children.length;h++)d.children[h].parent=d.parentobject,d.children[h].viewMatrix=d.parentobject.modelViewMatrix,d.children[h].drawTree();t.localVars.screenWidth=r,t.localVars.screenHeight=n,t.localVars.viewWidth=o,t.localVars.viewHeight=a,t.localVars.layoutWidth=s,t.localVars.layoutHeight=l,t.localVars.layoutOffset=u,screenWidth=t.localVars.screenWidth,screenHeight=t.localVars.screenHeight,viewWidth=t.localVars.viewWidth,viewHeight=t.localVars.viewHeight,layoutWidth=t.localVars.layoutWidth,layoutHeight=t.localVars.layoutHeight,layoutOffset=t.localVars.layoutOffset,c.viewport(t.localVars.layoutOffset.x,t.localVars.layoutOffset.y,t.localVars.layoutWidth,t.localVars.layoutHeight),c.bindFramebuffer(c.FRAMEBUFFER,e),d.lastUpdated=i.timestamp()},d.drawTree=function(){if(0!=this.visible){if(1!=this.disableGlStateUpdates&&this.updateGlStates(),null!=this.preDraw&&this.preDraw(),this.dobypassFbo)for(var e=0;e<this.children.length;e++)this.children[e].parent=this,this.children[e].viewMatrix=this.modelViewMatrix,this.children[e].drawTree();else null!=this.draw&&this.draw();null!=this.postDraw&&this.postDraw()}},d}}}();t.module("fbo_object",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=t.getModule("glutils"),n=(t.getModule("image"),t.getModule("quad")),i=t.getModule("fbo_object"),o=function(){return console.log("initialize masked_fbo_object module"),{default_program:{program:null,getProgram:function(){return null==this.glProgram&&this.loadProgram(),this.glProgram},loadProgram:function(){var e={text:"            attribute vec2 a_position;             attribute vec2 a_tex_coordinate;                         uniform mat4 u_projection;             uniform mat4 u_view;             uniform mat4 u_model;                         varying vec2 v_tex_coord;                         void main() {               gl_Position = u_projection*u_view*u_model*vec4(a_position, 0.0, 1.0);               v_tex_coord = vec2(a_tex_coordinate.x,1.0-a_tex_coordinate.y);            }             ",type:"x-shader/x-vertex"},n={text:"            precision mediump float;                         varying vec2      v_tex_coord;                         uniform sampler2D u_texture;             uniform sampler2D u_mask_texture;             uniform float     u_alpha;                         void main() {                             vec4 color = texture2D(u_texture, v_tex_coord);               vec4 mask_color = texture2D(u_mask_texture, v_tex_coord);                             gl_FragColor = vec4(color.rgb, color.a * mask_color.a * u_alpha);             }             ",type:"x-shader/x-fragment"},i=t.localVars.gl,o=r.createShader(i,e),a=r.createShader(i,n);this.glProgram=r.loadProgram(i,[o,a],["a_position","a_tex_coordinate"],["u_texture","u_mask_texture","u_alpha","u_model","u_view","u_projection"])}},new:function(e,r,o,a,s){var l=t.localVars.gl,u=i.new(e,o,a,s);return u.identifier="masked_fbo_object : "+e+" : "+r,console.log(u.identifier),u.mask=r,u.glProgram=this.default_program.getProgram(),u.draw=function(){if(null!=r.texture){l.useProgram(this.glProgram.program),l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,u.texture),l.uniform1i(this.glProgram.u_texture_handle,0),l.activeTexture(l.TEXTURE1),l.bindTexture(l.TEXTURE_2D,u.mask.texture),l.uniform1i(this.glProgram.u_mask_texture_handle,1),l.uniform1f(this.glProgram.u_alpha_handle,this.absolutealpha()),l.uniformMatrix4fv(this.glProgram.u_projection_handle,!1,this.projectionMatrix),l.uniformMatrix4fv(this.glProgram.u_view_handle,!1,this.viewMatrix),l.uniformMatrix4fv(this.glProgram.u_model_handle,!1,this.quadModelMatrix);var e=this.buffer?this.buffer:n.buffer;l.bindBuffer(l.ARRAY_BUFFER,e),l.enableVertexAttribArray(this.glProgram.a_position_handle),l.enableVertexAttribArray(this.glProgram.a_tex_coordinate_handle),l.vertexAttribPointer(this.glProgram.a_position_handle,e.itemSize,l.FLOAT,!1,16,0),l.vertexAttribPointer(this.glProgram.a_tex_coordinate_handle,e.itemSize,l.FLOAT,!1,16,8),l.drawArrays(l.TRIANGLE_STRIP,0,e.numItems)}},u}}}();t.module("masked_fbo_object",o)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize button module");{var e=t.getModule("image");t.getModule("focusable")}return{new:function(t){var r=e.new(t);return r.focused=!1,r.hovered=!1,r.identifier="button : "+t,r.hit=function(e,t){return e<-this.width()/2||e>this.width()/2||t<-this.height()/2||t>this.height()/2?!1:!0},r.relativePress=function(e,t){return this.hit(e,t)?(null!=this.focus&&this.focus(e,t),this.focused=!0,!0):!1},r.relativeDrag=function(e,t){return 1!=this.focused?!1:(1!=this.hit(e,t)?(null!=this.defocus&&this.defocus(e,t),this.focused=!1):null!=this.focusdrag&&this.focusdrag(e,t),!0)},r.relativeRelease=function(e,t){return 1!=this.focused?!1:(null!=this.defocus&&this.defocus(e,t),this.focused=!1,!0)},r.hover=function(e,t){var r=!1;return this.hit(e,t)?(0==this.hovered&&null!=this.hover_focus&&this.hover_focus(e,t),this.hovered=!0,r=!0):(this.hovered&&null!=this.hover_defocus&&(this.hover_defocus(e,t),r=!0),this.hovered=!1),r},r.resethover=function(){this.hovered&&null!=this.hover_defocus&&this.hover_defocus(),this.hovered=!1},r.pointerReset=function(){null!=this.defocus&&this.defocus(0,0),this.focused=!1},r}}}();t.module("button",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=t.getModule("object"),n=t.getModule("focusable"),i=t.getModule("image"),o=function(e,t,r,o,a){r=r?r:e.frames.length,o=o?o:0;for(var s=a?a:n.new("spritesheet "+e.name),l=o;o+r>l;l++){var u=s.add(i.new(e.frames[l]));u.visible=!1,u.active=!1}return s.size.width=e.spritewidth,s.size.height=e.spriteheight,s.frame=s.children[0],s.frametimervalue=0,s.frametime=35,s.restart=function(e){s.frametimervalue=0;var r=s.restart;0==t&&(r=null);var n=s.loopdelay&&!e?s.loopdelay:0;s.anim.animate(s,{frametimervalue:s.children.length,start:n,time:s.frametime*s.children.length,onComplete:r})},s.preStep=function(){s.frame.visible=!1;var e=Math.floor(s.frametimervalue);e>s.children.length-1||(s.frame=s.children[e],s.frame.visible=!0)},s.start=function(){return s.anim.animations.length>0&&s.anim.animations[0].paused?void s.anim.resume():void s.restart()},s.stop=function(){s.anim.pause()},s.unload=function(){s.anim.stop()},0!=t&&s.restart(!0),s},a=function(){return{newSheet:function(e,r,n){var o={spritewidth:0,spriteheight:0,frames:[]};if(e instanceof Array){var a=r,s=n,l=document.createElement("canvas");l.width=a,l.height=s;for(var u=l.getContext("2d"),c=0,d=0;d<e.length;d++)!new function(){var t=i.loadImage(e[d]);t.onload=function(){u.drawImage(t,0,0),o.frames.push(i.new(l)),u.clearRect(0,0,l.width,l.height),c+=1,c==e.length&&null!=o.onload&&o.onload()}};o.spritewidth=a,o.spriteheight=s,o.name="array "+e.length,t.renderRequired=!0}else{var h=i.loadImage(e);h.onload=function(){var t=h.width/r,a=h.height/n,s=document.createElement("canvas");s.width=t,s.height=a;for(var l=s.getContext("2d"),u=0;n>u;u++)for(var c=0;r>c;c++)l.drawImage(h,-c*t,-u*a),o.frames.push(i.new(s)),l.clearRect(0,0,s.width,s.height);o.spritewidth=t,o.spriteheight=a,o.name=e,null!=o.onload&&o.onload()}}return o},newFromSheet:function(e,t,r,n,i){return o(e,t,r,n,i)},new:function(e,t,n,i,a,s){var l=this.newSheet(e,t,n),u=r.new("sprite loader");return u.sheet=l,u.promise=new Promise(function(e,t){u.resolve=e,u.reject=t}),l.onload=function(){o(l,i,a,s,u),null!=u.onload&&u.onload(),u.resolve(u)},u}}}();t.module("sprite",a)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize carousel module");{var e=t.getModule("object"),r=t.getModule("focusable"),n=t.getModule("animator"),i=t.getModule("scene");t.getModule("sys")}return{new:function(o,a,s){var l=t.localVars.screenWidth,u=t.localVars.screenHeight,c=r.new(o,a,s),d={name:"coverflow",show:[],hide:[],order_draw:!0};d.show.push({target:"position.x",startposition:1*l,endposition:0,func:n.linear}),d.show.push({target:"rotate.y",startposition:.8*Math.PI,endposition:0,func:n.linear}),d.show.push({target:"scale.x",startposition:.6,endposition:1,func:n.linear}),d.show.push({target:"scale.y",startposition:.6,endposition:1,func:n.linear}),d.hide.push({target:"position.x",startposition:0,endposition:1*-l,func:n.linear}),d.hide.push({target:"rotate.y",startposition:0,endposition:.8*-Math.PI,func:n.linear}),d.hide.push({target:"scale.x",startposition:1,endposition:.6,func:n.linear}),d.hide.push({target:"scale.y",startposition:1,endposition:.6,func:n.linear}),c.contentsize={width:c.size.width,height:c.size.height},c.inertia=5,c.swipespeed=1,c.swipefunc=n.outQuad,c.movespeed=1,c.movethreshold=60,c.itemsize=l,c.transition=d,c.unload_distance=1,c.wrap=!1,c.bounceOnWrap=!1,c.alwaysmove=!1,c.nevermove=!1,c.selecteditem=0,c.moveToSelectedItem=!0;var h=c.add(e.new("carousel"));h.targetposition={x:0,y:0,z:0},h.pressOffset={x:0,y:0};var f=c.add(e.new("item container"));f.targetposition={x:0,y:0,z:0},c.instance=h,c.itemcontainer=f;var p=function(e,t,r){r>100&&(r=100);var n=1;e>t&&(n=-1);var i=-n*r/(16.66*c.inertia)*Math.abs(e-t);return Math.abs(i)<1e-4?e=t:e-=i,1==n&&e>t&&(e=t),-1==n&&t>e&&(e=t),e};h.setMoving=function(e,t){null==i.getpointerStealer()&&1!=c.nevermove&&(i.stealPointers(c),null!=c.stolePointers&&c.stolePointers(e,t),h.moving=!0)
},c.focus=function(e,t){h.moving&&(h.moving=!1,h.targetposition.x=h.position.x,h.targetposition.y=h.position.y),h.pressOffset={x:h.targetposition.x-e*c.movespeed/l*2,y:h.targetposition.y-t*c.movespeed},c.pressStarted={x:e,y:t}},c.focusdrag=function(e,t){var r=h.pressOffset.x+e*c.movespeed/l*2,n=h.pressOffset.y+t*c.movespeed/u*2,i=c.pressStarted.x-e,o=c.pressStarted.y-t;(c.alwaysmove||c.contentsize.width!=c.size.width)&&Math.abs(i)>c.movethreshold&&h.setMoving(i,o),h.moving&&(h.targetposition.x=r,h.targetposition.y=n)},c.defocus=function(){var e=Math.floor(-h.targetposition.x+.5);c.moveToSelectedItem&&(h.targetposition.x=-e),c.selecteditem=e,c.selecteditem<0&&(c.selecteditem=c.wrap?f.children.length+e:0),c.selecteditem>f.children.length-1&&(c.selecteditem=c.wrap?e-f.children.length:f.children.length-1),c.selecteditem=c.selecteditem+1,null!=c.carouselmoved&&c.carouselmoved(c.selecteditem)};var m=function(e,t){var r=e.active,n=e.visible,i=e.itemposition;e.itemposition=i+t,e.stepTree(),e.drawTree(),e.itemposition=i,e.step(0),e.visible=n,e.active=r};return c.preDraw=function(){if(c.wrap)if(c.transition.reverse_draw)for(var e=f.children.length-1;e>=0;e--)m(f.children[e],f.children.length);else for(var e=0;e<f.children.length;e++)m(f.children[e],f.children.length)},c.postDraw=function(){if(c.wrap)if(c.transition.reverse_draw)for(var e=f.children.length-1;e>=0;e--)m(f.children[e],-f.children.length);else for(var e=0;e<f.children.length;e++)m(f.children[e],-f.children.length)},c.selected=function(){return c.selecteditem},c.getItem=function(e){return f.children[e-1]},c.moveto=function(e,t){h.targetposition.x=-e,t&&(h.position.x=h.targetposition.x),c.selecteditem=e,c.selecteditem<0&&(c.selecteditem=c.wrap?f.children.length+e:0),c.selecteditem>f.children.length-1&&(c.selecteditem=c.wrap?e-f.children.length:f.children.length-1),null!=c.carouselmoved&&c.carouselmoved(e+1)},c.swipeRight=function(e){c.focused&&(h.targetposition.x=h.targetposition.x-c.swipefunc(0,c.swipespeed,e))},c.swipeLeft=function(e){c.focused&&(h.targetposition.x=h.targetposition.x+c.swipefunc(0,c.swipespeed,e))},c.step=function(e){var t=-f.children.length+1,r=-f.children.length+1,n=.75,i=.75;0==c.wrap||c.bounceOnWrap&&h.position.x>t-n&&h.position.x<n?(c.bounceOnWrap&&(n=2*n,i=2*i),h.targetposition.x>n&&(h.targetposition.x=n),h.targetposition.y>i&&(h.targetposition.y=i),h.targetposition.x<t-n&&(h.targetposition.x=t-n),h.targetposition.y<r-i&&(h.targetposition.y=r-i),0==c.focused&&(h.targetposition.x>0&&(h.targetposition.x=p(h.targetposition.x,0,e/2)),h.targetposition.y>0&&(h.targetposition.y=p(h.targetposition.y,0,e/2)),h.targetposition.x<t&&(h.targetposition.x=p(h.targetposition.x,t,e/2)),h.targetposition.y<r&&(h.targetposition.y=p(h.targetposition.y,r,e/2)))):(h.targetposition.x>=1?(h.targetposition.x=h.targetposition.x-f.children.length,h.position.x=h.position.x-f.children.length,h.pressOffset.x=h.pressOffset.x-f.children.length):h.targetposition.x<=-f.children.length&&(h.targetposition.x=h.targetposition.x+f.children.length,h.position.x=h.position.x+f.children.length,h.pressOffset.x=h.pressOffset.x+f.children.length),h.targetposition.y>=1?(h.targetposition.y=h.targetposition.y-f.children.length,h.position.y=h.position.y-f.children.length,h.pressOffset.y=h.pressOffset.y-f.children.length):h.targetposition.y<=-f.children.length&&(h.targetposition.y=h.targetposition.y+f.children.length,h.position.y=h.position.y+f.children.length,h.pressOffset.y=h.pressOffset.y+f.children.length));var o=e;o>100&&(o=1),0==c.focused&&(o=e/2),(c.alwaysmove||c.contentsize.width!=c.size.width)&&(h.position.x=p(h.position.x,h.targetposition.x,o)),(c.alwaysmove||c.contentsize.height!=c.size.height)&&(h.position.y=p(h.position.y,h.targetposition.y,o)),0==c.focused&&h.position.x==h.targetposition.x&&h.position.y==h.targetposition.y&&(h.moving=!1),h.moving},c.getDistance=function(){var e=(h.position.x*c.itemsize+this.itemposition*c.itemsize)/l;return e},c.setContentSize=function(){c.contentsize.width=c.itemsize*f.children.length},c.add=function(e,t){var t=f.children.length,n=r.new("carousel item container");return n.add(e),n.parent=f,f.children.push(n),f.drawTree=function(){function e(e,t){return Math.abs(e.dist)>Math.abs(t.dist)?-1:1}if(0!=this.visible){if(this.update(),null!=this.preDraw&&this.preDraw(),null!=this.draw&&this.draw(),c.transition.order_draw){for(var t=[],r=0;r<this.children.length;r++)t.push(this.children[r]);t.sort(e);for(var r=0;r<t.length;r++)t[r].drawTree()}else if(this.reverseDrawOrder)for(var r=this.children.length-1;r>=0;r--)this.children[r].drawTree();else for(var r=0;r<this.children.length;r++)this.children[r].drawTree();null!=this.postDraw&&this.postDraw()}},e.carouselobject=n,n.index=t,n.child=e,n.itemposition=t,n.getDistance=c.getDistance,n.step=function(){var e=this.getDistance();if(this.dist=e,e<=-c.unload_distance||e>=c.unload_distance?null!=this.unload_content&&null!=this.content&&this.unload_content():null!=this.load_content&&null==this.content&&this.load_content(),this.active=!0,Math.abs(e)>.2&&(this.active=!1),this.visible=!0,Math.abs(e)>1&&(this.visible=!1),!(this.distance==e||Math.abs(e)>2)){this.distance=e;var t=c.transition;if(f.reverseDrawOrder=t.reverse_draw?!0:!1,e>=0)for(var r=0;r<t.show.length;r++){var n=t.show[r];"position.x"==n.target?this.position.x=n.func(n.startposition,n.endposition,Math.abs(1-e)):"position.y"==n.target?this.position.y=n.func(n.startposition,n.endposition,Math.abs(1-e)):"position.z"==n.target?this.position.z=n.func(n.startposition,n.endposition,Math.abs(1-e)):"scale.x"==n.target?this.scale.x=n.func(n.startposition,n.endposition,Math.abs(1-e)):"scale.y"==n.target?this.scale.y=n.func(n.startposition,n.endposition,Math.abs(1-e)):"rotate.x"==n.target?this.rotate.x=n.func(n.startposition,n.endposition,Math.abs(1-e)):"rotate.y"==n.target?this.rotate.y=n.func(n.startposition,n.endposition,Math.abs(1-e)):"rotate.z"==n.target?this.rotate.z=n.func(n.startposition,n.endposition,Math.abs(1-e)):"alpha"==n.target?this.alpha=n.func(n.startposition,n.endposition,Math.abs(1-e)):"transition_value"==n.target&&(this.transition_value=n.func(n.startposition,n.endposition,Math.abs(1-e)))}else for(var r=0;r<t.hide.length;r++){var i=t.hide[r];"position.x"==i.target?this.position.x=i.func(i.startposition,i.endposition,Math.abs(e)):"position.y"==i.target?this.position.y=i.func(i.startposition,i.endposition,Math.abs(e)):"position.z"==i.target?this.position.z=i.func(i.startposition,i.endposition,Math.abs(e)):"scale.x"==i.target?this.scale.x=i.func(i.startposition,i.endposition,Math.abs(e)):"scale.y"==i.target?this.scale.y=i.func(i.startposition,i.endposition,Math.abs(e)):"rotate.x"==i.target?this.rotate.x=i.func(i.startposition,i.endposition,Math.abs(e)):"rotate.y"==i.target?this.rotate.y=i.func(i.startposition,i.endposition,Math.abs(e)):"rotate.z"==i.target?this.rotate.z=i.func(i.startposition,i.endposition,Math.abs(e)):"alpha"==i.target?this.alpha=i.func(i.startposition,i.endposition,Math.abs(e)):"transition_value"==i.target&&(this.transition_value=i.func(i.startposition,i.endposition,Math.abs(e)))}}},f.itemaddposition=f.itemaddposition+1,c.setContentSize(),n},c}}}();t.module("carousel",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=t.getModule("animator"),n=t.getModule("carousel"),i=function(){return{new:function(e,i,o){var a=t.localVars.screenWidth,s=t.localVars.screenHeight,l={name:"move in",show:[],hide:[]};l.show.push({target:"position.y",startposition:s,endposition:0,func:r.outQuad}),l.show.push({target:"alpha",startposition:0,endposition:1,func:r.outExpo}),l.hide.push({target:"position.y",startposition:0,endposition:0,func:r.linear}),l.hide.push({target:"alpha",startposition:1,endposition:0,func:r.inExpo});var u=n.new(e,i,o);return u.itemsize=s,u.transition=l,u.getDistance=function(){var e=(u.instance.position.y*u.itemsize+this.itemposition*u.itemsize)/s;return e},u.setContentSize=function(){u.contentsize.height=u.itemsize*u.itemcontainer.children.length},u.focus=function(e,t){u.instance.moving&&(u.instance.moving=!1,u.instance.targetposition.x=u.instance.position.x,u.instance.targetposition.y=u.instance.position.y),u.instance.pressOffset={x:u.instance.targetposition.x-e*u.movespeed/a*2,y:u.instance.targetposition.y-t*u.movespeed/s*2},u.pressStarted={x:e,y:t}},u.focusdrag=function(e,t){var r=u.instance.pressOffset.x+e*u.movespeed/a*2,n=u.instance.pressOffset.y+t*u.movespeed/s*2,i=u.pressStarted.x-e,o=u.pressStarted.y-t;(u.alwaysmove||u.contentsize.height!=u.size.height)&&Math.abs(o)>u.movethreshold&&u.instance.setMoving(i,o),u.instance.moving&&(u.instance.targetposition.x=r,u.instance.targetposition.y=n)},u.defocus=function(){var e=Math.floor(-u.instance.targetposition.y+.5);u.moveToSelectedItem&&(u.instance.targetposition.y=-e),u.selecteditem=e,u.selecteditem<0&&(u.selecteditem=u.wrap?u.itemcontainer.children.length+e:0),u.selecteditem>u.itemcontainer.children.length-1&&(u.selecteditem=u.wrap?e-u.itemcontainer.children.length:u.itemcontainer.children.length-1),u.selecteditem=u.selecteditem+1,null!=u.carouselmoved&&u.carouselmoved(u.selecteditem)},u.swipeLeft=null,u.swipeDown=null,u.swipeDown=function(e){u.focused&&(u.instance.targetposition.x=u.instance.targetposition.x-u.swipefunc(0,u.swipespeed,e))},u.swipeUp=function(e){u.focused&&(u.instance.targetposition.x=u.instance.targetposition.x+u.swipefunc(0,u.swipespeed,e))},u.moveto=function(e,t){u.instance.targetposition.y=-e,t&&(u.instance.position.y=u.instance.targetposition.y),u.selecteditem=e,null!=u.carouselmoved&&u.carouselmoved(e)},u}}}();t.module("carousel_vertical",i)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=t.getModule("scene"),n=t.getModule("animator"),i=t.getModule("object"),o=t.getModule("focusable"),a=function(){return{new:function(e,a,s){var l=t.localVars.screenWidth,u=t.localVars.screenHeight,c=o.new(e,a,s);c.contentsize={width:c.size.width,height:c.size.height},c.movespeed=1,c.movethreshold=40,c.swipespeed=(l+u)/2*5,c.maxspeed=200,c.inertia=7,c.zeroposition=0,c.loaddistance=u,c.visibledistance=c.loaddistance,c.itempad=0,c.centerslots=!1,c.swipefunc=n.inQuad;var d=c.add(i.new("scrollable"));c.instance=d,d.targetposition={x:0,y:0,z:0};var h=function(e,t,r){r>100&&(r=100);var n=1;e>t&&(n=-1);var i=-n*(r/(16.66*c.inertia))*Math.abs(e-t),o=r/16.66*c.maxspeed;return i>o&&(i=o),-o>i&&(i=-o),Math.abs(i)<1e-5?e=t:e-=i,1==n&&e>t&&(e=t),-1==n&&t>e&&(e=t),e};c.unfocused_relativePress=c.relativePress,c.unfocused_relativeDrag=c.relativeDrag,c.unfocused_relativeRelease=c.relativeRelease,c.hover=function(){return!1},c.focus=function(e,t){d.pressOffset={x:d.position.x-e*c.movespeed,y:d.position.y-t*c.movespeed},d.moving&&(d.resetpress(),d.moving=!1)},c.defocus=function(){r.getpointerStealer()==c&&c.centeronslots()},c.centeronslots=function(){if(c.centerslots){var e=Math.floor(c.selected()/(l+c.itempad));c.movetox(e*(l+c.itempad)+l/2)}},d.setMoving=function(){0==d.moving&&null==r.getpointerStealer()&&(r.stealPointers(c),d.moving=!0)},c.focusdrag=function(e,t){var r=d.pressOffset.x+e*c.movespeed,n=d.pressOffset.y+t*c.movespeed,i=r-d.targetposition.x,o=n-d.targetposition.y;c.contentsize.width!=c.size.width&&Math.abs(i)>c.movethreshold&&d.setMoving(),c.contentsize.height!=c.size.height&&Math.abs(o)>c.movethreshold&&d.setMoving(),d.moving&&(d.targetposition.x=r,d.targetposition.y=n)},c.swipeRight=function(e){d.targetposition.x=d.targetposition.x-c.swipefunc(0,c.swipespeed,e)},c.swipeLeft=function(e){d.targetposition.x=d.targetposition.x+c.swipefunc(0,c.swipespeed,e)},c.swipeUp=function(e){d.targetposition.y=d.targetposition.y+c.swipefunc(0,c.swipespeed,e)},c.swipeDown=function(e){d.targetposition.y=d.targetposition.y-c.swipefunc(0,c.swipespeed,e)},c.wheel=function(e,t){d.targetposition.x=d.targetposition.x+e,d.targetposition.y=d.targetposition.y+t},c.step=function(e){var t=-(c.contentsize.width-c.size.width)+c.zeroposition,r=-(c.contentsize.height-c.size.height);c.contentsize.width<c.size.width&&(t=0),c.contentsize.height<c.size.height&&(r=0);var n=e;n>66&&(n=66),0!=c.enforcelimits&&(d.targetposition.x>c.size.width/4+c.zeroposition&&(d.targetposition.x=c.size.width/4+c.zeroposition),d.targetposition.y>c.size.height/4&&(d.targetposition.y=c.size.height/4),d.targetposition.x<t-c.size.width/4&&(d.targetposition.x=t-c.size.width/4),d.targetposition.y<r-c.size.height/4&&(d.targetposition.y=r-c.size.height/4),0==c.focused&&(d.targetposition.x>c.zeroposition&&(d.targetposition.x=h(d.targetposition.x,c.zeroposition,e/2)),d.targetposition.y>0&&(d.targetposition.y=h(d.targetposition.y,0,e/2)),d.targetposition.x<t&&(d.targetposition.x=h(d.targetposition.x,t,e/2)),d.targetposition.y<r&&(d.targetposition.y=h(d.targetposition.y,r,e/2)))),0==c.focused&&(n/=2),c.contentsize.width!=c.size.width&&(d.position.x=h(d.position.x,d.targetposition.x,n)),c.contentsize.height!=c.size.height&&(d.position.y=h(d.position.y,d.targetposition.y,n)),0==c.focused&&d.position.x==d.targetposition.x&&d.position.y==d.targetposition.y&&(d.moving=!1)},c.selected=function(){return Math.floor(d.targetposition.x)},c.movetox=function(e,t){t&&(d.position.x=e),d.targetposition.x=e},c.movetoy=function(e,t){t&&(d.position.y=e),d.targetposition.y=e},c.prepare=function(){c.step(0);for(var e=0;e<d.children.length;e++)d.children[e].step(0)};var f=4*l,p=4*u,m=-f,g=f,v=-p,_=p;return c.intersectsScreen=function(e){var t=e.absolutex(),r=e.absolutey(),n=t-e.width()/2,i=t+e.width()/2,o=r-e.height()/2,a=r+e.height()/2;return!(m>i||n>g||v>a||o>_)},c.add=function(e,t){t?t:d.children.length;return e.parent=d,d.children.push(e),e.step=function(){this.xdistance=this.absolutex();var e=Math.sqrt(Math.pow(this.xdistance,2)+Math.pow(this.absolutey(),2));if(e<c.loaddistance)null!=this.load_content&&0==this.loaded&&this.load_content();else{var t=c.unloaddistance;null==t&&(t=c.loaddistance),e>t&&null!=this.load_content&&null!=this.unload_content&&this.loaded&&this.unload_content()}this.visible=e<c.visibledistance?!0:!1,this.distance=e},e},c}}}();t.module("scrollable",a)}(),function(){function e(t,r,n,i){r=r.replace("\n"," ");var o,a,s,l=r,u=0,c=0,d=r.split(" ");for(a=s=d.length;t.measureText(l).width>n&&a>1;){a--;l=o="";for(var h=0;s>h;h++)a>h?(l+=d[h],a>h+1&&(l+=" ")):(o+=d[h],s>h+1&&(o+=" "))}return i.push(l),c=t.measureText(l),o&&(u=e(t,o,n,i),u>c&&(c=u)),c}var t=document.currentScript||document._currentScript,r=t.curlify,n=function(){console.log("initialize text module");var t=r.getModule("quad");return{new:function(n,i,o,a,s,l,u,c,d){var h=r.localVars.gl,f=r.localVars.screenWidth,s=s?s:f,p=t.new("text : "+n+" : "+s+","+l);p.canvas=document.createElement("canvas"),p.canvas.width=s,p.canvas.height=i;var m=function(){p.context=p.canvas.getContext("2d"),p.context.fillStyle="rgba("+255*a.red+","+255*a.green+","+255*a.blue+",255)",p.context.textAlign=u?u:"center",p.context.textBaseline=c?c:"bottom",p.context.font=i+"px "+o};m();for(var g,v,_=[],x=1.2*i,y=s,w=n.split("\n"),b=0;b<w.length;b++)e(p.context,w[b],s,_);d&&(_=_.slice(0,d));var E=y,T=x*(_.length+1);g="center"==p.context.textAlign?E/2:0;var M=.5*(T-x*(_.length+1)),R=_.length*x+M;p.canvas.height=R,m();for(var b=0;b<_.length;b++)v=(b+1)*x+M,p.context.fillText(_[b],g,v);return p.size.width=p.canvas.width,p.size.height=p.canvas.height,p.textlines=_,p.texture=h.createTexture(),h.bindTexture(h.TEXTURE_2D,p.texture),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,p.canvas),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,h.CLAMP_TO_EDGE),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,h.LINEAR),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,h.LINEAR),h.bindTexture(h.TEXTURE_2D,null),p}}}();r.module("text",n)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){return{json:null,open:function(e){var r=t.localVars.zipfile,n={};if(null!=r){var i=r.file(e);null!=i&&(n=JSON.parse(i.asText()))}return this.json=n,this}}}();t.module("jsonfile",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize video module");var e=t.getModule("quad"),r=t.getModule("focusable"),n=t.getModule("sys");return{new:function(i){function o(){console.log("videoDone")}function a(){console.log("progress")}function s(){console.log("playing")}function l(){console.log("stalling")}function u(){console.log("suspend")}var c=t.localVars.gl,d=t.localVars.zipfile,h=r.new("video : "+i);h.glProgram=e.default_program.getProgram(),h.player=document.createElement("video");var f=!1;if(h.player.autoplay=!0,h.player.loop=!0,h.player.oncanplay=function(){f=!0},h.player.onerror=function(){var e="unknown error";switch(h.player.error.code){case 1:e="video loading aborted";break;case 2:e="network loading error";break;case 3:e="video decoding failed / corrupted data or unsupported codec";break;case 4:e="video not supported"}console.log("Error: "+e+" (errorcode="+h.player.error.code+")")},null!=d&&"http"!=i.slice(0,4)){var p=d.file(i);console.log("video.source zip",p,i,d),h.player.type="video/mp4",h.player.src="data:video/mp4;base64,"+JSZip.base64.encode(p.asBinary())}else console.log("video.source ",i),h.player.src=i,h.player.crossOrigin="anonymous";return n.ismobile.any()&&(h.click=function(e,t){console.log("video click",e,t),h.player.play()},h.focus=function(e,t){console.log("video focus",e,t)}),h.preload="auto",h.player.addEventListener("ended",o,!0),h.player.addEventListener("progress",a,!0),h.player.addEventListener("playing",s,!0),h.player.addEventListener("stalling",l,!0),h.player.addEventListener("suspend",u,!0),h.player.setAttribute("playsinline",""),h.player.setAttribute("webkit-playsinline",""),h.player.load(),h.texture=c.createTexture(),c.bindTexture(c.TEXTURE_2D,h.texture),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,1,1,0,c.RGBA,c.UNSIGNED_BYTE,new Uint8Array([0,0,0,0])),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),h.draw=function(){if(1!=h.loaded)return void(f&&(console.log("video texture loaded : "+h.size.width+"x"+h.size.height+" : "+h.visible+","+h.alpha),null!=h.onload&&h.onload(),h.loaded=!0));c.useProgram(this.glProgram.program),c.activeTexture(c.TEXTURE0),c.bindTexture(c.TEXTURE_2D,h.texture),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_S,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_WRAP_T,c.CLAMP_TO_EDGE),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MIN_FILTER,c.LINEAR),c.texParameteri(c.TEXTURE_2D,c.TEXTURE_MAG_FILTER,c.LINEAR),c.texImage2D(c.TEXTURE_2D,0,c.RGBA,c.RGBA,c.UNSIGNED_BYTE,h.player),c.uniform1i(this.glProgram.u_texture_handle,0),c.uniform1f(this.glProgram.u_alpha_handle,this.absolutealpha()),c.uniformMatrix4fv(this.glProgram.u_projection_handle,!1,this.projectionMatrix),c.uniformMatrix4fv(this.glProgram.u_view_handle,!1,this.viewMatrix),c.uniformMatrix4fv(this.glProgram.u_model_handle,!1,this.quadModelMatrix);var t=this.buffer?this.buffer:e.buffer;c.bindBuffer(c.ARRAY_BUFFER,t),c.enableVertexAttribArray(this.glProgram.a_position_handle),c.enableVertexAttribArray(this.glProgram.a_tex_coordinate_handle),c.vertexAttribPointer(this.glProgram.a_position_handle,t.itemSize,c.FLOAT,!1,16,0),c.vertexAttribPointer(this.glProgram.a_tex_coordinate_handle,t.itemSize,c.FLOAT,!1,16,8),c.drawArrays(c.TRIANGLE_STRIP,0,t.numItems)},h.checkstatus=function(){console.log("video status : "+h.player.paused+" : "+h.player.buffered+" : "+h.player.error),console.log("readyState  :"+h.player.readyState),console.log("startDate  :"+h.player.startDate),console.log("duration  :"+h.player.duration),console.log("currentSrc  :"+h.player.currentSrc)},h}}}();t.module("video",r)}(),function(){var e=document.currentScript||document._currentScript,t=e.curlify,r=function(){console.log("initialize mesh module");var e=t.getModule("glutils"),r=t.getModule("object"),n=t.getModule("image");return{default_program:{glProgram:null,getProgram:function(){return null==this.glProgram&&this.loadProgram(),this.glProgram},loadProgram:function(){var r={text:"              attribute vec3 a_position;              attribute vec3 a_normal;              attribute vec2 a_tex_coordinate;                            uniform mat4 u_projection;              uniform mat4 u_view;              uniform mat4 u_model;                            varying vec3 v_normal;              varying vec2 v_tex_coord;                            void main() {                mat4 modelViewProj = u_projection*u_view*u_model;                gl_Position = modelViewProj * vec4(a_position, 1.0);                v_normal = vec3(modelViewProj * vec4(a_normal, 0.0));                v_tex_coord = a_tex_coordinate;              }            ",type:"x-shader/x-vertex"},n={text:"              precision mediump float;                            varying vec3      v_normal;              varying vec2      v_tex_coord;                            uniform sampler2D u_texture;              uniform float     u_alpha;                            void main() {                vec4 color = texture2D(u_texture, v_tex_coord);                float diffuse = max(dot(normalize(v_normal), vec3(0.0, 0.0, 1.0)), 0.0) + 0.3;                gl_FragColor = color * u_alpha;              }            ",type:"x-shader/x-fragment"},i=t.localVars.gl,o=e.createShader(i,r),a=e.createShader(i,n);this.glProgram=e.loadProgram(i,[o,a],["a_position","a_normal","a_tex_coordinate"],["u_texture","u_alpha","u_model","u_view","u_projection"])}},new:function(e,i){var o=t.localVars.gl,a=t.localVars.zipfile,s=r.new("mesh : "+e);if(s.depthtest=!0,s.drawbackside=!0,s.loaded=!1,null!=i)if(i instanceof Object)null!=i.texture?(s.texture=i.texture,s.loaded=!0):console.log("ERROR: texture failed to load from object "+i);else{var l=n.loadImage(i);l.onload=function(){s.texture=o.createTexture(),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!0),o.bindTexture(o.TEXTURE_2D,s.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.CLAMP_TO_EDGE),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,l),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!1),s.loaded=!0,t.renderRequired=!0,null!=s.mesh&&null!=s.onload&&s.onload()},l.onerror=function(){console.log("ERROR: texture load failed for mesh "+e+" : "+i),s.loaded=!0}}else console.log("WARNING: no texture defined for mesh "+e),s.loaded=!0;if(e instanceof Object)s.mesh=e.mesh;else if(null!=a){console.log("zipfile load",e);var u=a.file(e);s.mesh=new OBJ.Mesh(u.asBinary()),OBJ.initMeshBuffers(o,s.mesh),s.loaded&&window.setTimeout(function(){null!=s.onload&&s.onload()},10)}else console.log("download load",i),OBJ.downloadMeshes({model:e},function(e){s.mesh=e.model,OBJ.initMeshBuffers(o,s.mesh),s.loaded&&null!=s.onload&&s.onload()});return s.draw=function(){0!=this.loaded&&null!=this.mesh&&(o.useProgram(this.glProgram.program),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,s.texture),o.uniform1i(this.glProgram.u_texture_handle,0),o.uniform1f(this.glProgram.u_alpha_handle,this.absolutealpha()),o.uniformMatrix4fv(this.glProgram.u_projection_handle,!1,this.projectionMatrix),o.uniformMatrix4fv(this.glProgram.u_view_handle,!1,this.viewMatrix),o.uniformMatrix4fv(this.glProgram.u_model_handle,!1,this.modelMatrix),o.enableVertexAttribArray(this.glProgram.a_position_handle),o.enableVertexAttribArray(this.glProgram.a_normal_handle),o.enableVertexAttribArray(this.glProgram.a_tex_coordinate_handle),o.bindBuffer(o.ARRAY_BUFFER,this.mesh.vertexBuffer),o.vertexAttribPointer(this.glProgram.a_position_handle,this.mesh.vertexBuffer.itemSize,o.FLOAT,!1,0,0),this.mesh.textures.length?(o.enableVertexAttribArray(this.glProgram.a_tex_coordinate_handle),o.bindBuffer(o.ARRAY_BUFFER,this.mesh.textureBuffer),o.vertexAttribPointer(this.glProgram.a_tex_coordinate_handle,this.mesh.textureBuffer.itemSize,o.FLOAT,!1,0,0)):o.disableVertexAttribArray(this.glProgram.a_tex_coordinate_handle),o.bindBuffer(o.ARRAY_BUFFER,this.mesh.normalBuffer),o.vertexAttribPointer(this.glProgram.a_normal_handle,this.mesh.normalBuffer.itemSize,o.FLOAT,!1,0,0),o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,this.mesh.indexBuffer),o.drawElements(o.TRIANGLES,this.mesh.indexBuffer.numItems,o.UNSIGNED_SHORT,0))},s.glProgram=this.default_program.getProgram(),s}}}();t.module("mesh",r)}(),function(){function createProjection(e,t,r,n){var i=mat4.clone([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);return i[0]=r/e,i[5]=r/t,i[10]=-(n+r)/(n-r),i[11]=-1,i[14]=-2*n*r/(n-r),i}function createProjectionAndView(e,t,r,n){var i=createProjection(1,t/e,r,n),o=mat4.create();mat4.translate(o,o,vec3.clone([0,0,-(n-r)/2]));var a=(n-r)/2/r,s={near:r,far:n,width:e,height:t,projectionMatrix:i,viewMatrix:o,translateScale:a};return s}function initWebGL(e,t){gl=null;try{gl=e.getContext("webgl",t)||e.getContext("experimental-webgl")}catch(e){console.log(e)}return void 0===gl&&(console.log("ERROR: Unable to initialize WebGL in target node"),gl=null),gl}function swipestart(e){pointerTimestamp=sys.timestamp(),lastPointerPosition.x=e.x,lastPointerPosition.y=e.y,pointerDirection.x=0,pointerDirection.y=0,pointerTargetDirection.x=0,pointerTargetDirection.y=0}function swipedrag(e){var t=sys.timestamp()-pointerTimestamp,r=e.x-lastPointerPosition.x,n=e.y-lastPointerPosition.y,i=Math.max(t,16.66);pointerTargetDirection.x=r/(i/16.66),pointerTargetDirection.y=n/(i/16.66),pointerDirection.y<0&&(pointerDirection.y=Math.min(pointerDirection.y,pointerTargetDirection.y)),pointerDirection.y>0&&(pointerDirection.y=Math.max(pointerDirection.y,pointerTargetDirection.y)),pointerDirection.x<0&&(pointerDirection.x=Math.min(pointerDirection.x,pointerTargetDirection.x)),pointerDirection.x>0&&(pointerDirection.x=Math.max(pointerDirection.x,pointerTargetDirection.x));var o=pointerTargetDirection.y/Math.abs(pointerTargetDirection.y),a=pointerDirection.y/Math.abs(pointerDirection.y);o!=a&&(pointerDirection.y=pointerTargetDirection.y);var o=pointerTargetDirection.x/Math.abs(pointerTargetDirection.x),a=pointerDirection.x/Math.abs(pointerDirection.x);o!=a&&(pointerDirection.x=pointerTargetDirection.x),lastPointerPosition.x=e.x,lastPointerPosition.y=e.y}function swipeend(){var e=.08*viewWidth,t=.07*viewHeight,r=pointerDirection.x;r>0&&(r=Math.min(1,r/e)),0>r&&(r=Math.max(-1,r/e));var n=pointerDirection.y;n>0&&(n=Math.min(1,n/t)),0>n&&(n=Math.max(-1,n/t));var i={x:r,y:n};return i}function mousedown(e){if(!scene.isAnimating()&&1!=touch){var t=e.currentTarget.getBoundingClientRect();touch=!0;var r=scene.getPointerUser();if(null!=r){var n={x:(e.clientX*scaleMulti-t.left-layoutOffset.x)*layoutScale.x,y:(e.clientY*scaleMulti-t.top-layoutOffset.y)*layoutScale.y};swipestart(n),r.press(n.x,n.y),r.drag(n.x,n.y)}}}function mouseup(e){if(scene.isAnimating()||0==touch)return void scene.resetPointerStealer();var t=e.currentTarget.getBoundingClientRect();touch=!1;var r=scene.getPointerUser();if(null!=r){var n={x:(e.clientX*scaleMulti-t.left-layoutOffset.x)*layoutScale.x,y:(e.clientY*scaleMulti-t.top-layoutOffset.y)*layoutScale.y};if(null!=hoverfocus){if(null!=hoverfocus.click){var i=n.x-screenWidth/2-hoverfocus.absolutex(),o=n.y-screenHeight/2-hoverfocus.absolutey();hoverfocus.click(i,o)}hoverfocus.resethover(),hoverfocus=null}var a=swipeend(n);r.swipe(a)?r.resetpress():r.release(n.x,n.y),scene.resetPointerStealer()}}function mouseout(e){return touch&&mouseup(e),null!=hoverfocus?(hoverfocus.resethover(),hoverfocus=null,void(hoverlist=[])):void 0}function mousemove(e){if(!scene.isAnimating()){var t=e.currentTarget.getBoundingClientRect(),r=scene.getPointerUser();if(null!=r){var n={x:(e.clientX*scaleMulti-t.left-layoutOffset.x)*layoutScale.x,y:(e.clientY*scaleMulti-t.top-layoutOffset.y)*layoutScale.y},i=r.hoverTree(n.x,n.y);if(hoverlist=i,i.length>0){null!=hoverfocus&&hoverfocus!=i[0]&&hoverfocus.resethover(),hoverfocus=i[0];var o=n.x-screenWidth/2-hoverfocus.absolutex(),a=n.y-screenHeight/2-hoverfocus.absolutey();hoverfocus.hover(o,a)}else null!=hoverfocus&&hoverfocus.resethover(),hoverfocus=null;touch&&(swipedrag(n),r.drag(n.x,n.y))}}}function touchstart(e){if(allowDefaultPointerEvent=!1,!scene.isAnimating()&&1!=touch){var t=e.currentTarget.getBoundingClientRect();touch=!0;var r=scene.getPointerUser();if(null!=r){var n={x:(e.touches[0].pageX*scaleMulti-t.left-window.pageXOffset-layoutOffset.x)*layoutScale.x,y:(e.touches[0].pageY*scaleMulti-t.top-window.pageYOffset-layoutOffset.y)*layoutScale.y};swipestart(n),r.press(n.x,n.y),r.drag(n.x,n.y),lasttouch=e,0==allowDefaultPointerEvent&&e.preventDefault()}}}function touchend(e){if(allowDefaultPointerEvent=!1,scene.isAnimating()||0==touch)return void scene.resetPointerStealer();var t=e.currentTarget.getBoundingClientRect();touch=!1;var r=scene.getPointerUser();if(null!=r){var n={x:(lasttouch.touches[0].pageX*scaleMulti-t.left-window.pageXOffset-layoutOffset.x)*layoutScale.x,y:(lasttouch.touches[0].pageY*scaleMulti-t.top-window.pageYOffset-layoutOffset.y)*layoutScale.y};if(null!=hoverfocus){if(null!=hoverfocus.click){var i=n.x-screenWidth/2-hoverfocus.absolutex(),o=n.y-screenHeight/2-hoverfocus.absolutey();hoverfocus.click(i,o)}hoverfocus.resethover(),hoverfocus=null}var a=swipeend(n);r.swipe(a)?resetpress():r.release(n.x,n.y),scene.resetPointerStealer()}}function touchmove(e){if(!scene.isAnimating()&&0!=touch){var t=e.currentTarget.getBoundingClientRect(),r=scene.getPointerUser();if(null!=r){if(touch){var n={x:(e.touches[0].pageX*scaleMulti-t.left-window.pageXOffset-layoutOffset.x)*layoutScale.x,y:(e.touches[0].pageY*scaleMulti-t.top-window.pageYOffset-layoutOffset.y)*layoutScale.y},i=r.hoverTree(n.x,n.y);hoverlist=i,i.length>0?(null!=hoverfocus&&hoverfocus!=i[0]&&hoverfocus.resethover(),hoverfocus=i[0]):(null!=hoverfocus&&hoverfocus.resethover(),hoverfocus=null),swipedrag(n),r.drag(n.x,n.y)}lasttouch=e,0==allowDefaultPointerEvent&&e.preventDefault()}}}function deviceMotionHandler(e){sensors.acceleration=e.acceleration,!isany_mobile||null!==sensors.acceleration&&null!==sensors.acceleration.x||(sensors.acceleration=e.accelerationIncludingGravity),!hasRotation||null!==e.rotationRate&&null!==e.rotationRate.alpha?hasRotation&&(sensors.rotationRate=e.rotationRate):hasRotation=!1}function deviceOrientationHandler(e){null!=e&&(isany_mobile&&!hasRotation&&null!==sensors.orientation&&null!==sensors.orientation.alpha&&(sensors.rotationRate={beta:sensors.orientation.alpha-(e.alpha+orientation_hack),alpha:sensors.orientation.beta-e.beta,gamma:sensors.orientation.gamma-e.gamma}),sensors.orientation={alpha:e.alpha+orientation_hack,beta:e.beta,gamma:e.gamma})}function orientationChanged(){window.requestAnimationFrame(curlify.resizeCanvas)}function wheelHandler(e){if(0==allowDefaultPointerEvent&&e.preventDefault(),!scene.isAnimating()&&0!=hoverlist.length)for(var t=0;t<hoverlist.length;t++){var r=hoverlist[t];if(null!=r.wheel){r.wheel(e.wheelDeltaX,e.wheelDeltaY);break}}}function resizeCanvas(){var e=Math.floor(glcanvas.clientWidth),t=Math.floor(glcanvas.clientHeight);layoutWidth=e,layoutHeight=t,layoutScale={x:screenWidth/layoutWidth,y:screenHeight/layoutHeight},viewWidth=screenWidth,viewHeight=screenHeight;var r=Math.max(layoutScale.x,layoutScale.y);aspectratioZoom&&(r=Math.min(layoutScale.x,layoutScale.y),viewWidth=e*r,viewHeight=t*r),layoutScale.x=r,layoutScale.y=r,layoutWidth=Math.floor(screenWidth*(1/r)),layoutHeight=Math.floor(screenHeight*(1/r)),layoutOffset.x=(e-layoutWidth)/2,layoutOffset.y=(t-layoutHeight)/2,glcanvas.width=glcanvas.clientWidth,glcanvas.height=glcanvas.clientHeight,curlify.localVars.layoutWidth=layoutWidth,curlify.localVars.layoutHeight=layoutHeight,curlify.localVars.layoutScale=layoutScale,curlify.localVars.layoutOffset=layoutOffset,curlify.localVars.viewWidth=viewWidth,curlify.localVars.viewHeight=viewHeight,curlify.localVars.screenWidth=screenWidth,curlify.localVars.screenHeight=screenHeight,console.log("resizeCanvas "+glcanvas.clientWidth+"x"+glcanvas.clientHeight+" "+screenWidth+"x"+screenHeight+" "+layoutWidth+"x"+layoutHeight+" "+glcanvas.width+","+glcanvas.height+" "+viewWidth+"x"+viewHeight+" "+layoutOffset.x+","+layoutOffset.y),curlify.renderRequired=!0,scene.layoutChanged()
}function mergeRecursive(e,t){for(var r in t)try{e[r]=t[r].constructor==Object?mergeRecursive(e[r],t[r]):t[r]}catch(n){e[r]=t[r]}return e}function getRandom(e,t){return Math.floor(Math.random()*(t-e)+e)}function spawn(e){return function(){function t(e,t){var o;try{o=r[e](t)}catch(e){return Promise.reject(e)}return o.done?o.value:Promise.resolve(o.value).then(n,i)}var r=e.apply(this,arguments),n=t.bind(t,"next"),i=t.bind(t,"throw");return n()}}function createCORSRequest(e){var t=e.method||"GET",r=e.url;return new Promise(function(n,i){var o=new XMLHttpRequest;try{for(var a in e.xhroptions)o[a]=e.xhroptions[a]}catch(e){}if("withCredentials"in o)o.open(t,r,!0);else{if("undefined"==typeof XDomainRequest)return o=null,void i(Error("createCORSRequest failed with 'XMLHttpRequest not supported'"));o=new XDomainRequest,o.open(t,r)}try{for(var a in e.xhroptions)o[a]=e.xhroptions[a]}catch(e){}o.onload=function(){200==o.status?n(e.returnfullrequest?o:o.response):i(Error("cors request failed with '"+o.statusText+"'"))},o.onerror=function(){i(Error("cors request failed with 'Network Error'"))};for(var s in e.headers)o.setRequestHeader(s,e.headers[s]);o.send(e.postData)})}function require(script){var module=curlify.getModule(script);return null!=module?(console.log("return module '"+script+"'",module),new Promise(function(e){e(module)})):new Promise(function(resolve,reject){var scriptid=script,element=document.getElementById(scriptid);if(null==element)if(".zip"==script.slice(-4))JSZipUtils.getBinaryContent(script,function(err,data){if(err)return void reject(Error("require zip load failed for '"+script+"' with '"+err+"'"));zipfile=new JSZip(data),curlify.localVars.zipfile=zipfile;for(var jsfiles=zipfile.filter(function(e){return".js"==e.slice(-3)?!0:!1}),mainscriptfile=null,mainscriptobject=null,i=0;i<jsfiles.length;i++)!new function(){var file=jsfiles[i],scripto=null,e=null;if("main.js"!=file.name)try{scripto=eval(file.asText())}catch(e){console.log("error evaluating file "+file.name+" with '"+e+"'")}else mainscriptfile=file};if(null==mainscriptfile)return zipfile=null,curlify.localVars.zipfile=null,void reject(Error("require failed for '"+script+"' with 'main.js not found inside zip'"));var e=null;try{mainscriptobject=eval(mainscriptfile.asText())}catch(e){console.log("error evaluating file "+mainscriptfile.name+" with '"+e+"'")}return e?(zipfile=null,curlify.localVars.zipfile=null,void reject(Error("require eval failed for zip '"+script+"' with '"+e+"'"))):void resolve(mainscriptobject)});else{if(null!=zipfile){var scriptfile=zipfile.file(script);if(null==scriptfile)return void reject(Error("require with zip failed for script "+script));var scriptobject=null;try{scriptobject=eval(scriptfile.asText())}catch(e){return void reject(Error("require with zip failed for script "+script+" with "+e))}return void resolve(scriptobject)}element=document.createElement("script"),element.setAttribute("id",scriptid),element.setAttribute("type","text/javascript"),document.head.appendChild(element),appendedElements.push(scriptid),".js"==script.slice(-3)||".json"==script.slice(-5)?createCORSRequest({method:"GET",url:script}).then(function(response){try{element.scriptobject=eval(response)}catch(e){return void reject(Error("require eval failed for '"+script+"' with '"+e+"'",response))}resolve(element.scriptobject)},function(e){reject(Error("require load failed for '"+script+"' with '"+e+"'"))}):(element.setAttribute("src",script),element.onload=function(){resolve()},element.onerror=function(){reject(Error("require failed for '"+script+"'"))})}else resolve(element.scriptobject)})}function isElementInViewport(e){var t=e.getBoundingClientRect();return t.bottom>=0&&t.right>=0&&t.top<=(window.innerHeight||document.documentElement.clientHeight)&&t.left<=(window.innerWidth||document.documentElement.clientWidth)}var revision="10";console.log("initialize main",revision,document.currentScript);var scaleMulti=1,currentScript=document.currentScript,curlify=currentScript.curlify;eval(curlify.extract(curlify.modules,"curlify.modules")),eval(curlify.extract(curlify.localVars,"curlify.localVars")),curlify.scene=scene,curlify.renderRequired=!1;var glcanvas,glclearcolor=0,aspectratioZoom=!0,touch=!1,lasttouch=null,hoverlist=[],hoverfocus=null,lastPointerPosition={x:0,y:0},pointerTargetDirection={x:0,y:0},pointerDirection={x:0,y:0},pointerTimestamp=0,imageid=0,running=!1,appendedElements=[],allowDefaultPointerEvent=!1,hasRotation=!0,isany_mobile=sys.ismobile.any();sys.ismobile.FireFox()&&(hasRotation=!1);var orientation_hack=isany_mobile?-180:0;curlify.resizeCanvas=resizeCanvas,curlify.addImageElement=function(){var e="curlify_image_"+imageid,t=document.createElement("img");return t.setAttribute("id",e),document.body.appendChild(t),appendedElements.push(e),imageid+=1,t},curlify.render=function(){0!=running&&(document.hidden||0==isElementInViewport(glcanvas)||scene.render(layoutOffset.x,layoutOffset.y,layoutWidth,layoutHeight))},curlify.stop=function(){if(console.log("Cleaning up..."),null==glcanvas)return void console.log("ERROR: canvas not set");"ontouchstart"in window?(glcanvas.removeEventListener("touchstart",touchstart,!1),glcanvas.removeEventListener("touchmove",touchmove,!1),glcanvas.removeEventListener("touchend",touchend,!1)):(glcanvas.removeEventListener("mousedown",mousedown,!1),glcanvas.removeEventListener("mousemove",mousemove,!1),glcanvas.removeEventListener("mouseup",mouseup,!1),glcanvas.removeEventListener("mouseout",mouseout,!1)),window.DeviceMotionEvent&&window.removeEventListener("devicemotion",deviceMotionHandler,!1),window.DeviceOrientationEvent&&window.removeEventListener("deviceorientation",deviceOrientationHandler,!1),window.removeEventListener("orientationchange",orientationChanged),window.removeEventListener("resize",orientationChanged),scene.removeAllScenes();for(var e=0;e<appendedElements.length;e++){var t=appendedElements[e],r=document.getElementById(t);r.parentNode.removeChild(r)}appendedElements=[],null!=curlify.intervalId&&window.clearInterval(curlify.intervalId),curlify.clearModuleBuffersAndPrograms(),running=!1},curlify.start=function(e){if(console.log("curlify.start",e,revision,Date.now()),running&&curlify.stop(),running=!0,null==e.script)return void console.log("ERROR: no script source set");if(screenWidth=e.width?e.width:480,screenHeight=e.height?e.height:852,curlify.localVars.screenWidth=screenWidth,curlify.localVars.screenHeight=screenHeight,glcanvas=e.canvas?document.getElementById(e.canvas):currentScript.parentNode,curlify.localVars.glcanvas=glcanvas,curlify.localVars.autosize=e.autosize,e.autosize===!0){var t=window.devicePixelRatio||1;scaleMulti=t;var r=1/window.devicePixelRatio;if(sys.ismobile.Android()&&!sys.ismobile.FireFox()||sys.ismobile.iOS())glcanvas.parentNode.style.zoom=r;else{glcanvas.style.width=window.devicePixelRatio+"00%",glcanvas.style.height=window.devicePixelRatio+"00%";var n=glcanvas.parentNode.getAttribute("style");glcanvas.parentNode.setAttribute("style",n+"-moz-transform: scale("+r+");-moz-transform-origin: 0 0;-o-transform: scale("+r+");-o-transform-origin: 0 0;zoom:"+r+";transform: scale("+r+");transform-origin: 0 0;")}}if(null===glcanvas)return void(e.canvas?console.log("ERROR: cannot find canvas to draw on:",e.canvas):console.log("ERROR: no canvas to draw to as parentNode:",glcanvas));if(resizeCanvas(),gl=initWebGL(glcanvas,e.glparameters),curlify.localVars.gl=gl,void 0===gl)return void console.log("ERROR: could not initialize webgl");"ontouchstart"in window?(glcanvas.addEventListener("touchstart",touchstart,!1),glcanvas.addEventListener("touchmove",touchmove,!1),glcanvas.addEventListener("touchend",touchend,!1)):(glcanvas.addEventListener("mousedown",mousedown,!1),glcanvas.addEventListener("mousemove",mousemove,!1),glcanvas.addEventListener("mouseup",mouseup,!1),glcanvas.addEventListener("mouseout",mouseout,!1)),glcanvas.addEventListener("wheel",wheelHandler,!1),camera=createProjectionAndView(screenWidth,screenHeight,3,100),curlify.localVars.camera=camera,curlify.require=require,curlify.createCORSRequest=createCORSRequest,window.DeviceMotionEvent?window.addEventListener("devicemotion",deviceMotionHandler,!1):console.log("DeviceMotionEvent not supported"),window.DeviceOrientationEvent?window.addEventListener("deviceorientation",deviceOrientationHandler,!1):console.log("DeviceOrientationEvent not supported");var i=("onorientationchange"in window,"resize");window.addEventListener(i,function(){orientationChanged()},!1),require(e.script).then(function(t){if(scene.openScene(t.new()),null!=e.onload&&e.onload(),0!=e.framerate){var r=e.framerate?e.framerate:60;console.log("setting interval",e,r,e.framerate,Date.now()),curlify.intervalId=window.setInterval(curlify.render,1e3/r)}},function(t){console.log(t),alert("Could not load initial script: "+e.script)})}}();